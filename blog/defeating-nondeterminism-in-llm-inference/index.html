<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="author" content="">

  
  
  <meta name="description" content="Reproducibility is a bedrock of scientific progress. However, it&rsquo;s remarkably difficult to get reproducible results out of large language models.
For example, you might observe that asking ChatGPT the same question multiple times provides different results. This by itself is not surprising, since getting a result from a language model involves “sampling”, a process that converts the language model’s output into a probability distribution and probabilistically selects a token.
What might be more surprising is that even when we adjust the temperature down to 0This means that the LLM always chooses the highest probability token, which is called greedy sampling. (thus making the sampling theoretically deterministic), LLM APIs are still not deterministic in practice (see past discussions here, here, or here). Even when running inference on your own hardware with an OSS inference library like vLLM or SGLang, sampling still isn&rsquo;t deterministic (see here or here).">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">

  
  
  
  <link rel="preload" href="/fonts/iowan-old-style/iowan-old-style_regular.woff2" as="font" type="font/woff2" crossorigin="anonymous" fetchpriority="high">
  <link rel="preload" href="/fonts/iowan-old-style/iowan-old-style_bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/fonts/iowan-old-style/iowan-old-style_italic.woff2" as="font" type="font/woff2" crossorigin="anonymous" fetchpriority="high">
  
  
  <link rel="preload" href="/fonts/gt-america/GT-America-Standard-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/fonts/gt-america/GT-America-Standard-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/fonts/gt-america/GT-America-Standard-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/fonts/chakra-petch/chakra-petch-v12-latin-regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/fonts/chakra-petch/chakra-petch-v12-latin-500.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/fonts/chakra-petch/chakra-petch-v12-latin-600.woff2" as="font" type="font/woff2" crossorigin="anonymous">

  
  
  <meta name="keywords" content='thinky thinkingmachines machine learning deep learning ai'>
  

  
  
  

<script>
  
  (function() {
    function pageHasMath() {
      try {
        const text = document.body ? document.body.textContent : '';
        if (!text) return false;
        
        const block = /\$\$[\s\S]*?\$\$/;
        const paren = /\\\([\s\S]*?\\\)/;
        const bracket = /\\\[[\s\S]*?\\\]/;
        const inline = /(^|\s)\$(?!\$)[^\n]+?\$(?=\s|[\.,;:!?)]|$)/;
        return block.test(text) || paren.test(text) || bracket.test(text) || inline.test(text);
      } catch (e) {
        return true; 
      }
    }

    function loadStyle(href) {
      var preload = document.createElement('link');
      preload.rel = 'preload';
      preload.as = 'style';
      preload.href = href;
      document.head.appendChild(preload);

      var link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = href;
      link.media = 'print';
      link.onload = function(){ this.media = 'all'; };
      document.head.appendChild(link);

      var noscript = document.createElement('noscript');
      noscript.innerHTML = '<link rel="stylesheet" href="' + href + '">';
      document.head.appendChild(noscript);
    }

    function loadScript(src) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = src;
        s.defer = true;
        s.onload = resolve;
        s.onerror = reject;
        document.head.appendChild(s);
      });
    }

    function renderAllMath(root) {
      if (!window.renderMathInElement) return;
      window.renderMathInElement(root || document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ],
        throwOnError: false,
        
        ignoredTags: ['script','noscript','style','textarea','pre','code'],
      });
    }

    function init() {
      if (!pageHasMath()) return;
      var base = '\/katex\/';
      var cssHref = base + 'katex.min.css?v=1762541520';
      var katexJs = base + 'katex.min.js?v=1762541520';
      var autorenderJs = base + 'contrib/auto-render.min.js?v=1762541520';

      loadStyle(cssHref);
      loadScript(katexJs)
        .then(function(){ return loadScript(autorenderJs); })
        .then(function(){
          
          renderAllMath(document.body);
          
          setTimeout(function(){ renderAllMath(document.body); }, 0);
          
          try {
            var observer = new MutationObserver(function(mutations){
              for (var i=0; i<mutations.length; i++) {
                var m = mutations[i];
                if (m.addedNodes && m.addedNodes.length) {
                  for (var j=0; j<m.addedNodes.length; j++) {
                    var node = m.addedNodes[j];
                    if (node.nodeType === 1) {
                      renderAllMath(node);
                    }
                  }
                }
              }
            });
            observer.observe(document.body, { childList: true, subtree: true });
          } catch (e) {   }
        })
        .catch(function(){   });
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  })();
</script>


  

  
  
  
  
    
  

  
  
  
  
  
  
  
    
  
  
  
    
  

  
  
  
  
  

  
  <link rel="canonical" href="https://thinkingmachines.ai/blog/defeating-nondeterminism-in-llm-inference/">

  
  
  
  <meta itemprop="name" content="Defeating Nondeterminism in LLM Inference">
  <meta itemprop="description" content="Reproducibility is a bedrock of scientific progress. However, it’s remarkably difficult to get reproducible results out of large language models.
For example, you might observe that asking ChatGPT the same question multiple times provides different results. This by itself is not surprising, since getting a result from a language model involves “sampling”, a process that converts the language model’s output into a probability distribution and probabilistically selects a token.
What might be more surprising is that even when we adjust the temperature down to 0This means that the LLM always chooses the highest probability token, which is called greedy sampling. (thus making the sampling theoretically deterministic), LLM APIs are still not deterministic in practice (see past discussions here, here, or here). Even when running inference on your own hardware with an OSS inference library like vLLM or SGLang, sampling still isn’t deterministic (see here or here).">
  <meta itemprop="datePublished" content="2025-09-10T00:01:00-07:00">
  <meta itemprop="dateModified" content="2025-09-10T00:01:00-07:00">
  <meta itemprop="wordCount" content="5750">



  
  
  
  
  <link rel="stylesheet" href="/css/common.css?v=1762541520" fetchpriority="high">
  
  <link rel="stylesheet" href="https://thinkingmachines.ai/css/ui.css?v=1762541520">
  
  <link rel="preload" as="style" href="/css/typography.css?v=1762541520">
  <link rel="stylesheet" href="/css/typography.css?v=1762541520" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="/css/typography.css?v=1762541520"></noscript>
  
  <link rel="preload" as="style" href="/css/fonts.css?v=1762541520">
  <link rel="stylesheet" href="/css/fonts.css?v=1762541520" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="/css/fonts.css?v=1762541520"></noscript>
  <link rel="preload" as="style" href="/css/syntax.css?v=1762541520">
  <link rel="stylesheet" href="/css/syntax.css?v=1762541520" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="/css/syntax.css?v=1762541520"></noscript>

  
  
  <title>Defeating Nondeterminism in LLM Inference - Thinking Machines Lab</title>
  

  
  
  
  
  
  
    
    
    
      
        
          
          
          
          
        
      
    
  
  
  
  
  
    
    
    
    
      
    
  

  
  <meta property="og:title" content="Defeating Nondeterminism in LLM Inference">
  <meta property="og:description" content="Reproducibility is a bedrock of scientific progress. However, it&rsquo;s remarkably difficult to get reproducible results out of large language models.
For example, you might observe that asking ChatGPT the same question multiple times provides different results. This by itself is not surprising, since getting a result from a language model involves “sampling”, a process that converts the language model’s output into a probability distribution and probabilistically selects a token.
What might be more surprising is that even when we adjust the temperature down to 0This means that the LLM always chooses the highest probability token, which is called greedy sampling. (thus making the sampling theoretically deterministic), LLM APIs are still not deterministic in practice (see past discussions here, here, or here). Even when running inference on your own hardware with an OSS inference library like vLLM or SGLang, sampling still isn&rsquo;t deterministic (see here or here).">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://thinkingmachines.ai/blog/defeating-nondeterminism-in-llm-inference/">
  <meta property="og:site_name" content="Thinking Machines Lab">
  <meta property="og:image" content="https://thinkingmachines.ai/blog/defeating-nondeterminism-in-llm-inference/images/cover-social.png">
  <meta property="og:image:width" content="1635">
  <meta property="og:image:height" content="858">
  <meta property="og:image:alt" content="Defeating Nondeterminism in LLM Inference">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Defeating Nondeterminism in LLM Inference">
  <meta name="twitter:description" content="Reproducibility is a bedrock of scientific progress. However, it&rsquo;s remarkably difficult to get reproducible results out of large language models.
For example, you might observe that asking ChatGPT the same question multiple times provides different results. This by itself is not surprising, since getting a result from a language model involves “sampling”, a process that converts the language model’s output into a probability distribution and probabilistically selects a token.
What might be more surprising is that even when we adjust the temperature down to 0This means that the LLM always chooses the highest probability token, which is called greedy sampling. (thus making the sampling theoretically deterministic), LLM APIs are still not deterministic in practice (see past discussions here, here, or here). Even when running inference on your own hardware with an OSS inference library like vLLM or SGLang, sampling still isn&rsquo;t deterministic (see here or here).">
  <meta name="twitter:image" content="https://thinkingmachines.ai/blog/defeating-nondeterminism-in-llm-inference/images/cover-social.png">
  <meta name="twitter:image:width" content="1635">
  <meta name="twitter:image:height" content="858">
  <meta name="twitter:image:alt" content="Defeating Nondeterminism in LLM Inference">

  




<link rel="preload" as="style" href="https://thinkingmachines.ai/css/blog-post.css?v=1762541520">
<link rel="stylesheet" href="https://thinkingmachines.ai/css/blog-post.css?v=1762541520" media="print" onload="this.media='all'">
<noscript><link rel="stylesheet" href="https://thinkingmachines.ai/css/blog-post.css?v=1762541520"></noscript>



</head>

<body>
  <div id="wrapper">
    






<header id="header">
  
  <div id="site-header" class="site-header">
    
    
    <div class="navbar-logo">
      <a href="/">THINKING MACHINES</a>
    </div>
    

    
    <div class="nav-group">
      
      <nav class="top-nav">
        
        <a href="/tinker/">Tinker</a>
        
        <a href="/blog/">Blog</a>
        <a href="/#join-us">Join us</a>
      </nav>

      
      <button id="menu-toggle" class="hamburger" aria-label="Open menu" aria-expanded="false" aria-controls="mobile-menu" type="button">
        <span></span>
        <span></span>
        <span></span>
      </button>
      
    </div>
  </div>
  
  
  <div id="mobile-menu" class="mobile-menu-overlay" aria-hidden="true">
    <nav class="mobile-menu-nav" role="navigation" aria-label="Mobile">
      <a href="/">Home</a>
        
        <a href="/tinker/">Tinker</a>
        
      <a href="/blog/">Blog</a>
      <a href="/#join-us">Join us</a>
    </nav>
  </div>
  
  
</header>



    
<main id="main" class="post">
  
  
  
  
  
  
  
  <div class="post-heading">
    <h1 class="post-title">Defeating Nondeterminism in LLM Inference</h1>
    
    <div class="publish-metadata">
      
      
      <span class="author">
        
        <a href="https://x.com/cHHillee" rel="me noopener" target="_blank">Horace He</a> in collaboration with others at Thinking Machines
        
      </span>
      

      
      <span>
        Sep 10, 2025
      </span>

      

      

      
    </div>
  </div>

  

  
  <div class="post-cover">
    
      
      
      <svg xmlns="http://www.w3.org/2000/svg" width="534" height="254" fill="none" viewBox="0 0 534 254"><path fill="#f5f5f5" d="M0 0h534v254H0z"/><path fill="#fff" d="M0 0h534v254H0z"/><g filter="url(#filter0_d_249_8276-cover-svg)"><rect width="38" height="30" x="43" y="54" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="37" height="29" x="43.5" y="54.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="M51.446 73.487h.257q.52 0 .74-.124.219-.132.307-.476.066-.228.088-1.648.03-1.421.03-4.424v-2.337h-1.48q-1.077 0-1.458.294-.373.285-.556 1.215l-.477-.102q.14-.638.213-1.253t.073-1.208q.22.14.886.198.675.058 2.351.058h1.788q2.226 0 2.863-.051.645-.059.901-.205 0 .073-.007.234-.008.154-.008.235 0 .461.037.952.044.49.125 1.01l-.462.088q-.088-.827-.454-1.128-.36-.3-1.523-.337h-1.385q-.008.418-.014 1.18a451 451 0 0 0-.015 2.688q0 2.6.03 3.523.036.922.117 1.15a.6.6 0 0 0 .315.366q.219.102.673.102h.257V74q-.609-.03-1.15-.044-.535-.015-.96-.015-.373 0-.922.015-.543.015-1.18.044zm9.742-10.81q-.03 1.23-.052 2.512-.021 1.281-.03 2.63.822-.623 1.466-.916.645-.3 1.172-.3 1.076 0 1.618.607.542.609.542 1.824l-.007.645q-.007.637-.007 1.274 0 .27-.008.681a36 36 0 0 0-.007.55q0 .82.147 1.069.146.249.556.249l.08-.007a1 1 0 0 1 .103-.008V74q-.667-.044-1.003-.059a13 13 0 0 0-.557-.014q-.351 0-.761.022-.404.015-.843.051l-.007-.513h.11q.937 0 .96-1.714v-.146l.014-1.575v-.3q0-1.333-.315-1.765-.315-.44-1.084-.44-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.037 2.608q0 .219-.007.564t-.007.476q0 .908.146 1.179.147.27.564.271.03 0 .088-.007a1 1 0 0 1 .102-.008V74a20 20 0 0 0-.871-.051 13 13 0 0 0-1.362-.008q-.374.015-.975.052v-.506q.045 0 .125.008.081.007.117.007.506 0 .681-.264.176-.27.176-1.56v-.542l.03-5.508v-1.26q0-.315-.14-.468-.132-.161-.403-.161-.102 0-.337.044a.4.4 0 0 1-.08.014l-.11-.476q.6-.117 1.18-.27.577-.162 1.157-.374m12.876 7.229h-3.575q-.417 0-.769.014-.35.015-.652.044v.271q0 1.435.66 2.22.666.783 1.875.783.534 0 1.054-.175a5.3 5.3 0 0 0 1.106-.564l.286.468q-.755.615-1.509.93-.747.315-1.48.315-1.42 0-2.343-1.01-.923-1.019-.923-2.608 0-1.692.967-2.842.966-1.15 2.358-1.15 1.296 0 2.066.865.768.864.879 2.439m-1.355-.77q-.221-.9-.667-1.376-.447-.484-1.07-.484-.702 0-1.208.564-.498.564-.652 1.524 1.45 0 2.278-.052.835-.05 1.319-.175"/></g><g filter="url(#filter1_d_249_8276-cover-svg)"><rect width="46" height="30" x="86" y="54" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="45" height="29" x="86.5" y="54.5" stroke="#e9411b" stroke-opacity=".3" rx="1.5" shape-rendering="crispEdges"/><path fill="#e9411b" d="M97.413 66.903q0 .447.044.9.05.455.139.916l-.557.088q-.088-.762-.483-1.135-.396-.374-1.106-.374-.615 0-1.011.337-.395.33-.395.843 0 .812 1.728 1.289l.461.124q.865.241 1.26.689.403.446.403 1.171 0 1.07-.842 1.766-.835.696-2.146.695-.476 0-.974-.102a6 6 0 0 1-1.019-.308q.008-.073.008-.154.007-.08.007-.249a7 7 0 0 0-.044-.725 10 10 0 0 0-.117-.835l.55-.132q.117.909.57 1.363.454.447 1.26.447.734 0 1.194-.352.47-.36.469-.923 0-.79-1.553-1.26l-.227-.073q-1.113-.336-1.567-.828-.447-.49-.447-1.303 0-.938.747-1.553.747-.622 1.912-.622.359 0 .776.073.424.073.96.227m3.545-1.48.483.147q-.044.402-.073.725-.023.314-.03.623h.52q.418 0 .85-.008.432-.015.872-.036l-.176.798q-.47-.038-.886-.044-.41-.015-.821-.015h-.344l-.066 1.934q-.015.666-.015 1.106 0 1.655.228 2.16.227.498.812.498.243 0 .535-.102.3-.102.725-.337l.242.484a8.3 8.3 0 0 1-1.274.644q-.571.213-.997.212-.783 0-1.142-.534-.359-.543-.359-1.736 0-.234.029-1.67.037-1.443.037-2.644a28 28 0 0 1-1.026.03v-.528q.719-.103 1.187-.527.469-.433.689-1.18m7.119 1.949q-.982 0-1.582.717-.594.711-.594 1.92 0 1.545.66 2.504.666.96 1.728.96 1.026 0 1.633-.762.616-.762.616-2.073 0-1.435-.696-2.35-.689-.916-1.765-.916m.19-.77q1.545 0 2.556 1.04 1.018 1.034 1.018 2.564 0 1.684-1.069 2.842-1.07 1.15-2.637 1.15t-2.578-1.055q-1.003-1.055-1.003-2.666t1.091-2.74q1.098-1.134 2.622-1.134m6.797-.087q-.051.498-.081 1.01-.029.505-.044 1.077.594-1.047 1.092-1.509.505-.46 1.04-.461.417 0 .659.227.242.22.242.6 0 .271-.161.47a.46.46 0 0 1-.367.19q-.132 0-.41-.14-.27-.146-.469-.146-.38 0-.761.337-.38.33-.799 1.033v.805q0 1.172.015 1.905.022.724.059.922.066.374.278.513.22.14.74.14h.212V74a37 37 0 0 0-1.018-.066 16 16 0 0 0-1.633 0q-.447.023-.938.066v-.513h.169q.534 0 .725-.256t.19-1.194v-3.149q0-.792-.11-1.018-.11-.228-.402-.227-.06 0-.125.007-.066 0-.22.022l-.088-.454a13 13 0 0 0 1.07-.293q.549-.176 1.135-.41m3.391.307q.549.037.879.052t.564.014q.22 0 .557-.014.343-.015.952-.06v.514h-.191q-.366 0-.512.102-.147.095-.147.344 0 .19.645 1.934.615 1.655 1.018 2.79a133 133 0 0 0 1.428-3.486q.417-1.07.417-1.281 0-.213-.161-.308-.16-.095-.527-.095h-.11v-.513a15 15 0 0 0 1.26.059q.242 0 .556-.015t.674-.044v.513h-.058a.73.73 0 0 0-.41.11.8.8 0 0 0-.279.336l-.124.286a291 291 0 0 1-1.663 3.765q-.44.996-1.12 2.6-1.466 3.471-2.256 3.472a.68.68 0 0 1-.491-.19.64.64 0 0 1-.198-.484q0-.403.564-.506.228-.036.322-.08.41-.162 1.18-1.86.212-.477.337-.748a169 169 0 0 1-1.246-3.347q-1.222-3.369-1.743-3.369a.3.3 0 0 0-.073.007h-.044z"/></g><g filter="url(#filter2_d_249_8276-cover-svg)"><rect width="26" height="30" x="137" y="54" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="25" height="29" x="137.5" y="54.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="M147.021 67.372q-.981 0-1.582.717-.593.711-.593 1.92 0 1.545.659 2.504.666.96 1.728.96 1.026 0 1.634-.762.615-.762.615-2.073 0-1.435-.696-2.35-.688-.916-1.765-.916m.19-.77q1.546 0 2.557 1.04 1.017 1.034 1.018 2.564 0 1.684-1.07 2.842-1.069 1.15-2.636 1.15t-2.579-1.055q-1.002-1.055-1.003-2.666t1.091-2.74q1.1-1.134 2.622-1.134m6.812-.249.015.608h.49q.381 0 .747-.007l.711-.03q0 .03-.007.096-.022.47-.022.652l-.088-.007a33 33 0 0 0-1.487-.052h-.315q0 .784-.015 1.707v.33q0 1.676.022 2.387.023.711.081.96.073.293.3.402.234.103.886.103V74q-.717-.044-1.106-.059-.387-.014-.652-.014-.234 0-.607.014-.374.015-1.172.059v-.498h.19q.505 0 .681-.308.176-.307.176-1.34 0-.197-.007-.791a84 84 0 0 1-.008-.996q0-.542-.007-1.143 0-.608-.007-1.281h-.484l-.197.014-.337.015v-.542a2.4 2.4 0 0 0 .564-.088q.249-.074.454-.212v-.132q0-1.86.879-2.945.88-1.09 2.387-1.09.689 0 1.07.226.388.227.388.623a.64.64 0 0 1-.154.44.45.45 0 0 1-.359.175q-.132 0-.688-.286-.55-.293-.901-.293-.77 0-1.099.586-.322.586-.322 2.08z"/></g><g filter="url(#filter3_d_249_8276-cover-svg)"><rect width="73" height="30" x="168" y="54" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="72" height="29" x="168.5" y="54.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="M176.446 73.487h.257q.52 0 .739-.124.22-.132.308-.476.066-.228.088-1.648.029-1.421.029-4.424v-2.337h-1.479q-1.077 0-1.458.294-.373.285-.556 1.215l-.477-.102q.14-.638.213-1.253t.073-1.208q.22.14.886.198.674.058 2.351.058h1.788q2.226 0 2.863-.051.645-.059.901-.205 0 .073-.007.234a5 5 0 0 0-.007.235q0 .461.036.952.044.49.125 1.01l-.462.088q-.088-.827-.454-1.128-.359-.3-1.523-.337h-1.385q-.006.418-.014 1.18-.015 2-.015 2.688 0 2.6.029 3.523.037.922.118 1.15a.6.6 0 0 0 .315.366q.22.102.673.102h.257V74q-.609-.03-1.15-.044-.535-.015-.96-.015-.373 0-.923.015-.541.015-1.179.044zm9.742-10.81q-.03 1.23-.052 2.512-.021 1.281-.029 2.63.82-.623 1.465-.916.644-.3 1.172-.3 1.076 0 1.618.607.543.609.542 1.824l-.007.645q-.007.637-.007 1.274 0 .27-.008.681-.007.403-.007.55 0 .82.146 1.069.147.249.557.249l.081-.007a1 1 0 0 1 .102-.008V74q-.666-.044-1.003-.059t-.557-.014q-.351 0-.762.022-.402.015-.842.051l-.007-.513h.11q.938 0 .959-1.714v-.146l.015-1.575v-.3q0-1.333-.315-1.765-.315-.44-1.084-.44-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.037 2.608q0 .219-.007.564t-.007.476q0 .908.146 1.179.147.27.564.271l.088-.007a1 1 0 0 1 .102-.008V74a20 20 0 0 0-.871-.051 13 13 0 0 0-1.362-.008q-.374.015-.975.052v-.506q.044 0 .125.008.081.007.117.007.505 0 .681-.264.177-.27.176-1.56v-.542l.029-5.508v-1.26q0-.315-.139-.468-.132-.161-.403-.161-.102 0-.336.044a.4.4 0 0 1-.081.014l-.11-.476q.6-.117 1.179-.27.579-.162 1.158-.374m8.957 3.838-.022.79a151 151 0 0 0-.095 4.146v.777q0 .849.161 1.069.16.22.63.22.044 0 .117-.008.073-.007.11-.007V74q-.623-.044-1.004-.059a17 17 0 0 0-.644-.014q-.234 0-.601.014-.358.015-1.084.059v-.513h.183q.909 0 .916-1.787v-.403l.029-1.809q0-.198.008-.498.007-.3.007-.403 0-.593-.117-.783-.11-.19-.41-.19a2 2 0 0 0-.176.014 6 6 0 0 0-.242.022l-.073-.462q.579-.11 1.15-.278.578-.168 1.157-.395m-.791-3.45.52.388q.206.154.3.308a.6.6 0 0 1 .096.322q0 .168-.081.293-.073.117-.286.278l-.549.418-.513-.403a1.5 1.5 0 0 1-.307-.308.55.55 0 0 1-.022-.586q.073-.124.3-.293zm5.112 3.45-.088 1.23q.828-.6 1.436-.871.615-.271 1.128-.271 1.076 0 1.619.607.542.609.542 1.824l-.008.645q-.007.637-.007 1.274 0 .27-.007.681-.008.403-.008.55 0 .82.147 1.069.146.249.556.249l.081-.007a1 1 0 0 1 .095-.008V74q-.659-.044-.996-.059-.338-.014-.564-.014-.351 0-.762.022-.41.015-.835.051l-.007-.513h.11q.937 0 .952-1.714.007-.095.007-.146l.015-1.575v-.263q0-1.356-.315-1.795-.315-.447-1.084-.447-.425 0-.945.205a5.5 5.5 0 0 0-1.091.594q-.03.761-.044 1.443-.015.673-.015 1.223v1.01q0 .967.14 1.224.145.256.564.256l.087-.007q.067-.008.103-.008V74q-.63-.044-.996-.059a15 15 0 0 0-.593-.014q-.22 0-.579.014t-1.003.059l-.008-.513h.139q.916 0 .923-1.78 0-.263.008-.41l.014-1.794v-.725q0-.718-.11-.938-.11-.227-.402-.227-.06 0-.154.015a2 2 0 0 0-.191.044l-.088-.454a9 9 0 0 0 1.099-.279q.557-.175 1.135-.424M211.185 74l-.007-.147q0-.293-.44-.776l-.176-.19-2.475-2.784q.402-.38 1.077-.988 1.479-1.348 1.479-1.612 0-.088-.139-.139a1.2 1.2 0 0 0-.388-.051h-.103v-.498l.806.037a30 30 0 0 0 1.311 0q.381-.015.798-.037l.008.49h-.074a.6.6 0 0 0-.11-.007q-.783 0-2.688 1.75-.49.448-.761.69l2.6 2.797q.073.08.212.242.623.725 1.194.725h.125l.087-.007-.021.505q-.425-.036-.74-.051a8 8 0 0 0-.557-.022q-.117 0-.3.014-.176.008-.718.059m-5.347-.513h.11q.381 0 .572-.102a.65.65 0 0 0 .278-.374q.11-.373.132-3.457.007-.285.007-.432l.015-1.42.022-1.297q.022-.828.022-1.15 0-.9-.132-1.209-.124-.307-.469-.307-.102 0-.337.044a.4.4 0 0 1-.08.014l-.11-.476q.6-.117 1.179-.27.578-.162 1.157-.374l-.088 4.563a237 237 0 0 0-.029 2.724v2.644q0 .594.176.733.183.139.783.146V74q-.505-.044-.908-.066a13 13 0 0 0-2.3.066zm10.708-6.972-.022.79a151 151 0 0 0-.095 4.146v.777q0 .849.161 1.069.162.22.63.22a1 1 0 0 0 .117-.008q.074-.007.11-.007V74q-.622-.044-1.003-.059t-.645-.014q-.234 0-.6.014-.36.015-1.084.059v-.513h.183q.907 0 .915-1.787v-.403l.03-1.809q0-.198.007-.498t.007-.403q0-.593-.117-.783-.11-.19-.41-.19a2 2 0 0 0-.176.014 6 6 0 0 0-.242.022l-.073-.462q.579-.11 1.15-.278a13 13 0 0 0 1.157-.395m-.791-3.45.52.388q.205.154.301.308.095.154.095.322t-.081.293q-.073.117-.285.278l-.55.418-.512-.403a1.5 1.5 0 0 1-.308-.308.56.56 0 0 1-.022-.586q.074-.124.3-.293zm5.113 3.45-.088 1.23q.828-.6 1.435-.871.615-.271 1.128-.271 1.077 0 1.619.607.542.609.542 1.824l-.007.645q-.008.637-.008 1.274 0 .27-.007.681-.007.403-.007.55 0 .82.146 1.069.147.249.557.249l.08-.007a1 1 0 0 1 .096-.008V74q-.66-.044-.997-.059t-.564-.014q-.351 0-.761.022-.41.015-.835.051l-.008-.513h.11q.938 0 .952-1.714.008-.095.008-.146l.014-1.575v-.263q0-1.356-.315-1.795-.314-.447-1.083-.447-.426 0-.945.205-.513.198-1.092.594-.029.761-.044 1.443-.014.673-.014 1.223v1.01q0 .967.139 1.224.147.256.564.256l.088-.007a1 1 0 0 1 .102-.008V74q-.63-.044-.996-.059a15 15 0 0 0-.593-.014q-.219 0-.579.014-.358.015-1.003.059l-.007-.513h.139q.915 0 .923-1.78 0-.263.007-.41l.015-1.794v-.725q0-.718-.11-.938-.11-.227-.403-.227-.058 0-.154.015-.088.014-.19.044l-.088-.454a9 9 0 0 0 1.098-.279q.558-.175 1.136-.424m9.704.644q-.783 0-1.216.484-.432.483-.432 1.362 0 .966.418 1.509.425.534 1.186.534.77 0 1.209-.483.44-.49.439-1.348 0-.989-.417-1.523-.418-.535-1.187-.535m-1.333 6.738a3.6 3.6 0 0 0-.527.733 1.4 1.4 0 0 0-.169.63q0 .68.608 1.15.616.468 1.538.468 1.048 0 1.81-.585.768-.578.769-1.304 0-.594-.374-.835-.373-.242-1.436-.242-.11 0-.483-.007a33 33 0 0 0-.63-.008zm3.069-6.782a34 34 0 0 0 2-.058l-.037.732a10 10 0 0 0-.71-.051 16 16 0 0 0-.887-.022q.345.264.52.644.183.374.183.828 0 .99-.827 1.7-.82.71-2.022.71-.124 0-.351-.015l-.323-.03q-.197.133-.373.279-.176.139-.322.293.11.206.249.38.146.169.337.323.226 0 .651-.007a81 81 0 0 1 1.348-.022q1.326 0 1.904.403.586.402.586 1.296 0 .57-.322 1.15-.315.585-.893 1.07a4.5 4.5 0 0 1-1.37.768 4.5 4.5 0 0 1-1.531.279q-1.135 0-1.904-.6-.762-.601-.762-1.459 0-.498.315-.98.322-.477 1.121-1.129a3.7 3.7 0 0 1-.55-.615 3 3 0 0 1-.344-.689q.264-.249.579-.468.315-.227.696-.447-.74-.235-1.158-.784a2.05 2.05 0 0 1-.417-1.274q0-1.135.835-1.92.842-.783 2.102-.783.461 0 .864.125.404.117.813.373"/></g><g filter="url(#filter4_d_249_8276-cover-svg)"><rect width="76" height="30" x="246" y="54" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="75" height="29" x="246.5" y="54.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="m258.826 71.437 2.117-4.805.088-.198q1.047-2.366 1.047-2.798a.2.2 0 0 0-.007-.044.2.2 0 0 1-.008-.044q.433.022.777.037.351.007.622.007.257 0 .594-.007.336-.015.739-.037v.506h-.087q-.637 0-.879.22-.235.219-.235.783 0 .22.03.982.028.761.073 1.647l.124 2.059.008.197q.16 2.74.249 3.099a.47.47 0 0 0 .271.33q.227.116.593.116h.183V74q-.579-.03-1.077-.044-.498-.015-.827-.015-.389 0-.872.015t-1.033.044v-.527q.067 0 .169.007t.146.007q.557 0 .769-.197.22-.199.22-.718a15 15 0 0 0-.029-.96l-.286-6.298-3.003 6.906-.029.066a6.6 6.6 0 0 0-.52 1.546h-.483q-.104-.454-.513-1.392l-.029-.066-2.952-6.687q-.044.784-.125 2.153-.204 3.399-.205 4.256v.073q0 .93.205 1.128.213.19.857.19h.154V74q-.476-.03-.915-.044-.433-.015-.843-.015-.293 0-.732.015-.432.015-.93.044v-.513h.205q.417 0 .622-.102a.7.7 0 0 0 .323-.36q.139-.3.285-2.43.037-.587.066-.93l.132-1.773v-.022q.198-2.63.198-2.989 0-.46-.227-.644-.22-.183-.843-.183h-.117v-.506q.059 0 .191.008.85.05 1.186.05.257 0 .974-.043.227-.015.345-.015v.044q0 .652 2.482 6.153zm13.865 1.501.205.461a6.4 6.4 0 0 1-1.003.608q-.454.22-.733.22-.469 0-.703-.27-.235-.28-.256-.836-.799.535-1.326.77-.528.225-.945.226-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.161 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.763-.315-1.12-.315-.367-.959-.367-.63 0-.996.234-.359.228-.359.623 0 .036.007.102l.008.088q0 .228-.22.381a.93.93 0 0 1-.528.147q-.263 0-.388-.088-.124-.089-.124-.271 0-.586.989-1.304.988-.725 2.043-.725 1.018 0 1.545.564.528.556.528 1.64 0 .587-.073 1.802-.066 1.216-.066 1.846 0 .475.102.645.11.168.381.168a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.652-2.38 1.538 0 .484.307.791.308.3.813.3.307 0 .711-.16a5.5 5.5 0 0 0 .937-.513zm8.753 2.095.366.557q-.71.542-1.399.82a3.5 3.5 0 0 1-1.304.278q-1.435 0-2.343-1.025-.909-1.032-.909-2.637 0-1.663 1.15-2.812 1.15-1.15 2.805-1.15.85 0 1.312.242.46.234.461.659a.8.8 0 0 1-.19.534q-.184.22-.425.22-.081 0-.681-.366-.594-.374-1.136-.374-.952 0-1.516.689-.556.681-.556 1.86 0 1.486.673 2.322.681.828 1.883.828.447 0 .886-.154.447-.154.923-.49m3.362-9.88q-.03 1.23-.052 2.512-.021 1.281-.029 2.63.82-.623 1.465-.916.644-.3 1.172-.3 1.077 0 1.618.607.543.609.542 1.824l-.007.645q-.007.637-.007 1.274 0 .27-.008.681-.007.403-.007.55 0 .82.147 1.069.146.249.556.249l.081-.007a1 1 0 0 1 .102-.008V74q-.666-.044-1.003-.059t-.557-.014q-.351 0-.761.022-.403.015-.843.051l-.007-.513h.11q.938 0 .959-1.714v-.146l.015-1.575v-.3q0-1.333-.315-1.765-.315-.44-1.084-.44-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.037 2.608q0 .219-.007.564t-.007.476q0 .908.146 1.179.147.27.564.271l.088-.007a1 1 0 0 1 .103-.008V74a20 20 0 0 0-.872-.051 13 13 0 0 0-1.362-.008q-.374.015-.974.052v-.506q.043 0 .124.008.081.007.117.007.505 0 .681-.264.176-.27.176-1.56v-.542l.03-5.508v-1.26q0-.315-.14-.468-.132-.161-.402-.161a2 2 0 0 0-.337.044.4.4 0 0 1-.081.014l-.11-.476q.601-.117 1.179-.27.579-.162 1.158-.374m8.957 3.838-.022.79a151 151 0 0 0-.095 4.146v.777q0 .849.161 1.069t.63.22q.043 0 .117-.008.074-.007.11-.007V74q-.622-.044-1.003-.059t-.645-.014q-.234 0-.601.014-.358.015-1.084.059v-.513h.184q.907 0 .915-1.787v-.403l.029-1.809q0-.198.008-.498.007-.3.007-.403 0-.593-.117-.783-.11-.19-.41-.19a2 2 0 0 0-.176.014 6 6 0 0 0-.242.022l-.073-.462q.579-.11 1.15-.278.579-.168 1.157-.395m-.791-3.45.52.388q.206.154.3.308a.6.6 0 0 1 .096.322q0 .168-.081.293-.073.117-.286.278l-.549.418-.513-.403a1.5 1.5 0 0 1-.307-.308.55.55 0 0 1-.095-.307q0-.161.073-.279.073-.124.3-.293zm5.112 3.45-.087 1.23q.827-.6 1.435-.871.615-.271 1.128-.271 1.077 0 1.619.607.542.609.542 1.824l-.008.645q-.007.637-.007 1.274 0 .27-.007.681-.008.403-.008.55 0 .82.147 1.069t.556.249l.081-.007a1 1 0 0 1 .095-.008V74q-.659-.044-.996-.059t-.564-.014q-.351 0-.762.022-.41.015-.834.051l-.008-.513h.11q.937 0 .952-1.714.008-.095.008-.146l.014-1.575v-.263q0-1.356-.315-1.795-.315-.447-1.084-.447-.425 0-.945.205a5.5 5.5 0 0 0-1.091.594q-.029.761-.044 1.443-.014.673-.014 1.223v1.01q0 .967.139 1.224.146.256.564.256l.088-.007a1 1 0 0 1 .102-.008V74q-.63-.044-.996-.059a15 15 0 0 0-.593-.014q-.22 0-.579.014t-1.003.059l-.008-.513h.14q.916 0 .922-1.78 0-.263.008-.41l.014-1.794v-.725q0-.718-.109-.938-.11-.227-.403-.227-.059 0-.154.015a2 2 0 0 0-.191.044l-.087-.454a9 9 0 0 0 1.098-.279q.557-.175 1.135-.424m12.81 3.39h-3.574q-.417 0-.769.015-.35.015-.652.044v.271q0 1.435.66 2.22.666.783 1.875.783.535 0 1.054-.175a5.3 5.3 0 0 0 1.106-.564l.286.468a6.2 6.2 0 0 1-1.509.93q-.747.315-1.479.315-1.422 0-2.344-1.01-.923-1.019-.923-2.608 0-1.692.967-2.842.966-1.15 2.358-1.15 1.296 0 2.066.865.768.864.878 2.439m-1.354-.768q-.22-.9-.667-1.377-.447-.484-1.069-.484-.704 0-1.209.564-.498.564-.652 1.524 1.45 0 2.278-.052.835-.05 1.319-.175m7.28-2.234q0 .447.044.9.05.455.139.916l-.557.088q-.087-.762-.483-1.135-.396-.374-1.106-.374-.615 0-1.011.337-.395.33-.395.843 0 .812 1.728 1.289l.462.124q.864.241 1.259.689.403.446.403 1.171 0 1.07-.842 1.766-.835.696-2.146.695a5 5 0 0 1-.974-.102 6 6 0 0 1-1.018-.308q.007-.073.007-.154.007-.08.007-.249 0-.336-.044-.725a9 9 0 0 0-.117-.835l.55-.132q.117.909.571 1.363.454.447 1.26.447.732 0 1.193-.352.47-.36.469-.923 0-.79-1.553-1.26l-.227-.073q-1.113-.336-1.567-.828-.447-.49-.447-1.303 0-.938.747-1.553.748-.622 1.912-.622.359 0 .776.073.425.073.96.227"/></g><g filter="url(#filter5_d_249_8276-cover-svg)"><rect width="94" height="30" x="327" y="54" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="93" height="29" x="327.5" y="54.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="M342.617 63.878v.249q0 .512.036 1.07.037.548.11 1.156l-.534.088q-.147-1.055-.997-1.64-.85-.594-2.219-.594-1.824 0-2.82 1.121-.988 1.113-.988 3.164 0 2.19 1.135 3.545 1.143 1.347 2.959 1.348 1.143 0 1.977-.528.843-.526 1.311-1.545l.491.242a12.6 12.6 0 0 0-.762 1.963 8.2 8.2 0 0 1-1.611.542 7.5 7.5 0 0 1-1.648.183q-2.431 0-3.94-1.502-1.502-1.508-1.502-3.962 0-2.417 1.59-3.933 1.589-1.524 4.108-1.524.748 0 1.575.14.835.138 1.729.417m5.009 3.494q-.98 0-1.582.717-.593.711-.593 1.92 0 1.545.659 2.504.667.96 1.729.96 1.025 0 1.633-.762.615-.762.615-2.073 0-1.435-.695-2.35-.689-.916-1.766-.916m.191-.77q1.545 0 2.556 1.04 1.018 1.034 1.018 2.564 0 1.684-1.069 2.842-1.07 1.15-2.637 1.15t-2.578-1.055q-1.003-1.055-1.003-2.666t1.091-2.74q1.098-1.134 2.622-1.134m6.797-.087q-.051.498-.081 1.01-.029.505-.044 1.077.594-1.047 1.092-1.509.504-.46 1.04-.461.417 0 .659.227.241.22.241.6 0 .271-.161.47a.46.46 0 0 1-.366.19q-.131 0-.41-.14-.271-.146-.469-.146-.381 0-.761.337-.382.33-.799 1.033v.805q0 1.172.015 1.905.022.724.058.922.066.374.279.513.22.14.739.14h.213V74a37 37 0 0 0-1.018-.066 16 16 0 0 0-1.633 0q-.447.023-.938.066v-.513h.168q.535 0 .726-.256t.19-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.058 0-.124.007-.066 0-.22.022l-.088-.454a13 13 0 0 0 1.07-.293q.549-.176 1.135-.41m5.632 6.423q.44.212.879.33.44.117.835.117 1.084 0 1.699-.71.623-.719.623-1.993 0-1.377-.608-2.197-.608-.828-1.597-.828-.425 0-.893.14a4 4 0 0 0-.894.395q-.029 1.07-.044 2.021-.015.952-.015 1.744 0 .139.008.468.007.322.007.513m.103-6.511-.059 1.172a5.7 5.7 0 0 1 1.238-.674 3.3 3.3 0 0 1 1.135-.213q1.209 0 2.022.967.813.96.813 2.388 0 1.86-1.04 2.915-1.034 1.047-2.864 1.047a3.6 3.6 0 0 1-.681-.066 4.4 4.4 0 0 1-.682-.205v2.615q0 .865 1.268.879h.007v.527a35 35 0 0 0-.938-.058q-.446-.015-.849-.015-.241 0-.63.015-.388.015-1.165.058v-.527q.477 0 .645-.051a.43.43 0 0 0 .256-.169q.191-.33.205-2.988v-.857l.015-1.663v-2.417q0-.907-.11-1.135-.102-.227-.41-.227-.074 0-.176.015t-.22.044l-.073-.447q.623-.175 1.187-.403.571-.234 1.106-.527m9.807.945q-.982 0-1.582.717-.594.711-.594 1.92 0 1.545.66 2.504.666.96 1.728.96 1.026 0 1.633-.762.616-.762.616-2.073 0-1.435-.696-2.35-.688-.916-1.765-.916m.19-.77q1.546 0 2.556 1.04 1.018 1.034 1.018 2.564 0 1.684-1.069 2.842-1.07 1.15-2.637 1.15t-2.578-1.055q-1.003-1.055-1.003-2.666t1.091-2.74q1.1-1.134 2.622-1.134m6.797-.087q-.051.498-.081 1.01-.029.505-.043 1.077.593-1.047 1.091-1.509.505-.46 1.04-.461.417 0 .659.227.242.22.242.6 0 .271-.161.47a.46.46 0 0 1-.367.19q-.13 0-.41-.14-.27-.146-.468-.146-.381 0-.762.337-.38.33-.799 1.033v.805q0 1.172.015 1.905.022.724.059.922.065.374.278.513.22.14.74.14h.212V74a37 37 0 0 0-1.018-.066 16 16 0 0 0-1.633 0q-.447.023-.938.066v-.513h.169q.534 0 .725-.256t.19-1.194v-3.149q0-.792-.11-1.018-.11-.228-.402-.227-.059 0-.125.007-.066 0-.22.022l-.088-.454q.52-.117 1.07-.293.549-.176 1.135-.41m10.151 6.423.206.461a6.4 6.4 0 0 1-1.004.608q-.455.22-.732.22-.47 0-.703-.27-.235-.28-.257-.836-.798.535-1.325.77-.528.225-.945.226-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.695-.161 1.083-.257 0-.124.008-.358.021-.484.022-.63 0-.763-.315-1.12-.315-.367-.96-.367-.63 0-.996.234-.359.228-.359.623a1 1 0 0 0 .008.102l.007.088q0 .228-.22.381a.93.93 0 0 1-.527.147q-.264 0-.388-.088-.125-.089-.125-.271 0-.586.989-1.304.988-.725 2.044-.725 1.017 0 1.545.564.527.556.527 1.64 0 .587-.073 1.802-.066 1.216-.066 1.846 0 .475.103.645.11.168.381.168a1 1 0 0 0 .3-.066 8 8 0 0 0 .556-.249m-2.497-2.476-.418.11q-2.38.652-2.38 1.538 0 .484.308.791.308.3.813.3.308 0 .71-.16.403-.162.938-.513zm4.988-5.039.483.147q-.044.402-.073.725-.023.314-.029.623h.52q.417 0 .849-.008.432-.015.872-.036l-.176.798q-.47-.038-.886-.044-.41-.015-.821-.015h-.344l-.066 1.934q-.014.666-.014 1.106 0 1.655.227 2.16.226.498.813.498.241 0 .534-.102.301-.102.725-.337l.242.484a8 8 0 0 1-1.274.644q-.572.213-.996.212-.785 0-1.143-.534-.359-.543-.359-1.736 0-.234.029-1.67.037-1.443.037-2.644-.066 0-.19.007-.609.022-.835.022v-.527q.718-.103 1.186-.527.469-.433.689-1.18m5.991 1.092-.022.79a147 147 0 0 0-.095 4.146v.777q0 .849.161 1.069.16.22.63.22.043 0 .117-.008.073-.007.11-.007V74q-.623-.044-1.004-.059-.38-.014-.644-.014-.235 0-.601.014-.358.015-1.084.059v-.513h.183q.909 0 .916-1.787v-.403l.029-1.809q0-.198.007-.498.008-.3.008-.403 0-.593-.117-.783-.11-.19-.411-.19-.058 0-.175.014a5 5 0 0 0-.242.022l-.073-.462a12 12 0 0 0 1.15-.278q.578-.168 1.157-.395m-.791-3.45.52.388q.206.154.3.308.095.154.095.322t-.08.293q-.073.117-.286.278l-.549.418-.513-.403a1.5 1.5 0 0 1-.307-.308.55.55 0 0 1-.022-.586q.073-.124.3-.293zm6.372 4.307q-.981 0-1.582.717-.594.711-.593 1.92 0 1.545.659 2.504.666.96 1.728.96 1.026 0 1.634-.762.615-.762.615-2.073 0-1.435-.696-2.35-.688-.916-1.765-.916m.19-.77q1.546 0 2.557 1.04 1.017 1.034 1.018 2.564 0 1.684-1.07 2.842-1.07 1.15-2.636 1.15-1.568 0-2.579-1.055-1.003-1.055-1.003-2.666t1.091-2.74q1.1-1.134 2.622-1.134m6.812-.087-.088 1.23q.828-.6 1.436-.871.615-.271 1.127-.271 1.077 0 1.619.607.542.609.542 1.824l-.007.645q-.008.637-.008 1.274 0 .27-.007.681-.007.403-.007.55 0 .82.146 1.069.147.249.557.249l.081-.007a1 1 0 0 1 .095-.008V74q-.66-.044-.996-.059-.338-.014-.564-.014-.353 0-.762.022-.41.015-.835.051l-.007-.513h.11q.937 0 .952-1.714.007-.095.007-.146l.015-1.575v-.263q0-1.356-.315-1.795-.315-.447-1.084-.447-.425 0-.945.205-.513.198-1.091.594a74 74 0 0 0-.059 2.666v1.01q0 .967.139 1.224.147.256.564.256l.088-.007a1 1 0 0 1 .103-.008V74q-.63-.044-.997-.059a15 15 0 0 0-.593-.014q-.22 0-.578.014-.36.015-1.004.059l-.007-.513h.139q.915 0 .923-1.78 0-.263.007-.41l.015-1.794v-.725q0-.718-.11-.938-.11-.227-.403-.227-.058 0-.154.015-.087.014-.19.044l-.088-.454a9 9 0 0 0 1.099-.279 12 12 0 0 0 1.135-.424"/></g><g filter="url(#filter6_d_249_8276-cover-svg)"><rect width="56" height="30" x="426" y="54" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="55" height="29" x="426.5" y="54.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="M434.622 73.04q.337.177.674.264.337.08.725.08 1.216.001 1.912-.754.695-.761.695-2.094 0-1.305-.629-2.11-.624-.813-1.619-.813-.418 0-.864.14-.447.138-.996.439l-.015 1.208v1.048q0 1.113.029 1.728t.088.864m-.015-10.393-.007.264q-.11 2.871-.11 4.204v.484q.755-.506 1.326-.725a3 3 0 0 1 1.106-.227q1.209 0 2.08 1.003.872.996.872 2.417 0 1.802-1.15 2.922-1.15 1.114-3.062 1.114-.63 0-1.23-.081a8 8 0 0 1-1.187-.25q.043-2.453.066-3.888.022-1.443.022-1.868v-.974q0-.38.007-.967.008-.585.008-.79 0-.968-.118-1.275-.11-.315-.417-.315-.074 0-.183.014a3 3 0 0 0-.249.03l-.081-.462q.564-.117 1.143-.27t1.164-.36m12.554 7.259h-3.574q-.418 0-.769.014t-.652.044v.271q0 1.435.659 2.22.667.783 1.875.783.535 0 1.055-.175.52-.184 1.106-.564l.285.468q-.753.615-1.508.93a3.8 3.8 0 0 1-1.48.315q-1.42 0-2.344-1.01-.922-1.019-.922-2.608 0-1.692.966-2.842.967-1.15 2.359-1.15 1.297 0 2.065.865.77.864.879 2.439m-1.355-.77q-.219-.9-.666-1.376-.447-.484-1.07-.484-.702 0-1.208.564-.498.564-.652 1.524 1.45 0 2.278-.052.834-.05 1.318-.175m5.574-1.977q-.784 0-1.216.484-.432.483-.432 1.362 0 .966.417 1.509.425.534 1.187.534.769 0 1.208-.483.44-.49.44-1.348 0-.989-.418-1.523-.417-.535-1.186-.535m-1.333 6.738a3.6 3.6 0 0 0-.527.733q-.17.33-.169.63 0 .68.608 1.15.615.468 1.538.468 1.047 0 1.809-.585.77-.578.769-1.304 0-.594-.373-.835-.374-.242-1.436-.242-.11 0-.483-.007a33 33 0 0 0-.63-.008zm3.069-6.782a34 34 0 0 0 1.999-.058l-.036.732a10 10 0 0 0-.711-.051 16 16 0 0 0-.886-.022q.344.264.52.644.183.374.183.828 0 .99-.828 1.7-.82.71-2.021.71-.124 0-.352-.015l-.322-.03q-.198.133-.373.279-.177.139-.323.293.111.206.249.38.147.169.337.323.228 0 .652-.007a81 81 0 0 1 1.348-.022q1.325 0 1.904.403.586.402.586 1.296 0 .57-.322 1.15a3.7 3.7 0 0 1-.894 1.07 4.5 4.5 0 0 1-1.369.768 4.5 4.5 0 0 1-1.531.279q-1.135 0-1.905-.6-.76-.601-.761-1.459 0-.498.315-.98.322-.477 1.12-1.129a3.7 3.7 0 0 1-.549-.615 3 3 0 0 1-.344-.689q.263-.249.578-.468.315-.227.696-.447-.74-.235-1.157-.784a2.05 2.05 0 0 1-.418-1.274q0-1.135.835-1.92.843-.783 2.102-.783.462 0 .865.125.402.117.813.373m5.2-.6-.022.79a147 147 0 0 0-.095 4.146v.777q0 .849.161 1.069.16.22.63.22.043 0 .117-.008.073-.007.11-.007V74q-.623-.044-1.004-.059-.38-.014-.644-.014-.235 0-.601.014-.358.015-1.084.059v-.513h.183q.909 0 .916-1.787v-.403l.029-1.809q0-.198.008-.498.007-.3.007-.403 0-.593-.117-.783-.11-.19-.41-.19-.06 0-.176.014a5 5 0 0 0-.242.022l-.073-.462q.579-.11 1.15-.278.578-.168 1.157-.395m-.791-3.45.52.388q.205.154.3.308.096.154.095.322 0 .168-.08.293-.073.117-.286.278l-.549.418-.513-.403a1.5 1.5 0 0 1-.307-.308.55.55 0 0 1-.022-.586q.073-.124.3-.293zm5.112 3.45-.088 1.23q.828-.6 1.436-.871.615-.271 1.128-.271 1.077 0 1.618.607.543.609.542 1.824l-.007.645q-.007.637-.007 1.274 0 .27-.008.681l-.007.55q0 .82.147 1.069.146.249.556.249l.081-.007a1 1 0 0 1 .095-.008V74q-.659-.044-.996-.059-.338-.014-.564-.014-.351 0-.762.022-.41.015-.835.051l-.007-.513h.11q.937 0 .952-1.714.007-.095.007-.146l.015-1.575v-.263q0-1.356-.315-1.795-.315-.447-1.084-.447-.425 0-.945.205-.512.198-1.091.594-.03.761-.044 1.443-.015.673-.015 1.223v1.01q0 .967.139 1.224.147.256.564.256l.088-.007a1 1 0 0 1 .103-.008V74q-.63-.044-.996-.059a15 15 0 0 0-.593-.014q-.22 0-.579.014t-1.004.059l-.007-.513h.139q.916 0 .923-1.78 0-.263.007-.41l.015-1.794v-.725q0-.718-.11-.938-.11-.227-.403-.227-.058 0-.153.015a2 2 0 0 0-.191.044l-.088-.454a9 9 0 0 0 1.099-.279 12 12 0 0 0 1.135-.424m11.411.388q0 .447.044.9.052.455.139.916l-.556.088q-.088-.762-.484-1.135-.395-.374-1.106-.374-.615 0-1.01.337-.396.33-.396.843 0 .812 1.729 1.289l.461.124q.864.241 1.26.689.402.446.403 1.171 0 1.07-.843 1.766-.834.696-2.146.695a5 5 0 0 1-.974-.102 6 6 0 0 1-1.018-.308q.008-.073.008-.154.007-.08.007-.249 0-.336-.044-.725a10 10 0 0 0-.117-.835l.549-.132q.118.909.571 1.363.454.447 1.26.447.732 0 1.194-.352.47-.36.469-.923 0-.79-1.553-1.26l-.227-.073q-1.113-.336-1.567-.828-.447-.49-.447-1.303 0-.938.747-1.553.747-.622 1.911-.622.36 0 .777.073.425.073.959.227"/></g><g filter="url(#filter7_d_249_8276-cover-svg)"><rect width="35" height="30" x="43" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="34" height="29" x="43.5" y="89.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="m51.761 101.515-.088 1.23q.828-.6 1.436-.871.615-.271 1.128-.271 1.077 0 1.618.607.543.609.543 1.824l-.008.645q-.007.637-.007 1.274 0 .272-.008.681a36 36 0 0 0-.007.55q0 .82.147 1.069.146.249.556.249l.08-.007a1 1 0 0 1 .096-.008V109q-.66-.044-.996-.059a15 15 0 0 0-.564-.014q-.351 0-.762.022a16 16 0 0 0-.835.051l-.007-.513h.11q.937 0 .952-1.714.007-.095.007-.146l.015-1.575v-.263q0-1.356-.315-1.795-.315-.447-1.084-.447-.425 0-.945.205a5.4 5.4 0 0 0-1.091.594q-.03.761-.044 1.443-.015.674-.015 1.223v1.01q0 .967.14 1.224.146.256.563.256.03 0 .088-.007a1 1 0 0 1 .103-.008V109q-.63-.044-.996-.059-.36-.014-.593-.014-.22 0-.58.014-.358.015-1.003.059l-.007-.513h.14q.915 0 .922-1.779 0-.264.008-.411l.014-1.794v-.725q0-.718-.11-.938-.11-.227-.403-.227-.059 0-.153.015-.088.015-.19.044l-.089-.454a9 9 0 0 0 1.099-.279q.557-.175 1.135-.424m10.02.857q-.982 0-1.582.717-.594.711-.593 1.919 0 1.547.659 2.505.666.96 1.728.96 1.026 0 1.633-.762.616-.762.616-2.073 0-1.436-.696-2.351-.689-.915-1.765-.915m.19-.769q1.546 0 2.556 1.04 1.019 1.032 1.018 2.563 0 1.684-1.069 2.842-1.07 1.15-2.637 1.15t-2.578-1.055q-1.003-1.055-1.003-2.666t1.091-2.739q1.1-1.135 2.622-1.135m6.358-1.18.483.147q-.045.402-.073.725-.023.315-.03.622h.52q.418 0 .85-.007.432-.015.872-.036l-.176.798a14 14 0 0 0-.886-.044q-.41-.015-.82-.015h-.345q-.044 1.26-.066 1.934-.014.666-.014 1.106 0 1.655.227 2.16.226.5.813.499.24 0 .534-.103.3-.103.725-.337l.242.483a8 8 0 0 1-1.274.645q-.572.213-.996.212-.784 0-1.143-.534-.36-.543-.359-1.736 0-.234.03-1.67.036-1.443.036-2.644-.066 0-.19.007-.609.022-.835.022v-.527q.717-.102 1.186-.527.469-.433.689-1.18"/></g><g filter="url(#filter8_d_249_8276-cover-svg)"><rect width="26" height="30" x="83" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="25" height="29" x="83.5" y="89.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="m91.893 101.515-.022.791a149 149 0 0 0-.095 4.145v.777q0 .849.161 1.069.16.22.63.22.044 0 .117-.008.073-.007.11-.007V109q-.623-.044-1.004-.059a19 19 0 0 0-.644-.014q-.234 0-.6.014-.36.015-1.085.059v-.513h.183q.909 0 .916-1.787v-.403l.03-1.809q0-.198.007-.498t.007-.403q0-.592-.117-.783-.11-.19-.41-.191-.06 0-.176.015a5 5 0 0 0-.242.022l-.073-.462q.579-.11 1.15-.278.579-.168 1.157-.395m-.79-3.45.52.388q.204.154.3.308.095.154.095.322t-.081.293q-.073.117-.286.278l-.549.418-.513-.403a1.5 1.5 0 0 1-.307-.308.56.56 0 0 1-.022-.586q.074-.124.3-.293zm5.111 3.45-.088 1.23q.828-.6 1.436-.871.615-.271 1.128-.271 1.077 0 1.619.607.542.609.542 1.824l-.008.645q-.007.637-.007 1.274 0 .272-.007.681-.008.403-.008.55 0 .82.147 1.069.146.249.556.249l.081-.007a1 1 0 0 1 .095-.008V109a51 51 0 0 0-.996-.059 15 15 0 0 0-.564-.014q-.351 0-.762.022-.41.014-.835.051l-.007-.513h.11q.937 0 .952-1.714.008-.095.008-.146l.014-1.575v-.263q0-1.356-.315-1.795-.315-.447-1.084-.447-.425 0-.945.205-.512.198-1.09.594-.03.761-.045 1.443-.015.674-.015 1.223v1.01q0 .967.14 1.224.145.256.564.256.029 0 .088-.007a1 1 0 0 1 .102-.008V109q-.63-.044-.996-.059a17 17 0 0 0-.593-.014q-.22 0-.579.014-.36.015-1.003.059l-.008-.513h.14q.915 0 .922-1.779 0-.264.008-.411l.014-1.794v-.725q0-.718-.11-.938-.11-.227-.402-.227-.059 0-.154.015-.088.015-.19.044l-.088-.454a9 9 0 0 0 1.098-.279q.557-.175 1.135-.424"/></g><g filter="url(#filter9_d_249_8276-cover-svg)"><rect width="20" height="30" x="114" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="19" height="29" x="114.5" y="89.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="m127.039 107.938.205.461a6.4 6.4 0 0 1-1.004.608q-.454.22-.732.22-.47 0-.703-.271-.235-.278-.257-.835-.798.535-1.325.769-.528.227-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.161 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.959-.366-.63 0-.997.234-.358.227-.358.623 0 .036.007.102l.007.088q0 .228-.22.381a.9.9 0 0 1-.527.147q-.264 0-.388-.088-.125-.088-.125-.271 0-.586.989-1.304.989-.725 2.044-.725 1.017 0 1.545.564.528.557.527 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.381 1.538 0 .484.308.791.308.301.813.301.308 0 .71-.161.403-.162.938-.513z"/></g><g filter="url(#filter10_d_249_8276-cover-svg)"><rect width="56" height="30" x="139" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="55" height="29" x="139.5" y="89.5" stroke="#f78427" stroke-opacity=".4" rx="1.5" shape-rendering="crispEdges"/><path fill="#f78427" d="M148.706 102.159q-.784 0-1.216.484-.432.483-.432 1.362 0 .966.418 1.509.424.534 1.186.534.77 0 1.209-.483.44-.49.439-1.348 0-.989-.417-1.523-.418-.535-1.187-.535m-1.333 6.738a3.6 3.6 0 0 0-.527.733 1.4 1.4 0 0 0-.169.63q0 .68.608 1.15.615.468 1.538.468 1.048 0 1.809-.586.77-.578.769-1.303 0-.594-.373-.835-.374-.242-1.436-.242-.11 0-.483-.007a33 33 0 0 0-.63-.008zm3.069-6.782a37 37 0 0 0 1.999-.058l-.036.732a10 10 0 0 0-.711-.051 15 15 0 0 0-.886-.022q.345.263.52.644.183.374.183.828 0 .989-.827 1.699-.82.711-2.022.711-.124 0-.351-.015l-.323-.029a4 4 0 0 0-.373.278q-.176.139-.323.293.11.206.25.381.145.168.336.322.228 0 .652-.007a77 77 0 0 1 1.348-.022q1.326 0 1.904.403.586.402.586 1.296 0 .571-.322 1.15a3.6 3.6 0 0 1-.894 1.069 4.5 4.5 0 0 1-1.369.769 4.5 4.5 0 0 1-1.531.279q-1.136 0-1.904-.601-.762-.6-.762-1.457 0-.499.315-.982.322-.475 1.12-1.128a3.8 3.8 0 0 1-.549-.615 3 3 0 0 1-.344-.689 5 5 0 0 1 .579-.468q.315-.228.695-.447-.74-.234-1.157-.784a2.05 2.05 0 0 1-.417-1.274q0-1.136.835-1.919.842-.784 2.102-.784.46 0 .864.125.402.117.813.373m9.346 5.823.205.461a6.4 6.4 0 0 1-1.004.608q-.454.22-.732.22-.47 0-.703-.271-.235-.278-.257-.835-.798.535-1.325.769-.528.227-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.161 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.959-.366-.63 0-.997.234-.358.227-.358.623 0 .036.007.102l.007.088q0 .228-.22.381a.9.9 0 0 1-.527.147q-.264 0-.388-.088-.125-.088-.125-.271 0-.586.989-1.304.989-.725 2.044-.725 1.018 0 1.545.564.527.557.527 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.381 1.538 0 .484.308.791.308.301.813.301.308 0 .71-.161.403-.162.938-.513zm5.427-3.947q-.051.498-.08 1.01-.03.505-.044 1.077.593-1.047 1.091-1.509.506-.46 1.04-.461.417 0 .659.227.242.22.242.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.014 1.905.023.725.059.922.066.373.278.513.22.14.74.139h.212V109q-.57-.043-1.018-.066a15 15 0 0 0-1.633 0q-.447.023-.937.066v-.513h.168q.534 0 .725-.256.19-.257.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.059 0-.125.007-.066 0-.219.022l-.088-.454a13 13 0 0 0 1.069-.293q.55-.176 1.135-.41m10.152 6.423.205.461a6.3 6.3 0 0 1-1.004.608q-.454.22-.732.22-.47 0-.703-.271-.234-.278-.257-.835-.798.535-1.325.769-.528.227-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.161 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.959-.366-.63 0-.996.234-.36.227-.359.623 0 .036.007.102l.007.088q0 .228-.219.381a.93.93 0 0 1-.528.147q-.264 0-.388-.088-.125-.088-.125-.271 0-.586.989-1.304.989-.725 2.044-.725 1.018 0 1.545.564.528.557.527 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.381 1.538 0 .484.308.791.308.301.813.301.308 0 .71-.161.403-.162.938-.513zm6.387-3.303q-.784 0-1.216.484-.432.483-.432 1.362 0 .966.417 1.509.425.534 1.187.534.769 0 1.208-.483.44-.49.44-1.348 0-.989-.418-1.523-.417-.535-1.186-.535m-1.333 6.738a3.7 3.7 0 0 0-.528.733 1.4 1.4 0 0 0-.168.63q0 .68.608 1.15.615.468 1.538.468 1.047 0 1.809-.586.77-.578.769-1.303 0-.594-.373-.835-.374-.242-1.436-.242-.11 0-.483-.007a33 33 0 0 0-.63-.008zm3.069-6.782a37 37 0 0 0 1.999-.058l-.036.732a10 10 0 0 0-.711-.051 15 15 0 0 0-.886-.022q.344.263.52.644.183.374.183.828 0 .989-.828 1.699-.82.711-2.021.711-.124 0-.352-.015l-.322-.029a4 4 0 0 0-.373.278q-.177.139-.323.293a2.5 2.5 0 0 0 .249.381q.147.168.337.322.228 0 .652-.007a77 77 0 0 1 1.348-.022q1.325 0 1.904.403.586.402.586 1.296 0 .571-.322 1.15a3.6 3.6 0 0 1-.894 1.069 4.5 4.5 0 0 1-1.37.769 4.5 4.5 0 0 1-1.53.279q-1.136 0-1.905-.601-.76-.6-.761-1.457 0-.499.315-.982.322-.475 1.12-1.128a3.7 3.7 0 0 1-.549-.615 3 3 0 0 1-.344-.689q.263-.249.578-.468a8 8 0 0 1 .696-.447q-.74-.234-1.157-.784a2.05 2.05 0 0 1-.418-1.274q0-1.136.835-1.919.843-.784 2.102-.784.462 0 .865.125.402.117.813.373m9.118 2.791h-3.574q-.417 0-.769.014-.351.015-.652.044v.271q0 1.435.659 2.22.667.783 1.875.783.535 0 1.055-.176.52-.183 1.106-.563l.286.468a6.1 6.1 0 0 1-1.509.93q-.747.315-1.48.315-1.42 0-2.343-1.01-.923-1.018-.923-2.608 0-1.692.967-2.842.966-1.149 2.358-1.149 1.296 0 2.065.864.77.864.879 2.439m-1.355-.769q-.219-.901-.666-1.377-.447-.483-1.07-.484-.702 0-1.208.564-.498.564-.652 1.524 1.45 0 2.278-.052.835-.05 1.318-.175"/></g><g filter="url(#filter11_d_249_8276-cover-svg)"><rect width="17" height="30" x="200" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="16" height="29" x="200.5" y="89.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="M207.948 107.154q.601.462.784.733.19.27.19.6 0 .542-.556 1.304-.55.769-1.48 1.487l-.388-.476q.484-.381.784-.821t.425-.966q-.41-.257-.572-.44a.56.56 0 0 1-.161-.373q0-.14.095-.279.103-.138.447-.424z"/></g><g filter="url(#filter12_d_249_8276-cover-svg)"><rect width="35" height="30" x="222" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="34" height="29" x="222.5" y="89.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="M230.622 108.041q.337.176.674.263.337.081.725.081 1.216 0 1.912-.755.695-.761.695-2.094 0-1.304-.629-2.11-.624-.813-1.619-.813-.418 0-.864.139-.447.14-.996.44l-.015 1.208v1.048q0 1.113.029 1.728t.088.865m-.015-10.394-.007.264q-.11 2.871-.11 4.204v.484q.755-.506 1.326-.725a3 3 0 0 1 1.106-.228q1.209 0 2.08 1.004.872.996.872 2.417 0 1.802-1.15 2.922-1.15 1.114-3.062 1.114-.63 0-1.23-.081a8 8 0 0 1-1.187-.249q.043-2.454.066-3.889.022-1.443.022-1.868v-.974q0-.38.007-.967.008-.585.008-.791 0-.967-.118-1.274-.11-.315-.417-.315-.074 0-.183.015a3 3 0 0 0-.249.029l-.081-.462q.564-.117 1.143-.27t1.164-.36m8.431 3.948q-.052 1.435-.081 2.52a68 68 0 0 0-.029 1.494q0 1.567.322 2.095.322.52 1.106.52.388 0 .864-.191.477-.19 1.084-.578.023-1.128.029-1.861.015-.732.015-1.076v-.498q0-.923-.154-1.158-.153-.234-.593-.234-.073 0-.161.007-.08 0-.169.008l-.043-.469q.622-.044 1.223-.139.607-.096 1.186-.235-.043 1.253-.066 2.234a82 82 0 0 0-.022 1.714q0 .3-.007.754-.007.447-.007.594 0 .681.117.893.117.213.439.213.073 0 .169-.015.102-.015.263-.059l.059.455-2.234.563-.029-1.091q-.79.601-1.392.879-.593.279-1.084.278-1.003 0-1.567-.578-.564-.579-.564-1.612 0-.263.022-1.105a27 27 0 0 0 .007-.55l.022-.82a23 23 0 0 1 .008-.52l.007-.44q0-.63-.11-.835-.103-.205-.388-.205-.088 0-.205.015l-.242.029-.051-.476q.527-.087 1.084-.212a24 24 0 0 0 1.172-.308m8.437-1.172.483.147q-.043.402-.073.725-.021.315-.029.622h.52q.418 0 .85-.007.432-.015.871-.036l-.176.798a14 14 0 0 0-.886-.044q-.41-.015-.82-.015h-.344q-.045 1.26-.066 1.934-.015.666-.015 1.106 0 1.655.227 2.16.227.5.813.499.241 0 .535-.103.3-.103.725-.337l.242.483a8 8 0 0 1-1.275.645q-.571.213-.996.212-.783 0-1.143-.534-.358-.543-.358-1.736 0-.234.029-1.67.036-1.443.036-2.644-.065 0-.19.007-.608.022-.835.022v-.527q.718-.102 1.187-.527.469-.433.688-1.18"/></g><g filter="url(#filter13_d_249_8276-cover-svg)"><rect width="26" height="30" x="262" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="25" height="29" x="262.5" y="89.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="m270.893 101.515-.022.791a151 151 0 0 0-.095 4.145v.777q0 .849.161 1.069.16.22.63.22.043 0 .117-.008.074-.007.11-.007V109q-.623-.044-1.003-.059a19 19 0 0 0-.645-.014q-.234 0-.601.014-.358.015-1.084.059v-.513h.184q.908 0 .915-1.787v-.403l.029-1.809q0-.198.008-.498.007-.3.007-.403 0-.592-.117-.783-.11-.19-.41-.191a2 2 0 0 0-.176.015 5 5 0 0 0-.242.022l-.073-.462q.579-.11 1.15-.278.578-.168 1.157-.395m-.791-3.45.52.388q.205.154.3.308a.6.6 0 0 1 .096.322q0 .168-.081.293-.073.117-.286.278l-.549.418-.513-.403a1.5 1.5 0 0 1-.307-.308.55.55 0 0 1-.095-.307q0-.161.073-.279.073-.124.3-.293zm5.112 3.45-.088 1.23q.828-.6 1.436-.871.615-.271 1.128-.271 1.077 0 1.619.607.542.609.542 1.824l-.008.645q-.007.637-.007 1.274 0 .272-.007.681-.008.403-.008.55 0 .82.147 1.069.146.249.556.249l.081-.007a1 1 0 0 1 .095-.008V109a51 51 0 0 0-.996-.059 15 15 0 0 0-.564-.014q-.351 0-.762.022-.41.014-.835.051l-.007-.513h.11q.937 0 .952-1.714.007-.095.007-.146l.015-1.575v-.263q0-1.356-.315-1.795-.315-.447-1.084-.447-.425 0-.945.205-.512.198-1.091.594a94 94 0 0 0-.044 1.443q-.015.674-.015 1.223v1.01q0 .967.14 1.224.145.256.564.256l.087-.007q.066-.008.103-.008V109q-.63-.044-.996-.059a17 17 0 0 0-.593-.014q-.22 0-.579.014t-1.003.059l-.008-.513h.139q.916 0 .923-1.779 0-.264.008-.411l.014-1.794v-.725q0-.718-.11-.938-.11-.227-.402-.227-.059 0-.154.015-.088.015-.191.044l-.088-.454a9 9 0 0 0 1.099-.279q.557-.175 1.135-.424"/></g><g filter="url(#filter14_d_249_8276-cover-svg)"><rect width="34" height="30" x="293" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="33" height="29" x="293.5" y="89.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="m301.307 100.423.484.147q-.044.402-.074.725-.021.315-.029.622h.52q.418 0 .85-.007.432-.015.871-.036l-.176.798a14 14 0 0 0-.886-.044q-.41-.015-.82-.015h-.344q-.045 1.26-.066 1.934-.015.666-.015 1.106 0 1.655.227 2.16.227.5.813.499.241 0 .535-.103.3-.103.725-.337l.242.483a8 8 0 0 1-1.275.645q-.572.213-.996.212-.783 0-1.143-.534-.358-.543-.358-1.736 0-.234.029-1.67.036-1.443.037-2.644-.066 0-.191.007-.608.022-.835.022v-.527q.718-.102 1.187-.527.468-.433.688-1.18m5.823-2.746a314 314 0 0 0-.081 5.141q.82-.623 1.465-.915.644-.3 1.172-.3 1.077 0 1.619.607.542.609.542 1.824l-.008.645q-.007.637-.007 1.274 0 .272-.007.681-.008.403-.008.55 0 .82.147 1.069t.557.249l.08-.007a1 1 0 0 1 .103-.008V109a54 54 0 0 0-1.004-.059q-.337-.014-.556-.014-.352 0-.762.022-.403.014-.842.051l-.008-.513h.11q.937 0 .96-1.714v-.146l.014-1.575v-.3q0-1.333-.315-1.765-.315-.44-1.084-.44-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.036 2.608q0 .219-.008.564-.007.344-.007.476 0 .907.146 1.179.147.271.564.271.03 0 .088-.007a1 1 0 0 1 .103-.008V109a20 20 0 0 0-.872-.051 13 13 0 0 0-1.362-.008q-.374.015-.974.052v-.506q.044 0 .124.008.08.007.118.007.505 0 .681-.264.175-.27.175-1.56v-.542l.03-5.508v-1.26q0-.315-.139-.468-.132-.162-.403-.161a2 2 0 0 0-.337.044.4.4 0 0 1-.081.014l-.11-.476q.601-.117 1.18-.27.578-.162 1.157-.374m12.876 7.229h-3.574q-.418 0-.769.014t-.652.044v.271q0 1.435.659 2.22.666.783 1.875.783.534 0 1.055-.176.52-.183 1.106-.563l.285.468a6.1 6.1 0 0 1-1.509.93q-.747.315-1.479.315-1.421 0-2.344-1.01-.923-1.018-.923-2.608 0-1.692.967-2.842.967-1.149 2.359-1.149 1.296 0 2.065.864.77.864.879 2.439m-1.355-.769q-.22-.901-.667-1.377-.446-.483-1.069-.484-.704 0-1.208.564-.499.564-.652 1.524 1.45 0 2.278-.052.834-.05 1.318-.175"/></g><g filter="url(#filter15_d_249_8276-cover-svg)"><rect width="63" height="30" x="332" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="62" height="29" x="332.5" y="89.5" stroke="#009de4" stroke-opacity=".4" rx="1.5" shape-rendering="crispEdges"/><path fill="#009de4" d="M340.747 101.515a22 22 0 0 0-.081 1.01q-.03.505-.044 1.077.594-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .66.227.241.22.241.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.015 1.905.022.725.058.922.066.373.279.513.22.14.739.139h.213V109a41 41 0 0 0-1.018-.066 15 15 0 0 0-1.634 0q-.447.023-.937.066v-.513h.168q.535 0 .725-.256.19-.257.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.058 0-.124.007a2 2 0 0 0-.22.022l-.088-.454q.52-.117 1.069-.293.55-.176 1.136-.41m10.151 6.423.205.461a6.4 6.4 0 0 1-1.003.608q-.454.22-.733.22-.469 0-.703-.271-.235-.278-.256-.835-.799.535-1.326.769-.527.227-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.161 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.959-.366-.63 0-.996.234-.359.227-.359.623 0 .036.007.102l.008.088q0 .228-.22.381a.93.93 0 0 1-.528.147q-.263 0-.388-.088-.124-.088-.124-.271 0-.586.989-1.304.988-.725 2.043-.725 1.019 0 1.545.564.528.557.528 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.102.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.38 1.538 0 .484.307.791.308.301.813.301.308 0 .711-.161.402-.162.937-.513zm5.428-3.947a22 22 0 0 0-.081 1.01q-.029.505-.044 1.077.594-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .66.227.241.22.241.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.015 1.905.022.725.058.922.066.373.279.513.22.14.739.139h.213V109q-.571-.043-1.018-.066a15 15 0 0 0-1.634 0q-.446.023-.937.066v-.513h.168q.535 0 .725-.256.19-.257.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.058 0-.124.007a2 2 0 0 0-.22.022l-.088-.454q.52-.117 1.069-.293.55-.176 1.136-.41m9.924 3.391h-3.574q-.418 0-.769.014t-.652.044v.271q0 1.435.659 2.22.666.783 1.875.783.534 0 1.055-.176.52-.183 1.106-.563l.285.468a6.2 6.2 0 0 1-1.508.93q-.748.315-1.48.315-1.42 0-2.344-1.01-.923-1.018-.923-2.608 0-1.692.967-2.842.967-1.149 2.359-1.149 1.296 0 2.065.864.77.864.879 2.439m-1.355-.769q-.22-.901-.667-1.377-.446-.483-1.069-.484-.703 0-1.208.564-.499.564-.652 1.524 1.45 0 2.278-.052.834-.05 1.318-.175m4.644-2.959v.783q.314.016.666.022h.996q1.092 0 1.743-.095a4 4 0 0 0 1.092-.3q-.045 1.509-.066 2.746-.022 1.239-.022 2.205v.754q0 .806.154 1.019.16.204.622.205.043 0 .117-.008.074-.007.11-.007V109a18 18 0 0 0-.871-.051 15 15 0 0 0-.777-.022q-.234 0-.593.014t-1.04.059v-.513h.176q.908 0 .915-1.787v-.403l.015-1.809v-.6q0-.879-.191-1.077-.19-.198-1.069-.198h-1.977q0 .425-.008 1.245-.007.813-.007 1.194 0 2.015.029 2.549.037.535.117.659a.5.5 0 0 0 .271.198q.183.059.528.059h.19V109a19 19 0 0 0-.871-.051 14 14 0 0 0-.748-.022q-.227 0-.578.014-.344.015-1.157.059v-.498h.19q.505 0 .681-.308t.176-1.34q0-.198-.007-.791-.008-.6-.008-.996 0-.542-.007-1.143 0-.607-.007-1.281h-.484l-.197.014-.337.015v-.498q.307-.007.556-.081.256-.074.462-.219l-.015-.147v-.256q0-1.721.96-2.769.966-1.055 2.504-1.055.96 0 1.685.396.732.395.732.893 0 .28-.205.491a.6.6 0 0 1-.454.213q-.263 0-.608-.381a7 7 0 0 0-.234-.25 2.4 2.4 0 0 0-.667-.46 1.65 1.65 0 0 0-.695-.155q-.938 0-1.355.638-.418.637-.432 2.146m12.883 3.728h-3.574q-.418 0-.769.014t-.652.044v.271q0 1.435.659 2.22.666.783 1.875.783.534 0 1.055-.176.52-.183 1.106-.563l.285.468a6.1 6.1 0 0 1-1.509.93q-.747.315-1.479.315-1.421 0-2.344-1.01-.923-1.018-.923-2.608 0-1.692.967-2.842.967-1.149 2.358-1.149 1.297 0 2.066.864.77.864.879 2.439m-1.355-.769q-.22-.901-.667-1.377-.447-.483-1.069-.484-.704 0-1.208.564-.5.564-.652 1.524 1.45 0 2.277-.052.836-.05 1.319-.175m7.72-1.15a4.6 4.6 0 0 0-.931-.41 3 3 0 0 0-.886-.132q-1.128 0-1.743.703t-.615 1.985q0 1.362.6 2.168.608.798 1.619.798.403 0 .864-.154a6 6 0 0 0 1.048-.476zm1.347-5.34-.007.132a387 387 0 0 0-.139 5.025l-.015 1.142q-.015.403-.029 1.077-.008.666-.008 1.472v.286q0 1.142.081 1.421.081.27.315.271.14 0 .286-.03.153-.028.315-.088l.117.462a6 6 0 0 1-1.004.293 5 5 0 0 1-.988.102l-.213-.007q-.051-.315-.08-.579a6 6 0 0 1-.022-.512q-.836.534-1.377.74a3 3 0 0 1-1.055.205q-1.282 0-2.087-.967-.807-.975-.806-2.527 0-1.728 1.033-2.791t2.68-1.062q.374 0 .784.074.418.066.901.212 0-.066.007-.198.037-1.281.037-2.307 0-.461-.147-.652-.139-.19-.468-.19a1 1 0 0 0-.184.022q-.11.015-.3.051l-.088-.476q.543-.095 1.15-.242.607-.153 1.311-.359"/></g><g filter="url(#filter16_d_249_8276-cover-svg)"><rect width="30" height="30" x="400" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="29" height="29" x="400.5" y="89.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="m413.039 107.938.205.461a6.4 6.4 0 0 1-1.004.608q-.454.22-.732.22-.47 0-.703-.271-.235-.278-.257-.835-.798.535-1.325.769-.528.227-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.161 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.959-.366-.63 0-.997.234-.358.227-.358.623 0 .036.007.102l.007.088q0 .228-.22.381a.9.9 0 0 1-.527.147q-.264 0-.388-.088-.125-.088-.125-.271 0-.586.989-1.304.989-.725 2.044-.725 1.017 0 1.545.564.527.557.527 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.381 1.538 0 .484.308.791.308.301.813.301.308 0 .71-.161.403-.162.938-.513zm5.574-3.947-.022.791a147 147 0 0 0-.095 4.145v.777q0 .849.161 1.069.16.22.63.22.043 0 .117-.008.073-.007.11-.007V109q-.623-.044-1.004-.059a19 19 0 0 0-.644-.014q-.235 0-.601.014-.358.015-1.084.059v-.513h.183q.909 0 .916-1.787v-.403l.029-1.809q0-.198.007-.498.008-.3.008-.403 0-.592-.118-.783-.109-.19-.41-.191-.058 0-.175.015a5 5 0 0 0-.242.022l-.073-.462q.578-.11 1.15-.278.578-.168 1.157-.395m-.791-3.45.52.388q.205.154.3.308.096.154.095.322 0 .168-.08.293-.073.117-.286.278l-.549.418-.513-.403a1.5 1.5 0 0 1-.308-.308.56.56 0 0 1-.022-.586q.073-.124.301-.293zm5.097 3.45q-.051.498-.08 1.01-.03.505-.044 1.077.593-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .659.227.243.22.242.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.014 1.905.023.725.059.922.066.373.278.513.22.14.74.139h.213V109a40 40 0 0 0-1.019-.066 15 15 0 0 0-1.633 0q-.447.023-.937.066v-.513h.168q.535 0 .725-.256.19-.257.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.059 0-.125.007-.066 0-.219.022l-.088-.454a13 13 0 0 0 1.069-.293q.55-.176 1.135-.41"/></g><g filter="url(#filter17_d_249_8276-cover-svg)"><rect width="26" height="30" x="435" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="25" height="29" x="435.5" y="89.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="M445.021 102.372q-.981 0-1.582.717-.594.711-.593 1.919 0 1.547.659 2.505.666.96 1.728.96 1.026 0 1.634-.762.615-.762.615-2.073 0-1.436-.696-2.351-.688-.915-1.765-.915m.19-.769q1.546 0 2.557 1.04 1.017 1.032 1.018 2.563 0 1.684-1.07 2.842-1.069 1.15-2.636 1.15t-2.579-1.055q-1.003-1.055-1.003-2.666t1.091-2.739q1.1-1.135 2.622-1.135m6.812-.249.015.607h.49q.381 0 .747-.007l.711-.029q0 .029-.007.095-.022.47-.022.652l-.088-.007a32 32 0 0 0-1.487-.052h-.315q0 .785-.015 1.707v.329q0 1.678.022 2.388.022.711.081.96.073.292.3.402.235.103.886.103V109a55 55 0 0 0-1.106-.059 19 19 0 0 0-.652-.014q-.234 0-.607.014-.374.015-1.172.059v-.498h.19q.505 0 .681-.308t.176-1.34q0-.198-.007-.791-.008-.6-.008-.996 0-.542-.007-1.143 0-.607-.007-1.281h-.484l-.197.014-.337.015v-.542a2.4 2.4 0 0 0 .564-.088q.249-.074.454-.212v-.132q0-1.86.879-2.945.88-1.09 2.387-1.09.689 0 1.07.226.388.227.388.623a.64.64 0 0 1-.154.44.45.45 0 0 1-.359.175q-.132 0-.688-.286-.55-.293-.901-.293-.77 0-1.099.586-.322.586-.322 2.08z"/></g><g filter="url(#filter18_d_249_8276-cover-svg)"><rect width="25" height="30" x="466" y="89" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="24" height="29" x="466.5" y="89.5" stroke="#000" stroke-opacity=".16" rx="1.5" shape-rendering="crispEdges"/><path fill="#000" d="M474.087 103.003q.499 0 .85.352t.352.85-.359.849a1.15 1.15 0 0 1-.843.352q-.483 0-.842-.359a1.15 1.15 0 0 1-.359-.842q0-.491.352-.843.351-.359.849-.359m4.175 0q.498 0 .85.352.351.352.351.85t-.359.849a1.15 1.15 0 0 1-.842.352q-.483 0-.842-.359a1.15 1.15 0 0 1-.359-.842q0-.491.352-.843.351-.359.849-.359m4.175 0q.498 0 .85.352.351.352.351.85t-.359.849a1.15 1.15 0 0 1-.842.352q-.483 0-.842-.359a1.15 1.15 0 0 1-.359-.842q0-.491.351-.843.352-.359.85-.359"/></g><g filter="url(#filter19_d_249_8276-cover-svg)"><rect width="66" height="30" x="346" y="203" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="65" height="29" x="346.5" y="203.5" stroke="#009de4" stroke-opacity=".4" rx="1.5" shape-rendering="crispEdges"/><path fill="#009de4" d="m358.072 221.557.366.557a6 6 0 0 1-1.399.82 3.5 3.5 0 0 1-1.304.278q-1.436 0-2.343-1.025-.909-1.032-.909-2.637 0-1.662 1.15-2.812t2.805-1.15q.85 0 1.312.242.46.234.461.659a.8.8 0 0 1-.19.534q-.184.22-.425.22-.081 0-.681-.366-.594-.374-1.136-.374-.952 0-1.516.689-.556.681-.556 1.86 0 1.486.673 2.322.681.828 1.883.828.447 0 .886-.154.447-.154.923-.491m7.449-2.651h-3.575q-.417 0-.769.014-.35.015-.652.044v.271q0 1.435.66 2.22.666.783 1.875.783.535 0 1.054-.176a5.3 5.3 0 0 0 1.106-.563l.286.468a6.1 6.1 0 0 1-1.509.93q-.747.315-1.479.315-1.422 0-2.344-1.01-.923-1.018-.923-2.608 0-1.692.967-2.842.966-1.149 2.358-1.149 1.296 0 2.066.864.768.864.879 2.439m-1.355-.769q-.22-.901-.667-1.377-.447-.483-1.069-.484-.704 0-1.209.564-.498.564-.652 1.524 1.45 0 2.278-.052.835-.05 1.319-.175m4.614-2.622q-.051.498-.081 1.01-.029.506-.044 1.077.594-1.047 1.092-1.509.504-.46 1.04-.461.417 0 .659.227.242.22.242.6a.72.72 0 0 1-.162.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.761.337-.38.33-.799 1.033v.805q0 1.172.015 1.905.022.725.058.922.066.373.279.513.22.14.739.139h.213V223q-.571-.043-1.018-.066a15 15 0 0 0-1.633 0q-.447.023-.938.066v-.513h.168q.536 0 .726-.256t.19-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.058 0-.124.007-.066 0-.22.022l-.088-.454a13 13 0 0 0 1.07-.293q.549-.176 1.135-.41m9.924 3.391h-3.574q-.418 0-.769.014t-.652.044v.271q0 1.435.659 2.22.667.783 1.875.783.535 0 1.055-.176.52-.183 1.106-.563l.285.468a6.1 6.1 0 0 1-1.508.93 3.8 3.8 0 0 1-1.48.315q-1.42 0-2.344-1.01-.922-1.018-.922-2.608 0-1.692.966-2.842.967-1.149 2.359-1.149 1.296 0 2.065.864.77.864.879 2.439m-1.355-.769q-.22-.901-.666-1.377-.447-.483-1.07-.484-.702 0-1.208.564-.498.564-.652 1.524 1.45 0 2.278-.052.834-.05 1.318-.175m4.49 3.904q.336.176.674.263.336.081.725.081 1.216 0 1.911-.755.696-.761.696-2.094 0-1.304-.63-2.11-.622-.813-1.618-.813-.418 0-.865.139-.446.14-.996.44l-.014 1.208v1.048q0 1.113.029 1.728t.088.865m-.015-10.394-.007.264q-.11 2.871-.11 4.204v.484q.754-.506 1.326-.725a3 3 0 0 1 1.106-.228q1.208 0 2.08 1.004.871.996.871 2.417 0 1.802-1.15 2.922-1.15 1.113-3.061 1.114-.63 0-1.231-.081a8.4 8.4 0 0 1-1.186-.249q.043-2.454.066-3.889.022-1.443.022-1.868v-.974q0-.38.007-.967.007-.585.007-.791 0-.966-.117-1.274-.11-.315-.417-.315-.074 0-.183.014a3 3 0 0 0-.249.03l-.081-.462q.564-.117 1.143-.271.578-.153 1.164-.359m8.489 3.868q-.051.498-.081 1.01-.029.506-.044 1.077.594-1.047 1.092-1.509.505-.46 1.04-.461.417 0 .659.227.242.22.242.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.367.191q-.132 0-.41-.14-.27-.146-.469-.146-.38 0-.761.337-.38.33-.799 1.033v.805q0 1.172.015 1.905.022.725.059.922.066.373.278.513.22.14.74.139h.212V223q-.571-.043-1.018-.066a15 15 0 0 0-1.633 0q-.447.023-.938.066v-.513h.169q.534 0 .725-.256t.19-1.194v-3.149q0-.792-.11-1.018-.11-.228-.402-.227-.06 0-.125.007-.066 0-.22.022l-.088-.454q.52-.117 1.07-.293.549-.176 1.135-.41m10.151 6.423.205.461a6.3 6.3 0 0 1-1.003.608q-.454.22-.732.22-.469 0-.704-.271-.234-.278-.256-.835-.798.535-1.326.769-.527.228-.944.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.951-2.065a86 86 0 0 0 1.084-.257q0-.124.008-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.96-.366-.63 0-.996.234-.359.227-.359.623 0 .036.008.102l.007.088q0 .228-.22.381a.9.9 0 0 1-.527.147q-.264 0-.388-.088-.125-.088-.125-.271 0-.586.989-1.304.988-.725 2.043-.725 1.018 0 1.546.564.527.557.527 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.38.169a1 1 0 0 0 .301-.066q.19-.074.556-.249m-2.497-2.476-.418.11q-2.38.653-2.38 1.538 0 .484.308.791.308.301.813.301.307 0 .71-.161.403-.162.938-.513zm5.442-7.785a125 125 0 0 0-.052 3.545q-.007.842-.007 1.208l-.015 1.502v3.266q0 .843.184 1.07.19.219.71.219h.168V223a23 23 0 0 0-.952-.051 14 14 0 0 0-1.53 0q-.411.014-.857.051l-.008-.513q.051 0 .125.008.081.007.117.007.513 0 .681-.264.176-.27.176-1.56v-.542l.029-5.508v-1.259q0-.315-.139-.469-.132-.162-.403-.161a3 3 0 0 0-.381.051.3.3 0 0 1-.051.007l-.11-.476a11 11 0 0 0 2.315-.644"/></g><g filter="url(#filter20_d_249_8276-cover-svg)"><rect width="61" height="30" x="96" y="16" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="60" height="29" x="96.5" y="16.5" stroke="#e9411b" stroke-opacity=".3" rx="1.5" shape-rendering="crispEdges"/><path fill="#e9411b" d="M105.706 29.16q-.784 0-1.216.483t-.432 1.362q0 .966.418 1.509.424.534 1.186.534.77 0 1.209-.483.44-.49.439-1.348 0-.989-.417-1.523-.418-.535-1.187-.535m-1.333 6.738a3.6 3.6 0 0 0-.527.732q-.17.33-.169.63 0 .68.608 1.15.615.468 1.538.468 1.048 0 1.809-.586.77-.578.769-1.303 0-.594-.373-.835-.374-.242-1.436-.242-.11 0-.483-.007a33 33 0 0 0-.63-.008zm3.069-6.783a34 34 0 0 0 1.999-.058l-.036.732a10 10 0 0 0-.711-.051 16 16 0 0 0-.886-.022q.345.264.52.644.183.374.183.828 0 .99-.827 1.7-.82.71-2.022.71-.124 0-.351-.015l-.323-.03q-.198.133-.373.279a3 3 0 0 0-.323.293q.11.206.25.38.145.169.336.323.228 0 .652-.007a81 81 0 0 1 1.348-.022q1.326 0 1.904.403.586.402.586 1.296 0 .57-.322 1.15a3.7 3.7 0 0 1-.894 1.07 4.5 4.5 0 0 1-1.369.768 4.5 4.5 0 0 1-1.531.279q-1.136 0-1.904-.6-.762-.601-.762-1.459 0-.498.315-.98.322-.477 1.12-1.129a3.8 3.8 0 0 1-.549-.615 3 3 0 0 1-.344-.688q.264-.25.579-.47.314-.226.695-.446-.74-.234-1.157-.784a2.05 2.05 0 0 1-.417-1.274q0-1.135.835-1.92.842-.783 2.102-.783.46 0 .864.125.402.117.813.373m9.119 2.79h-3.575q-.417 0-.769.015-.35.015-.652.044v.271q0 1.436.66 2.22.666.783 1.875.783.534 0 1.054-.175a5.3 5.3 0 0 0 1.106-.565l.286.47a6.2 6.2 0 0 1-1.509.93q-.747.315-1.479.314-1.422 0-2.344-1.01-.923-1.019-.923-2.608 0-1.692.967-2.842.966-1.15 2.358-1.15 1.296 0 2.066.865.768.864.879 2.439m-1.355-.768q-.22-.9-.667-1.377-.447-.484-1.069-.484-.703 0-1.209.564-.498.564-.652 1.524 1.45 0 2.278-.052.835-.05 1.319-.175m4.628-2.622-.087 1.23q.827-.6 1.435-.872.615-.27 1.128-.27 1.077 0 1.619.607.542.609.542 1.824l-.008.645q-.007.637-.007 1.274 0 .27-.007.681-.008.403-.008.55 0 .82.147 1.069t.557.249l.08-.007a1 1 0 0 1 .095-.008V36q-.658-.044-.996-.059-.336-.014-.564-.014-.351 0-.761.022-.41.015-.835.051l-.008-.513h.11q.937 0 .952-1.714.008-.095.008-.146l.014-1.575v-.263q0-1.356-.315-1.795-.315-.447-1.084-.447-.425 0-.945.205a5.5 5.5 0 0 0-1.091.594q-.029.761-.044 1.443-.014.673-.014 1.223v1.01q0 .968.139 1.224.145.256.564.256l.088-.007a1 1 0 0 1 .102-.008V36q-.63-.044-.996-.059a15 15 0 0 0-.593-.014q-.22 0-.579.014t-1.003.059l-.008-.513h.14q.916 0 .922-1.78 0-.263.008-.41l.014-1.794v-.725q0-.718-.109-.938-.11-.227-.403-.227-.059 0-.154.015a2 2 0 0 0-.191.044l-.087-.454a9 9 0 0 0 1.098-.279q.557-.175 1.135-.424m12.811 3.39h-3.575q-.417 0-.769.015-.35.015-.652.044v.271q0 1.436.66 2.22.666.783 1.875.783.535 0 1.054-.175a5.3 5.3 0 0 0 1.106-.565l.286.47a6.2 6.2 0 0 1-1.509.93q-.747.315-1.479.314-1.422 0-2.344-1.01-.923-1.019-.923-2.608 0-1.692.967-2.842.966-1.15 2.358-1.15 1.296 0 2.066.865.768.864.879 2.439m-1.355-.768q-.22-.9-.667-1.377-.447-.484-1.069-.484-.704 0-1.209.564-.498.564-.652 1.524 1.45 0 2.278-.052.835-.05 1.319-.175m7.28-2.234q0 .447.044.9.05.455.139.916l-.557.088q-.087-.762-.483-1.135-.395-.374-1.106-.374-.615 0-1.011.337-.395.33-.395.842 0 .814 1.728 1.29l.462.124q.864.241 1.259.689.403.446.403 1.172 0 1.068-.842 1.765-.835.695-2.146.695a5 5 0 0 1-.974-.102 6 6 0 0 1-1.018-.308q.007-.073.007-.154.007-.08.007-.249 0-.336-.044-.725a9 9 0 0 0-.117-.835l.55-.131q.117.908.571 1.362.454.447 1.26.447.732 0 1.193-.352.47-.36.469-.923 0-.79-1.552-1.26l-.228-.073q-1.113-.336-1.567-.828-.447-.49-.447-1.303 0-.938.747-1.553.747-.623 1.912-.623.359 0 .776.074.425.073.96.227m4.131-.388-.022.79a148 148 0 0 0-.096 4.146v.776q0 .85.162 1.07.16.22.63.22.044 0 .117-.008.073-.007.11-.007V36q-.623-.044-1.004-.059a17 17 0 0 0-.644-.014q-.235 0-.601.014-.359.015-1.084.059v-.513h.183q.909 0 .916-1.787v-.403l.029-1.809q0-.198.007-.498.008-.3.008-.403 0-.592-.118-.783-.11-.19-.41-.19-.058 0-.176.014a6 6 0 0 0-.241.022l-.073-.461q.578-.11 1.149-.279.579-.168 1.158-.395m-.791-3.45.52.388q.205.154.3.308t.095.322-.08.293q-.073.116-.286.278l-.549.418-.513-.403a1.5 1.5 0 0 1-.308-.308.56.56 0 0 1-.022-.586q.073-.124.301-.293zm7.763 3.838q0 .447.044.9.052.455.139.916l-.556.088q-.088-.762-.484-1.135-.395-.374-1.106-.374-.615 0-1.01.337-.396.33-.396.842 0 .814 1.729 1.29l.461.124q.864.241 1.26.689.403.446.403 1.172 0 1.068-.843 1.765-.835.695-2.146.695a5 5 0 0 1-.974-.102 6 6 0 0 1-1.018-.308q.008-.073.008-.154.006-.08.007-.249 0-.336-.044-.725a10 10 0 0 0-.117-.835l.549-.131q.118.908.571 1.362.455.447 1.26.447.732 0 1.194-.352.47-.36.469-.923 0-.79-1.553-1.26l-.227-.073q-1.113-.336-1.567-.828-.447-.49-.447-1.303 0-.938.747-1.553.747-.623 1.912-.623.359 0 .776.074.425.073.959.227"/></g><path fill="#fff" d="M135 11h25v13h-25z"/><path fill="#e9411b" d="M138.342 15.522c0-1.435 1.079-2.428 2.621-2.428 1.531 0 2.567.897 2.567 2.218 0 .827-.413 1.52-1.692 2.815l-1.638 1.67v.097h3.454V21h-5.242v-.897l2.562-2.67c1.026-1.079 1.289-1.487 1.289-2.046 0-.741-.532-1.224-1.338-1.224-.821 0-1.364.542-1.364 1.353v.038h-1.219zm9.474 5.644c-1.74 0-2.927-.913-2.927-2.25 0-.956.639-1.73 1.638-1.966v-.091c-.811-.204-1.326-.865-1.326-1.692 0-1.22 1.085-2.084 2.615-2.084s2.616.865 2.616 2.084c0 .827-.51 1.482-1.332 1.692v.091c.988.215 1.644 1.005 1.644 1.966 0 1.337-1.187 2.25-2.928 2.25m0-4.7c.801 0 1.338-.477 1.338-1.186 0-.704-.537-1.182-1.338-1.182-.805 0-1.337.478-1.337 1.182 0 .709.532 1.187 1.337 1.187m0 3.675c.946 0 1.596-.548 1.596-1.338 0-.795-.65-1.337-1.596-1.337-.945 0-1.595.542-1.595 1.337 0 .79.65 1.338 1.595 1.338M152.774 17c-.94 0-1.525-.677-1.525-1.768v-.397c0-1.047.596-1.724 1.525-1.724s1.525.677 1.525 1.724v.397c0 1.09-.58 1.768-1.525 1.768M158 13.25v.844L151.2 21v-.843zm-5.226 2.928c.446 0 .693-.339.693-.972v-.312c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.312c0 .633.247.972.693.972m3.652 4.968c-.945 0-1.525-.671-1.525-1.762v-.397c0-1.047.596-1.73 1.525-1.73s1.526.683 1.526 1.73v.397c0 1.09-.586 1.762-1.526 1.762m0-.816c.446 0 .693-.344.693-.973v-.311c0-.629-.247-.972-.693-.972s-.693.343-.693.972v.311c0 .629.247.973.693.973"/><path fill="#fff" d="M173 85h25v13h-25z"/><path fill="#f78427" d="M179.017 95.167c-1.741 0-2.928-.914-2.928-2.251 0-.956.64-1.73 1.639-1.966v-.091c-.811-.204-1.327-.865-1.327-1.692 0-1.22 1.085-2.084 2.616-2.084 1.53 0 2.615.865 2.615 2.084 0 .827-.51 1.482-1.332 1.692v.091c.989.215 1.644 1.005 1.644 1.966 0 1.337-1.187 2.25-2.927 2.25m0-4.7c.8 0 1.337-.478 1.337-1.187 0-.704-.537-1.182-1.337-1.182-.806 0-1.338.478-1.338 1.182 0 .709.532 1.187 1.338 1.187m0 3.674c.945 0 1.595-.548 1.595-1.338 0-.795-.65-1.337-1.595-1.337-.946 0-1.596.542-1.596 1.337 0 .79.65 1.338 1.596 1.338m6.73 1.015c-1.547 0-2.638-.93-2.697-2.3h1.257c.086.7.688 1.177 1.483 1.177.897 0 1.498-.623 1.498-1.552 0-.935-.607-1.563-1.498-1.563-.613 0-1.096.263-1.386.768h-1.246l.376-4.437h4.538v1.107h-3.507l-.188 2.256h.091c.349-.473.924-.73 1.633-.73 1.434 0 2.428 1.052 2.428 2.567 0 1.622-1.117 2.707-2.782 2.707m5.027-4.157c-.94 0-1.525-.677-1.525-1.768v-.397c0-1.047.596-1.724 1.525-1.724s1.525.677 1.525 1.724v.397c0 1.09-.58 1.768-1.525 1.768m5.226-3.75v.844L189.2 95v-.843zm-5.226 2.928c.446 0 .693-.339.693-.972v-.312c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.312c0 .633.247.972.693.972m3.652 4.968c-.945 0-1.525-.671-1.525-1.762v-.397c0-1.047.596-1.73 1.525-1.73s1.526.683 1.526 1.73v.397c0 1.09-.586 1.762-1.526 1.762m0-.816c.446 0 .693-.344.693-.973v-.311c0-.629-.247-.972-.693-.972s-.693.344-.693.972v.311c0 .629.247.973.693.973"/><g filter="url(#filter21_d_249_8276-cover-svg)"><path fill="#fff" d="M153 203h86v30h-86z"/><rect width="80" height="29" x="153.5" y="203.5" stroke="#f78427" stroke-opacity=".4" rx="1.5"/><path fill="#f78427" d="M161.761 211.677q-.043 1.362-.051 3.545-.007.842-.007 1.208l-.015 1.502v3.266q0 .843.183 1.07.19.219.711.219h.168V223a24 24 0 0 0-.952-.051 14 14 0 0 0-1.531 0q-.41.014-.857.051l-.007-.513q.051 0 .124.008.08.007.118.007.512 0 .681-.264.175-.27.175-1.56v-.542l.03-5.508v-1.259q0-.315-.139-.469-.132-.162-.403-.161-.103 0-.381.051a.3.3 0 0 1-.051.007l-.11-.476a11 11 0 0 0 2.314-.644m8.657 10.261.206.461a6.4 6.4 0 0 1-1.004.608q-.454.22-.732.22-.47 0-.703-.271-.235-.278-.257-.835-.798.535-1.325.769-.528.228-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.695-.162 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.96-.366-.63 0-.996.234-.359.227-.359.623 0 .036.008.102l.007.088q0 .228-.22.381a.9.9 0 0 1-.527.147q-.264 0-.388-.088-.125-.088-.125-.271 0-.586.989-1.304.988-.725 2.044-.725 1.017 0 1.545.564.527.557.527 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.556-.249m-2.497-2.476-.418.11q-2.38.653-2.38 1.538 0 .484.308.791.308.301.813.301.308 0 .71-.161.403-.162.938-.513zm5.303 2.579q.337.176.673.263.338.081.726.081 1.215 0 1.911-.755.696-.761.696-2.094 0-1.304-.63-2.11-.622-.813-1.619-.813-.417 0-.864.139-.447.14-.996.44l-.015 1.208v1.048q0 1.113.03 1.728t.088.865m-.015-10.394-.007.264q-.11 2.871-.11 4.204v.484q.755-.506 1.325-.725.572-.228 1.106-.228 1.209 0 2.081 1.004.871.996.871 2.417 0 1.802-1.15 2.922-1.15 1.113-3.061 1.114-.63 0-1.231-.081a8 8 0 0 1-1.186-.249q.043-2.454.066-3.889.022-1.443.022-1.868v-.974q0-.38.007-.967.007-.585.007-.791 0-.966-.117-1.274-.11-.315-.417-.315-.073 0-.184.014a3 3 0 0 0-.249.03l-.08-.462q.564-.117 1.142-.271.579-.153 1.165-.359m9.763 4.725q-.98 0-1.582.717-.593.711-.593 1.919 0 1.547.659 2.505.666.96 1.729.96 1.025 0 1.633-.762.615-.762.615-2.073 0-1.436-.696-2.351-.688-.915-1.765-.915m.191-.769q1.545 0 2.556 1.04 1.018 1.032 1.018 2.563 0 1.684-1.07 2.842-1.068 1.15-2.636 1.15t-2.578-1.055q-1.004-1.055-1.004-2.666t1.092-2.739q1.098-1.135 2.622-1.135m6.796-.088q-.051.498-.08 1.01-.03.506-.044 1.077.593-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .659.227.243.22.242.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.015 1.905.021.725.058.922.066.373.278.513.22.14.74.139h.213V223a41 41 0 0 0-1.018-.066 15 15 0 0 0-1.634 0q-.447.023-.937.066v-.513h.168q.535 0 .725-.256t.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.059 0-.125.007-.065 0-.219.022l-.088-.454q.52-.117 1.069-.293.55-.176 1.135-.41m10.152 6.423.205.461a6.3 6.3 0 0 1-1.004.608q-.453.22-.732.22-.469 0-.703-.271-.234-.278-.256-.835-.8.535-1.326.769-.528.228-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.162 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.959-.366-.63 0-.996.234-.36.227-.359.623 0 .036.007.102l.007.088q0 .228-.219.381a.93.93 0 0 1-.528.147q-.263 0-.388-.088-.124-.088-.124-.271 0-.586.988-1.304.99-.725 2.044-.725 1.019 0 1.545.564.528.557.528 1.64 0 .587-.074 1.802a37 37 0 0 0-.065 1.846q0 .476.102.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.381 1.538 0 .484.308.791.308.301.813.301.308 0 .71-.161a5.5 5.5 0 0 0 .938-.513zm4.988-5.039.483.147q-.043.402-.073.725-.021.315-.029.622h.52q.417 0 .85-.007.432-.015.871-.036l-.176.798a14 14 0 0 0-.886-.044q-.41-.015-.82-.015h-.344q-.045 1.26-.066 1.934-.015.666-.015 1.106 0 1.655.227 2.16.226.5.813.499.241 0 .535-.103.3-.103.725-.337l.242.483a8 8 0 0 1-1.275.645q-.572.212-.996.212-.783 0-1.143-.534-.358-.543-.358-1.736 0-.234.029-1.67.036-1.443.036-2.644-.065 0-.19.007-.608.022-.835.022v-.527q.718-.102 1.187-.527.469-.433.688-1.18m7.119 1.949q-.98 0-1.582.717-.593.711-.593 1.919 0 1.547.659 2.505.666.96 1.729.96 1.025 0 1.633-.762.615-.762.615-2.073 0-1.436-.696-2.351-.688-.915-1.765-.915m.191-.769q1.545 0 2.556 1.04 1.018 1.032 1.018 2.563 0 1.684-1.069 2.842-1.07 1.15-2.637 1.15t-2.578-1.055q-1.004-1.055-1.004-2.666t1.092-2.739q1.098-1.135 2.622-1.135m6.797-.088q-.052.498-.081 1.01-.03.506-.044 1.077.593-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .66.227.241.22.241.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.015 1.905.022.725.058.922.066.373.278.513.22.14.74.139h.213V223a41 41 0 0 0-1.018-.066 15 15 0 0 0-1.634 0q-.447.023-.937.066v-.513h.168q.535 0 .725-.256t.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.059 0-.124.007a2 2 0 0 0-.22.022l-.088-.454q.52-.117 1.069-.293a17 17 0 0 0 1.136-.41m3.391.307q.549.037.879.052t.564.014q.22 0 .556-.014.345-.015.952-.059v.513h-.19q-.366 0-.513.102-.146.096-.146.344 0 .19.644 1.934.615 1.656 1.018 2.791a135 135 0 0 0 1.429-3.487q.417-1.07.417-1.282t-.161-.307-.527-.095h-.11v-.513q.329.029.644.044.322.015.615.015.243 0 .557-.015t.674-.044v.513h-.059a.73.73 0 0 0-.41.11.8.8 0 0 0-.278.336q-.014.037-.125.286a282 282 0 0 1-1.662 3.765q-.44.995-1.121 2.6-1.464 3.471-2.256 3.471a.68.68 0 0 1-.49-.19.64.64 0 0 1-.198-.483q0-.403.564-.506.227-.036.322-.08.41-.162 1.179-1.861.213-.476.337-.747a164 164 0 0 1-1.245-3.347q-1.223-3.369-1.743-3.369a.3.3 0 0 0-.073.007h-.044z"/></g><path fill="#fff" d="M219 198h18v13h-18z"/><path fill="#f78427" d="M222.142 202.521c0-1.434 1.079-2.427 2.621-2.427 1.53 0 2.567.897 2.567 2.218 0 .827-.413 1.52-1.692 2.814L224 206.797v.097h3.454V208h-5.243v-.897l2.562-2.669c1.026-1.08 1.289-1.488 1.289-2.047 0-.741-.531-1.224-1.337-1.224-.822 0-1.364.542-1.364 1.353v.038h-1.219zm7.632 1.478c-.94 0-1.525-.677-1.525-1.768v-.397c0-1.047.596-1.724 1.525-1.724s1.525.677 1.525 1.724v.397c0 1.091-.58 1.768-1.525 1.768M235 200.25v.843L228.2 208v-.843zm-5.226 2.927c.446 0 .693-.339.693-.972v-.312c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.312c0 .633.247.972.693.972m3.652 4.968c-.945 0-1.525-.671-1.525-1.762v-.397c0-1.048.596-1.73 1.525-1.73s1.526.682 1.526 1.73v.397c0 1.091-.586 1.762-1.526 1.762m0-.816c.446 0 .693-.344.693-.973v-.311c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.311c0 .629.247.973.693.973"/><path fill="#fff" d="M373 84h25v13h-25z"/><path fill="#009de4" d="m377.002 94 3.416-6.574v-.08h-4.065v-1.102h5.381v1.117L378.372 94zm8.804.166c-1.794 0-2.799-1.45-2.799-4.044 0-2.589 1.005-4.039 2.799-4.039 1.788 0 2.793 1.45 2.793 4.04 0 2.593-1.005 4.043-2.793 4.043m-1.526-4.044q.002.243.011.462l2.857-2.095c-.231-.87-.687-1.321-1.342-1.321-.994 0-1.526 1.031-1.526 2.954m1.526 2.96c.988 0 1.52-1.032 1.52-2.96 0-.156-.006-.311-.011-.457l-2.852 2.1c.231.865.682 1.317 1.343 1.317m4.968-3.083c-.94 0-1.525-.677-1.525-1.768v-.397c0-1.047.596-1.724 1.525-1.724s1.525.677 1.525 1.724v.397c0 1.09-.58 1.768-1.525 1.768m5.226-3.75v.844L389.2 94v-.843zm-5.226 2.928c.446 0 .693-.339.693-.972v-.312c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.312c0 .633.247.972.693.972m3.652 4.968c-.945 0-1.525-.671-1.525-1.762v-.397c0-1.047.596-1.73 1.525-1.73s1.526.683 1.526 1.73v.397c0 1.09-.586 1.762-1.526 1.762m0-.816c.446 0 .693-.344.693-.973v-.311c0-.629-.247-.972-.693-.972s-.693.344-.693.972v.311c0 .629.247.973.693.973"/><g filter="url(#filter22_d_249_8276-cover-svg)"><rect width="65" height="30" x="346" y="165" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="64" height="29" x="346.5" y="165.5" stroke="#009de4" stroke-opacity=".4" rx="1.5" shape-rendering="crispEdges"/><path fill="#009de4" d="m359.039 183.938.205.461a6.4 6.4 0 0 1-1.004.608q-.454.22-.732.22-.47 0-.703-.271-.235-.278-.257-.835-.798.535-1.325.769-.528.228-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.162 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.959-.366-.63 0-.997.234-.358.227-.358.623 0 .036.007.102l.007.088q0 .228-.22.381a.9.9 0 0 1-.527.147q-.264 0-.388-.088-.125-.088-.125-.271 0-.586.989-1.304.989-.725 2.044-.725 1.017 0 1.545.564.527.557.527 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.381 1.538 0 .484.308.791.308.301.813.301.308 0 .71-.161.403-.162.938-.513zm5.303 2.579q.336.176.674.263.336.081.725.081 1.215 0 1.911-.755.696-.761.696-2.094 0-1.304-.63-2.11-.622-.813-1.618-.813-.418 0-.865.139-.447.14-.996.44l-.014 1.208v1.048q0 1.113.029 1.728t.088.865m-.015-10.394-.007.264q-.11 2.871-.11 4.204v.484q.755-.506 1.326-.725a3 3 0 0 1 1.106-.228q1.208 0 2.08 1.004.871.996.871 2.417 0 1.802-1.15 2.922-1.15 1.113-3.061 1.114-.63 0-1.231-.081a8 8 0 0 1-1.186-.249q.043-2.454.066-3.889.021-1.443.022-1.868v-.974q0-.38.007-.967.007-.585.007-.791 0-.966-.117-1.274-.11-.315-.417-.315-.074 0-.183.014a3 3 0 0 0-.249.03l-.081-.462q.564-.117 1.143-.271.578-.153 1.164-.359m11.155 4.256q0 .447.044.901.05.454.139.915l-.557.088q-.087-.762-.483-1.135-.395-.374-1.106-.374-.615 0-1.011.337a1.05 1.05 0 0 0-.395.843q0 .813 1.728 1.289l.462.124q.864.242 1.259.689.403.446.403 1.171 0 1.07-.842 1.766-.835.695-2.146.695a5 5 0 0 1-.974-.102 6 6 0 0 1-1.018-.308q.007-.073.007-.154.007-.08.007-.249 0-.336-.043-.725a10 10 0 0 0-.118-.835l.55-.131q.117.907.571 1.362.454.447 1.26.447.732 0 1.194-.352.468-.359.468-.923 0-.79-1.552-1.26l-.227-.073q-1.114-.336-1.568-.827-.447-.492-.447-1.304 0-.938.747-1.553.748-.622 1.912-.622.359 0 .776.073.425.073.96.227m3.545-1.48.483.147q-.044.402-.073.725-.022.315-.029.622h.52q.417 0 .849-.007.432-.015.872-.036l-.176.798a14 14 0 0 0-.886-.044q-.41-.015-.82-.015h-.345l-.066 1.934q-.014.666-.014 1.106 0 1.655.227 2.16.227.5.813.499.241 0 .534-.103.3-.103.726-.337l.241.483a8 8 0 0 1-1.274.645q-.572.212-.996.212-.785 0-1.143-.534-.359-.543-.359-1.736 0-.234.03-1.67.036-1.443.036-2.644-.066 0-.19.007-.609.022-.835.022v-.527q.718-.102 1.186-.527.469-.433.689-1.18m5.845 1.092q-.053.498-.081 1.01-.03.506-.044 1.077.594-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .66.227.241.22.241.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.015 1.905.022.725.058.922.066.373.279.513.22.14.739.139h.213V185a41 41 0 0 0-1.018-.066 15 15 0 0 0-1.634 0q-.447.023-.937.066v-.513h.168q.535 0 .725-.256t.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.058 0-.124.007a2 2 0 0 0-.22.022l-.088-.454q.52-.117 1.069-.293a17 17 0 0 0 1.136-.41m10.151 6.423.205.461a6.4 6.4 0 0 1-1.003.608q-.454.22-.733.22-.469 0-.703-.271-.235-.278-.256-.835-.799.535-1.326.769-.528.228-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.162 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.314-.366-.959-.366-.63 0-.996.234-.36.227-.359.623 0 .036.007.102l.008.088q0 .228-.22.381a.93.93 0 0 1-.528.147q-.263 0-.388-.088-.124-.088-.124-.271 0-.586.989-1.304.988-.725 2.043-.725 1.019 0 1.545.564.528.557.528 1.64 0 .587-.074 1.802a38 38 0 0 0-.065 1.846q0 .476.102.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.381 1.538 0 .484.308.791.308.301.813.301.308 0 .711-.161.402-.162.937-.513zm8.753 2.095.366.557a6 6 0 0 1-1.399.82 3.5 3.5 0 0 1-1.304.278q-1.435 0-2.343-1.025-.909-1.032-.909-2.637 0-1.662 1.15-2.812t2.805-1.15q.85 0 1.312.242.46.234.461.659a.8.8 0 0 1-.19.534q-.184.22-.425.22-.081 0-.681-.366-.594-.374-1.136-.374-.952 0-1.516.689-.556.681-.556 1.86 0 1.486.673 2.322.681.828 1.883.828.447 0 .886-.154.447-.154.923-.491m2.944-7.134.484.147q-.044.402-.074.725-.021.315-.029.622h.52q.418 0 .85-.007.432-.015.871-.036l-.176.798a14 14 0 0 0-.886-.044q-.41-.015-.82-.015h-.344q-.045 1.26-.066 1.934-.015.666-.015 1.106 0 1.655.227 2.16.227.5.813.499.241 0 .535-.103.3-.103.725-.337l.242.483a8 8 0 0 1-1.275.645q-.571.212-.996.212-.783 0-1.143-.534-.358-.543-.358-1.736 0-.234.029-1.67.036-1.443.037-2.644-.066 0-.191.007-.608.022-.835.022v-.527q.718-.102 1.187-.527.469-.433.688-1.18"/></g><path fill="#fff" d="M389 159h25v13h-25z"/><path fill="#009de4" d="M397.976 169h-5.5v-1.09h2.165v-5.328h-.092l-2.084 1.369v-1.262l2.181-1.439h1.268v6.66h2.062zm1.166-5.479c0-1.434 1.079-2.427 2.621-2.427 1.53 0 2.567.897 2.567 2.218 0 .827-.413 1.52-1.692 2.814L401 167.797v.097h3.454V169h-5.243v-.897l2.562-2.669c1.026-1.08 1.289-1.488 1.289-2.047 0-.741-.531-1.224-1.337-1.224-.822 0-1.364.542-1.364 1.353v.038h-1.219zm7.632 1.478c-.94 0-1.525-.677-1.525-1.768v-.397c0-1.047.596-1.724 1.525-1.724s1.525.677 1.525 1.724v.397c0 1.091-.58 1.768-1.525 1.768M412 161.25v.843L405.2 169v-.843zm-5.226 2.927c.446 0 .693-.339.693-.972v-.312c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.312c0 .633.247.972.693.972m3.652 4.968c-.945 0-1.525-.671-1.525-1.762v-.397c0-1.048.596-1.73 1.525-1.73s1.526.682 1.526 1.73v.397c0 1.091-.586 1.762-1.526 1.762m0-.816c.446 0 .693-.344.693-.973v-.311c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.311c0 .629.247.973.693.973"/><g filter="url(#filter23_d_249_8276-cover-svg)"><rect width="47" height="30" x="346" y="127" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="46" height="29" x="346.5" y="127.5" stroke="#009de4" stroke-opacity=".4" rx="1.5" shape-rendering="crispEdges"/><path fill="#009de4" d="M354.71 139.515q-.03.3-.051.586a10 10 0 0 0-.03.564q.996-.63 1.553-.843a2.9 2.9 0 0 1 1.069-.219q.623 0 1.055.285.44.286.747.901.982-.653 1.604-.915.623-.271 1.121-.271 1.069 0 1.553.651.49.652.49 2.11v.154l-.029 2.409q0 .367-.015.667v.029q0 .528.161.696.162.168.645.168h.168V147a64 64 0 0 0-1.062-.059 16 16 0 0 0-.571-.014q-.234 0-.586.014-.344.015-.989.059v-.513l.11.015h.183q.469 0 .623-.3.16-.308.161-1.48v-1.069q0-.264.007-.696.008-.432.008-.608 0-.937-.344-1.377-.337-.44-1.048-.439-.344 0-.82.183a9 9 0 0 0-1.179.586l-.059 3.611v.6q0 .66.161.82.169.154.681.154h.088v.506a59 59 0 0 0-.967-.044 12 12 0 0 0-.666-.022q-.279 0-.652.022-.373.014-.784.051l-.007-.513q.513 0 .667-.08.153-.088.219-.396.051-.242.074-1.223.029-.981.029-2.512 0-.915-.33-1.326-.322-.417-1.032-.417-.345 0-.828.183a8 8 0 0 0-1.15.556q-.043 1.194-.066 2.073-.015.879-.015 1.597 0 1.12.147 1.34.154.22.637.22.037 0 .11-.007.081-.008.132-.008l-.008.513a19 19 0 0 0-.878-.051q-.426-.022-.799-.022-.322 0-.718.022-.395.014-.834.051l-.008-.513h.139q.916 0 .923-1.779 0-.264.008-.411l.014-1.794v-.725q0-.718-.11-.938-.11-.227-.403-.227-.059 0-.153.015-.088.014-.191.044l-.088-.454q.542-.147 1.092-.322.55-.177 1.091-.381m13.381 0-.022.791a151 151 0 0 0-.095 4.145v.777q0 .849.161 1.069.162.22.63.22.043 0 .117-.008.074-.007.11-.007V147a35 35 0 0 0-1.003-.059 19 19 0 0 0-.645-.014q-.234 0-.6.014-.36.015-1.084.059v-.513h.183q.907 0 .915-1.787v-.403l.03-1.809q0-.198.007-.498t.007-.403q0-.593-.117-.783-.11-.19-.41-.191a2 2 0 0 0-.176.015 5 5 0 0 0-.242.022l-.073-.462q.579-.11 1.15-.278.58-.168 1.157-.395m-.791-3.45.52.388q.205.154.301.308.095.154.095.322t-.081.293a1.2 1.2 0 0 1-.285.278l-.55.418-.512-.403a1.5 1.5 0 0 1-.308-.308.56.56 0 0 1-.022-.586q.073-.124.3-.293zm5.113 3.45-.088 1.23q.827-.6 1.435-.871.615-.271 1.128-.271 1.077 0 1.619.607.542.609.542 1.824l-.007.645q-.008.637-.008 1.274 0 .272-.007.681-.007.403-.007.55 0 .82.146 1.069.147.249.557.249l.08-.007a1 1 0 0 1 .095-.008V147a51 51 0 0 0-.996-.059 15 15 0 0 0-.564-.014q-.351 0-.761.022-.41.014-.835.051l-.008-.513h.11q.938 0 .952-1.714.008-.095.008-.146l.014-1.575v-.263q0-1.356-.315-1.795-.315-.447-1.084-.447-.425 0-.944.205-.513.198-1.092.594a94 94 0 0 0-.044 1.443q-.014.674-.014 1.223v1.01q0 .968.139 1.224.147.256.564.256l.088-.007a1 1 0 0 1 .102-.008V147q-.63-.044-.996-.059a17 17 0 0 0-.593-.014q-.22 0-.579.014-.358.015-1.003.059l-.007-.513h.139q.915 0 .923-1.779 0-.264.007-.411l.015-1.794v-.725q0-.718-.11-.938-.11-.227-.403-.227-.058 0-.154.015-.088.014-.19.044l-.088-.454a9 9 0 0 0 1.098-.279q.557-.175 1.136-.424m11.85 1.472a4.5 4.5 0 0 0-.93-.41 3 3 0 0 0-.886-.132q-1.128 0-1.743.703t-.616 1.985q0 1.362.601 2.168.608.798 1.619.798.402 0 .864-.154a6 6 0 0 0 1.047-.476zm1.348-5.34-.007.132a407 407 0 0 0-.14 5.025l-.014 1.142q-.015.403-.03 1.077-.007.666-.007 1.472v.286q0 1.142.081 1.421.08.27.315.271.139 0 .285-.03.154-.028.315-.088l.117.462a6 6 0 0 1-1.003.293 5 5 0 0 1-.989.102l-.212-.007q-.051-.315-.081-.579a7 7 0 0 1-.022-.512q-.834.534-1.377.74a3 3 0 0 1-1.054.205q-1.283 0-2.088-.967-.805-.975-.805-2.527 0-1.728 1.032-2.791t2.681-1.062q.373 0 .784.074.417.066.9.212 0-.066.008-.198.036-1.281.036-2.307 0-.461-.146-.652-.14-.19-.469-.19a1 1 0 0 0-.183.022q-.11.015-.3.051l-.088-.476q.542-.095 1.15-.242.608-.153 1.311-.359"/></g><path fill="#fff" d="M371 121h25v13h-25z"/><path fill="#009de4" d="M379.976 131h-5.5v-1.09h2.165v-5.328h-.092l-2.084 1.369v-1.262l2.181-1.439h1.268v6.66h2.062zm1.826 0 3.416-6.574v-.081h-4.066v-1.101h5.382v1.117L383.172 131zm6.972-4.001c-.94 0-1.525-.677-1.525-1.768v-.397c0-1.047.596-1.724 1.525-1.724s1.525.677 1.525 1.724v.397c0 1.091-.58 1.768-1.525 1.768M394 123.25v.843L387.2 131v-.843zm-5.226 2.927c.446 0 .693-.339.693-.972v-.312c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.312c0 .633.247.972.693.972m3.652 4.968c-.945 0-1.525-.671-1.525-1.762v-.397c0-1.048.596-1.73 1.525-1.73s1.526.682 1.526 1.73v.397c0 1.091-.586 1.762-1.526 1.762m0-.816c.446 0 .693-.344.693-.973v-.311c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.311c0 .629.247.973.693.973"/><path fill="#fff" d="M383 197h32v13h-32z"/><path fill="#009de4" d="M389.206 207.167c-1.794 0-2.798-1.451-2.798-4.045 0-2.589 1.004-4.039 2.798-4.039 1.789 0 2.793 1.45 2.793 4.039 0 2.594-1.004 4.045-2.793 4.045m-1.525-4.045q.001.243.01.462l2.858-2.095c-.231-.87-.688-1.321-1.343-1.321-.994 0-1.525 1.031-1.525 2.954m1.525 2.96c.988 0 1.52-1.032 1.52-2.96 0-.156-.005-.311-.011-.456l-2.852 2.1c.231.864.682 1.316 1.343 1.316m6.794.993c-.601 0-1.095-.51-1.095-1.122s.494-1.118 1.095-1.118c.602 0 1.096.505 1.096 1.118 0 .612-.494 1.122-1.096 1.122m4.142-5.554c0-1.434 1.079-2.427 2.621-2.427 1.53 0 2.567.897 2.567 2.218 0 .827-.413 1.52-1.692 2.814L402 205.797v.097h3.454V207h-5.243v-.897l2.562-2.669c1.026-1.08 1.289-1.488 1.289-2.047 0-.741-.531-1.224-1.337-1.224-.822 0-1.364.542-1.364 1.353v.038h-1.219zm7.632 1.478c-.94 0-1.525-.677-1.525-1.768v-.397c0-1.047.596-1.724 1.525-1.724s1.525.677 1.525 1.724v.397c0 1.091-.58 1.768-1.525 1.768M413 199.25v.843L406.2 207v-.843zm-5.226 2.927c.446 0 .693-.339.693-.972v-.312c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.312c0 .633.247.972.693.972m3.652 4.968c-.945 0-1.525-.671-1.525-1.762v-.397c0-1.048.596-1.73 1.525-1.73s1.526.682 1.526 1.73v.397c0 1.091-.586 1.762-1.526 1.762m0-.816c.446 0 .693-.344.693-.973v-.311c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.311c0 .629.247.973.693.973"/><g filter="url(#filter24_d_249_8276-cover-svg)"><rect width="86" height="30" x="153" y="127" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="85" height="29" x="153.5" y="127.5" stroke="#f78427" stroke-opacity=".4" rx="1.5" shape-rendering="crispEdges"/><path fill="#f78427" d="M161.622 146.041q.337.176.674.263.337.081.725.081 1.216 0 1.912-.755.695-.761.695-2.094 0-1.304-.629-2.11-.624-.813-1.619-.813-.418 0-.864.139-.447.14-.996.44l-.015 1.208v1.048q0 1.113.029 1.728t.088.865m-.015-10.394-.007.264q-.11 2.871-.11 4.204v.484q.755-.506 1.326-.725a3 3 0 0 1 1.106-.228q1.209 0 2.08 1.004.872.996.872 2.417 0 1.802-1.15 2.922-1.15 1.113-3.062 1.114-.63 0-1.23-.081a8 8 0 0 1-1.187-.249q.043-2.454.066-3.889.022-1.443.022-1.868v-.974q0-.38.007-.967.008-.585.008-.791 0-.966-.118-1.274-.11-.315-.417-.315-.074 0-.183.014a3 3 0 0 0-.249.03l-.081-.462q.564-.117 1.143-.271.579-.153 1.164-.359m9.764 4.725q-.982 0-1.582.717-.594.711-.594 1.919 0 1.547.659 2.505.667.96 1.729.96 1.026 0 1.633-.762.616-.762.616-2.073 0-1.436-.696-2.351-.689-.915-1.765-.915m.19-.769q1.545 0 2.556 1.04 1.018 1.032 1.018 2.563 0 1.684-1.069 2.842-1.07 1.15-2.637 1.15t-2.578-1.055q-1.003-1.055-1.003-2.666t1.091-2.739q1.098-1.135 2.622-1.135m11.089 6.335.205.461a6.4 6.4 0 0 1-1.003.608q-.454.22-.733.22-.469 0-.703-.271-.234-.278-.256-.835-.799.535-1.326.769-.528.228-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.162 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.959-.366-.63 0-.996.234-.36.227-.359.623 0 .036.007.102l.008.088q0 .228-.22.381a.93.93 0 0 1-.528.147q-.263 0-.388-.088-.124-.088-.124-.271 0-.586.989-1.304.989-.725 2.043-.725 1.018 0 1.545.564.528.557.528 1.64 0 .587-.074 1.802a38 38 0 0 0-.065 1.846q0 .476.102.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.381 1.538 0 .484.308.791.308.301.813.301.307 0 .711-.161.402-.162.937-.513zm5.428-3.947a22 22 0 0 0-.081 1.01q-.03.506-.044 1.077.593-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .66.227.241.22.241.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.015 1.905.022.725.058.922.066.374.279.513.22.14.739.139h.213V147a41 41 0 0 0-1.018-.066 15 15 0 0 0-1.634 0q-.447.023-.937.066v-.513h.168q.535 0 .725-.256.19-.257.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.058 0-.124.007a2 2 0 0 0-.22.022l-.088-.454q.52-.117 1.069-.293.55-.176 1.136-.41m8.964 1.472a4.5 4.5 0 0 0-.93-.41 3 3 0 0 0-.886-.132q-1.128 0-1.743.703t-.615 1.985q0 1.362.6 2.168.608.798 1.619.798.403 0 .864-.154a6 6 0 0 0 1.047-.476zm1.348-5.34-.007.132a388 388 0 0 0-.139 5.025l-.015 1.142q-.015.403-.029 1.077-.008.666-.008 1.472v.286q0 1.142.081 1.421.081.27.315.271.14 0 .285-.03.154-.028.315-.088l.118.462a6 6 0 0 1-1.004.293 5 5 0 0 1-.989.102l-.212-.007q-.051-.315-.081-.579a7 7 0 0 1-.022-.512q-.834.534-1.376.74a3 3 0 0 1-1.055.205q-1.282 0-2.088-.967-.805-.975-.805-2.527 0-1.728 1.032-2.791 1.034-1.062 2.681-1.062.373 0 .784.074.417.066.901.212 0-.066.007-.198.037-1.281.037-2.307 0-.461-.147-.652-.14-.19-.469-.19a1 1 0 0 0-.183.022q-.11.015-.3.051l-.088-.476q.542-.095 1.15-.242.607-.153 1.311-.359m3.984 3.868q-.051.498-.08 1.01-.03.506-.044 1.077.593-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .659.227.243.22.242.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.015 1.905.022.725.058.922.066.374.278.513.22.14.74.139h.213V147a41 41 0 0 0-1.018-.066 15 15 0 0 0-1.634 0q-.447.023-.937.066v-.513h.168q.535 0 .725-.256.19-.257.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.059 0-.125.007-.065 0-.219.022l-.088-.454q.52-.117 1.069-.293.55-.176 1.135-.41m7.134.857q-.98 0-1.582.717-.593.711-.593 1.919 0 1.547.659 2.505.666.96 1.729.96 1.025 0 1.633-.762.615-.762.615-2.073 0-1.436-.696-2.351-.688-.915-1.765-.915m.191-.769q1.545 0 2.556 1.04 1.018 1.032 1.018 2.563 0 1.684-1.069 2.842-1.07 1.15-2.637 1.15t-2.578-1.055q-1.004-1.055-1.004-2.666t1.092-2.739q1.098-1.135 2.622-1.135m8.071.769q-.981 0-1.582.717-.593.711-.593 1.919 0 1.547.659 2.505.666.96 1.728.96 1.025 0 1.634-.762.615-.762.615-2.073 0-1.436-.696-2.351-.688-.915-1.765-.915m.19-.769q1.546 0 2.557 1.04 1.017 1.032 1.018 2.563 0 1.684-1.07 2.842-1.07 1.15-2.636 1.15-1.568 0-2.579-1.055-1.003-1.055-1.003-2.666t1.091-2.739q1.1-1.135 2.622-1.135m6.761-.088q-.03.3-.052.586-.021.277-.029.564.996-.63 1.553-.843a2.9 2.9 0 0 1 1.069-.219q.623 0 1.055.285.44.286.747.901.981-.653 1.604-.915.622-.271 1.121-.271 1.069 0 1.552.651.49.652.491 2.11v.154l-.029 2.409q0 .367-.015.667v.029q0 .528.161.696t.645.168h.168V147a64 64 0 0 0-1.062-.059 16 16 0 0 0-.571-.014q-.234 0-.586.014-.345.015-.989.059v-.513q.044.008.11.015h.183q.469 0 .623-.3.16-.308.161-1.48v-1.069q0-.264.007-.696t.007-.608q0-.937-.344-1.377-.337-.44-1.047-.439-.345 0-.82.183a9 9 0 0 0-1.18.586l-.058 3.611v.6q0 .66.161.82.168.154.681.154h.088v.506a59 59 0 0 0-.967-.044 12 12 0 0 0-.666-.022q-.279 0-.652.022-.373.014-.784.051l-.007-.513q.513 0 .666-.08.154-.088.22-.396.052-.242.073-1.223a85 85 0 0 0 .03-2.512q0-.915-.33-1.326-.322-.417-1.033-.417-.344 0-.827.183a8 8 0 0 0-1.15.556q-.045 1.194-.066 2.073-.015.879-.015 1.597 0 1.12.147 1.34.154.22.637.22.036 0 .11-.007.08-.008.132-.008l-.008.513a19 19 0 0 0-.879-.051 13 13 0 0 0-1.516 0q-.396.014-.835.051l-.007-.513h.139q.915 0 .923-1.779 0-.264.007-.411l.015-1.794v-.725q0-.718-.11-.938-.11-.227-.403-.227-.058 0-.154.015-.088.014-.19.044l-.088-.454q.542-.147 1.091-.322.55-.177 1.092-.381"/></g><path fill="#fff" d="M224 122h18v13h-18z"/><path fill="#f78427" d="M230.531 132v-1.536h-3.491v-1.037l2.465-5.177h1.316l-2.406 5.054v.086h2.148v-2.063h1.16v2.073h1.107v1.064h-1.096V132zm4.243-4.001c-.94 0-1.525-.677-1.525-1.768v-.397c0-1.047.596-1.724 1.525-1.724s1.525.677 1.525 1.724v.397c0 1.091-.58 1.768-1.525 1.768M240 124.25v.843L233.2 132v-.843zm-5.226 2.927c.446 0 .693-.339.693-.972v-.312c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.312c0 .633.247.972.693.972m3.652 4.968c-.945 0-1.525-.671-1.525-1.762v-.397c0-1.048.596-1.73 1.525-1.73s1.526.682 1.526 1.73v.397c0 1.091-.586 1.762-1.526 1.762m0-.816c.446 0 .693-.344.693-.973v-.311c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.311c0 .629.247.973.693.973"/><g filter="url(#filter25_d_249_8276-cover-svg)"><rect width="76" height="30" x="153" y="165" fill="#fff" rx="2" shape-rendering="crispEdges"/><rect width="75" height="29" x="153.5" y="165.5" stroke="#f78427" stroke-opacity=".4" rx="1.5" shape-rendering="crispEdges"/><path fill="#f78427" d="m165.072 183.557.366.557a6 6 0 0 1-1.399.82 3.5 3.5 0 0 1-1.304.278q-1.435 0-2.343-1.025-.909-1.032-.909-2.637 0-1.662 1.15-2.812t2.805-1.15q.85 0 1.312.242.46.234.461.659a.8.8 0 0 1-.19.534q-.184.22-.425.22-.081 0-.681-.366-.593-.374-1.136-.374-.951 0-1.516.689-.556.681-.556 1.86 0 1.486.673 2.322.681.828 1.883.828.447 0 .886-.154.446-.154.923-.491m4.658-5.185q-.982 0-1.582.717-.593.711-.593 1.919 0 1.547.659 2.505.666.96 1.728.96 1.025 0 1.634-.762.615-.762.615-2.073 0-1.436-.696-2.351-.688-.915-1.765-.915m.19-.769q1.546 0 2.557 1.04 1.018 1.032 1.018 2.563 0 1.684-1.07 2.842-1.07 1.15-2.636 1.15-1.568 0-2.579-1.055-1.002-1.055-1.003-2.666t1.091-2.739q1.1-1.135 2.622-1.135m6.797-.088q-.051.498-.08 1.01-.03.506-.044 1.077.593-1.047 1.091-1.509.506-.46 1.04-.461.417 0 .659.227.242.22.242.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.014 1.905.023.725.059.922.066.373.278.513.22.14.74.139h.212V185q-.57-.043-1.018-.066a15 15 0 0 0-1.633 0q-.447.023-.937.066v-.513h.168q.534 0 .725-.256t.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.059 0-.125.007-.066 0-.219.022l-.088-.454a13 13 0 0 0 1.069-.293q.55-.176 1.135-.41m5.633 6.423q.44.212.879.33.439.117.834.117 1.085 0 1.7-.711.622-.717.622-1.992 0-1.377-.608-2.197-.607-.828-1.596-.828-.425 0-.894.139a4 4 0 0 0-.893.396 147 147 0 0 0-.059 3.765q0 .139.007.468.008.322.008.513m.102-6.511-.058 1.172q.666-.462 1.237-.674a3.3 3.3 0 0 1 1.136-.213q1.208 0 2.021.967.813.96.813 2.388 0 1.86-1.04 2.915-1.032 1.047-2.864 1.047-.336 0-.681-.066a4.3 4.3 0 0 1-.681-.205v2.615q0 .864 1.267.879h.007v.527a33 33 0 0 0-.937-.058 17 17 0 0 0-1.48 0q-.388.014-1.164.058v-.527q.476 0 .644-.051a.44.44 0 0 0 .257-.169q.19-.33.205-2.988v-.857l.014-1.663v-2.417q0-.907-.109-1.135-.103-.227-.411-.227-.072 0-.175.015t-.22.044l-.073-.447q.622-.176 1.186-.403.572-.234 1.106-.527m9.807.945q-.98 0-1.582.717-.593.711-.593 1.919 0 1.547.659 2.505.667.96 1.729.96 1.025 0 1.633-.762.615-.762.615-2.073 0-1.436-.696-2.351-.688-.915-1.765-.915m.191-.769q1.545 0 2.556 1.04 1.018 1.032 1.018 2.563 0 1.684-1.069 2.842-1.07 1.15-2.637 1.15t-2.578-1.055q-1.004-1.055-1.004-2.666t1.092-2.739q1.098-1.135 2.622-1.135m6.797-.088a22 22 0 0 0-.081 1.01q-.03.506-.044 1.077.593-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .66.227.241.22.241.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.366.191q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.015 1.905.022.725.058.922.066.373.279.513.22.14.739.139h.213V185a41 41 0 0 0-1.018-.066 15 15 0 0 0-1.634 0q-.447.023-.937.066v-.513h.168q.535 0 .725-.256t.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.058 0-.124.007a2 2 0 0 0-.22.022l-.088-.454q.52-.117 1.069-.293.55-.176 1.136-.41m10.151 6.423.205.461a6.4 6.4 0 0 1-1.003.608q-.454.22-.733.22-.468 0-.703-.271-.235-.278-.256-.835-.799.535-1.326.769-.527.228-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.162 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.959-.366-.63 0-.996.234-.359.227-.359.623 0 .036.007.102l.008.088q0 .228-.22.381a.93.93 0 0 1-.528.147q-.263 0-.388-.088-.124-.088-.124-.271 0-.586.989-1.304.988-.725 2.043-.725 1.018 0 1.545.564.528.557.528 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.102.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.38 1.538 0 .484.307.791.308.301.813.301.308 0 .711-.161.403-.162.937-.513zm4.988-5.039.484.147q-.044.402-.074.725-.021.315-.029.622h.52q.417 0 .85-.007.432-.015.871-.036l-.176.798a14 14 0 0 0-.886-.044q-.41-.015-.82-.015h-.344q-.045 1.26-.066 1.934-.015.666-.015 1.106 0 1.655.227 2.16.228.5.813.499.242 0 .535-.103.3-.103.725-.337l.242.483a8 8 0 0 1-1.275.645q-.571.212-.996.212-.783 0-1.142-.534-.36-.543-.359-1.736 0-.234.029-1.67.036-1.443.037-2.644-.066 0-.191.007-.607.022-.835.022v-.527q.718-.102 1.187-.527.469-.433.688-1.18m9.91 4.483h-3.574q-.418 0-.769.014t-.652.044v.271q0 1.435.659 2.22.666.783 1.875.783.534 0 1.055-.176.52-.183 1.106-.563l.285.468a6.1 6.1 0 0 1-1.509.93q-.747.315-1.479.315-1.421 0-2.344-1.01-.923-1.018-.923-2.608 0-1.692.967-2.842.967-1.149 2.359-1.149 1.296 0 2.065.864.77.864.879 2.439m-1.355-.769q-.22-.901-.667-1.377-.446-.483-1.069-.484-.704 0-1.208.564-.499.564-.652 1.524 1.45 0 2.278-.052.835-.05 1.318-.175"/></g><path fill="#fff" d="M214 161h18v13h-18z"/><path fill="#f78427" d="M218.855 167.52v-.999h.881c.811 0 1.359-.489 1.359-1.204 0-.709-.532-1.16-1.343-1.16s-1.343.462-1.402 1.209h-1.187c.075-1.408 1.074-2.272 2.632-2.272 1.498 0 2.535.832 2.535 2.035 0 .919-.51 1.59-1.353 1.778v.092c1.042.128 1.665.827 1.665 1.869 0 1.348-1.161 2.288-2.82 2.288-1.628 0-2.734-.908-2.804-2.31h1.209c.064.731.671 1.198 1.563 1.198.95 0 1.552-.483 1.552-1.246 0-.779-.618-1.278-1.579-1.278zm5.919-.521c-.94 0-1.525-.677-1.525-1.768v-.397c0-1.047.596-1.724 1.525-1.724s1.525.677 1.525 1.724v.397c0 1.091-.58 1.768-1.525 1.768M230 163.25v.843L223.2 171v-.843zm-5.226 2.927c.446 0 .693-.339.693-.972v-.312c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.312c0 .633.247.972.693.972m3.652 4.968c-.945 0-1.525-.671-1.525-1.762v-.397c0-1.048.596-1.73 1.525-1.73s1.526.682 1.526 1.73v.397c0 1.091-.586 1.762-1.526 1.762m0-.816c.446 0 .693-.344.693-.973v-.311c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.311c0 .629.247.973.693.973"/><path fill="#fff" d="M110 49h25v13h-25z"/><path fill="#e9411b" d="m114.002 59 3.416-6.574v-.08h-4.065v-1.102h5.381v1.117L115.372 59zm6.14-5.478c0-1.435 1.079-2.428 2.621-2.428 1.53 0 2.567.897 2.567 2.218 0 .827-.413 1.52-1.692 2.815L122 57.797v.097h3.454V59h-5.243v-.897l2.562-2.67c1.026-1.079 1.289-1.487 1.289-2.046 0-.741-.531-1.224-1.337-1.224-.822 0-1.364.542-1.364 1.353v.038h-1.219zm7.632 1.477c-.94 0-1.525-.677-1.525-1.768v-.397c0-1.047.596-1.724 1.525-1.724s1.525.677 1.525 1.724v.397c0 1.09-.58 1.767-1.525 1.767m5.226-3.75v.844L126.2 59v-.843zm-5.226 2.928c.446 0 .693-.339.693-.972v-.312c0-.628-.247-.972-.693-.972s-.693.344-.693.972v.312c0 .633.247.972.693.972m3.652 4.968c-.945 0-1.525-.671-1.525-1.762v-.397c0-1.047.596-1.73 1.525-1.73s1.526.682 1.526 1.73v.397c0 1.09-.586 1.762-1.526 1.762m0-.816c.446 0 .693-.344.693-.973v-.311c0-.629-.247-.972-.693-.972s-.693.343-.693.972v.311c0 .629.247.973.693.973"/><path fill="#000" d="M340.457 44v-.337q.03 0 .064.005h.097q.65 0 .659-1.812l.01-.717.02-1.3q.005-.419.005-.815.004-.4.004-.913 0-.42-.156-.58-.156-.162-.556-.162h-.04v-.337l.596.03q.278.01.464.01.537 0 1.182-.04.65-.044.761-.044 1.817 0 2.862.923t1.045 2.51q0 1.63-1.05 2.627-1.045.99-2.798.991-.26 0-.942-.039-.684-.04-1.109-.04-.2 0-.488.01t-.63.03m1.729-.59q.356.077.698.116.346.034.693.034 1.377 0 2.11-.751.737-.753.737-2.149 0-1.489-.791-2.334-.792-.845-2.197-.845-.29 0-.586.025a8 8 0 0 0-.611.063l-.044 2.803q-.009 1.025-.009 1.71zm10.253-2.14h-2.382q-.279 0-.513.01a8 8 0 0 0-.435.03v.18q0 .957.44 1.48.444.522 1.25.522.356 0 .703-.117.347-.122.737-.376l.191.313q-.504.41-1.006.62-.498.21-.986.21-.948 0-1.563-.674-.615-.679-.615-1.739 0-1.127.644-1.894.645-.767 1.573-.767.864 0 1.377.577.512.576.585 1.625m-.903-.512q-.147-.6-.444-.918a.94.94 0 0 0-.713-.322q-.469 0-.806.376-.332.376-.434 1.015.966 0 1.518-.034.556-.035.879-.117m5.786.512h-2.383q-.278 0-.512.01a8 8 0 0 0-.435.03v.18q0 .957.44 1.48.444.522 1.25.522.356 0 .703-.117.347-.122.737-.376l.19.313q-.503.41-1.005.62-.498.21-.987.21-.947 0-1.562-.674-.615-.679-.615-1.739 0-1.127.644-1.894.645-.767 1.572-.767.866 0 1.377.577.513.576.586 1.625m-.903-.512q-.147-.6-.444-.918a.94.94 0 0 0-.713-.322q-.469 0-.806.376-.332.376-.435 1.015.967 0 1.519-.034.556-.035.879-.117m2.925 2.534q.292.142.586.22.293.078.556.078.723 0 1.133-.474.415-.478.415-1.328 0-.918-.405-1.465-.405-.552-1.065-.551-.283 0-.595.092-.308.093-.596.264a103 103 0 0 0-.039 2.51l.005.312q.005.215.005.342m.068-4.34-.039.78q.444-.307.825-.449a2.2 2.2 0 0 1 .757-.141q.805 0 1.348.644.542.64.542 1.592 0 1.24-.694 1.943-.688.699-1.909.699-.225 0-.454-.044a3 3 0 0 1-.454-.137v1.743q0 .576.845.586h.005v.352q-.323-.025-.625-.04a12 12 0 0 0-.987 0q-.258.01-.776.04v-.352q.317 0 .43-.034a.3.3 0 0 0 .17-.112q.128-.22.137-1.993v-.571l.01-1.108v-1.612q0-.605-.073-.757-.069-.15-.274-.15a1 1 0 0 0-.117.009 2 2 0 0 0-.146.03l-.049-.299q.414-.117.791-.268.38-.157.737-.352m8.447-1.71q0 .362.039.713.045.353.132.693l-.381.074q-.083-.606-.468-.899-.381-.293-1.079-.293-.645 0-1.05.313a.98.98 0 0 0-.401.805q0 .81 1.719 1.387.23.074.352.117.786.274 1.157.703.37.425.371 1.055 0 .972-.737 1.577-.738.6-1.953.6-.464 0-.909-.077a5.3 5.3 0 0 1-.893-.235q.005-.048.005-.112.005-.067.005-.195a6 6 0 0 0-.157-1.358l.44-.102q.083.8.503 1.172.42.37 1.245.37.723 0 1.177-.36.453-.367.454-.938 0-.81-1.416-1.26a12 12 0 0 1-.313-.102q-.981-.317-1.406-.777-.425-.459-.425-1.172 0-.84.664-1.401.664-.562 1.665-.562.367 0 .742.06.376.058.918.204m5.362 4.029h-2.383q-.279 0-.513.01a8 8 0 0 0-.434.029v.18q0 .957.439 1.48.444.522 1.25.522.357 0 .703-.117.346-.122.738-.376l.19.313q-.503.41-1.006.62-.498.21-.986.21-.948 0-1.563-.674-.615-.679-.615-1.739 0-1.127.645-1.894.643-.767 1.572-.767.864 0 1.377.577.513.576.586 1.625m-.904-.513q-.146-.6-.444-.918a.94.94 0 0 0-.713-.322q-.468 0-.806.376-.332.376-.434 1.015.967 0 1.518-.034.558-.035.879-.117m5.787.512h-2.383q-.279 0-.513.01a8 8 0 0 0-.435.03v.18q0 .957.44 1.48.444.522 1.25.522.357 0 .703-.117.347-.122.737-.376l.191.313q-.504.41-1.006.62-.498.21-.986.21-.948 0-1.563-.674-.615-.679-.615-1.739 0-1.127.644-1.894.645-.767 1.573-.767.864 0 1.377.577.512.576.586 1.625m-.904-.512q-.146-.6-.444-.918a.94.94 0 0 0-.713-.322q-.469 0-.806.376-.332.376-.434 1.015.966 0 1.518-.034.556-.035.879-.117M382.259 44l-.005-.098q0-.195-.293-.517l-.117-.127-1.651-1.856q.269-.254.718-.659.987-.898.986-1.074 0-.06-.092-.093a.8.8 0 0 0-.259-.034h-.068v-.332l.537.024a20 20 0 0 0 .874 0q.253-.009.532-.024l.005.327h-.049a.4.4 0 0 0-.073-.005q-.523 0-1.792 1.167-.327.298-.508.46l1.733 1.864q.05.054.142.162.415.483.796.483h.083a.4.4 0 0 1 .058-.005l-.014.337a13 13 0 0 0-.493-.034 5 5 0 0 0-.371-.015q-.079 0-.201.01-.117.005-.478.039m-3.565-.342h.074q.254 0 .38-.068a.43.43 0 0 0 .186-.25q.073-.248.088-2.304.005-.19.005-.288l.01-.947.014-.864q.015-.552.015-.767 0-.6-.088-.806-.083-.204-.313-.205-.068 0-.224.03a.3.3 0 0 1-.054.01l-.073-.318q.4-.078.786-.18.385-.108.771-.25l-.058 3.042q-.02 1.338-.02 1.817v1.762q0 .396.118.488.122.093.522.098V44q-.337-.03-.605-.044a9 9 0 0 0-1.534.044zm8.062-6.626a30 30 0 0 0 1.269.04 21 21 0 0 0 1.304-.04l-.005.308q-.41.034-.547.107-.131.075-.131.254 0 .137.048.347.054.205.186.571l1.47 4.111q1.176-2.953 1.479-3.828.308-.879.308-1.152 0-.224-.122-.308-.117-.083-.547-.102v-.308a18 18 0 0 0 1.137.04q.235 0 .523-.01t.601-.03v.308h-.074q-.537 0-.913.947a386 386 0 0 0-1.909 4.634q-.396.996-.415 1.157h-.601q0-.117-.454-1.46a90 90 0 0 0-1.098-3.042l-.127-.346q-.708-1.9-1.25-1.9l-.078.005a.3.3 0 0 0-.054.005zm9.883 3.096.088-.005a2 2 0 0 1 .136-.005q.801 0 1.26.46.464.453.464 1.244 0 .933-.796 1.626a2.73 2.73 0 0 1-1.855.694q-.664 0-1.153-.26-.488-.263-.488-.6 0-.146.132-.283.137-.137.278-.137.181 0 .4.235l.088.093q.225.239.454.346.235.103.528.103.62 0 1.045-.454.425-.459.425-1.143 0-.64-.362-1.04-.361-.4-.937-.4-.206 0-.44.053a3 3 0 0 0-.493.157l-.137-.342q.972-.425 1.46-.894.489-.474.489-.986 0-.454-.303-.757a1.04 1.04 0 0 0-.767-.303 1.23 1.23 0 0 0-.669.205q-.317.205-.63.625l-.361-.21q.337-.6.811-.903a1.93 1.93 0 0 1 1.079-.307q.736 0 1.23.444.498.439.498 1.074 0 .541-.366.957-.367.415-1.108.713m4.082 2.602.39.289q.162.121.235.224a.3.3 0 0 1 .078.186q0 .117-.069.215a.9.9 0 0 1-.224.214l-.381.284-.356-.284a1 1 0 0 1-.245-.224.36.36 0 0 1-.068-.205q0-.094.049-.171a1.3 1.3 0 0 1 .244-.24zm4.853-5.79a58 58 0 0 0-.068 1.88q-.02.966-.02 2.582 0 .186-.009.489-.005.301-.005.42 0 .869.171 1.113.175.244.659.244l.097-.005q.069-.005.103-.005V44a43 43 0 0 0-1.528-.04q-.255 0-.63.01-.371.01-.821.03v-.332h.152q.518 0 .698-.103.18-.102.249-.405.044-.185.073-1.28.03-1.092.03-2.729 0-.253-.015-.766l-.015-.733a8 8 0 0 0-.6.035q-.318.024-.679.073l-.063-.371a32 32 0 0 0 2.221-.45m3.496 5.83q.4.307.523.488.126.18.127.4 0 .36-.371.87a4.8 4.8 0 0 1-.987.99l-.258-.317a2.5 2.5 0 0 0 .522-.547q.2-.293.283-.644a1.8 1.8 0 0 1-.381-.293.38.38 0 0 1-.107-.25q0-.092.063-.185a2 2 0 0 1 .298-.283zm5.806-4.488.322.098q-.029.269-.049.483-.014.21-.019.415h.347q.278 0 .566-.005.288-.009.581-.024l-.117.532a10 10 0 0 0-.591-.029 15 15 0 0 0-.547-.01h-.229q-.03.84-.044 1.29-.01.444-.01.737 0 1.103.151 1.44.152.332.542.332.162 0 .357-.068.2-.068.483-.225l.161.322a5.5 5.5 0 0 1-.849.43 2 2 0 0 1-.664.142q-.524 0-.762-.357-.24-.36-.239-1.157 0-.156.019-1.113a71 71 0 0 0 .025-1.763q-.045 0-.127.005-.406.015-.557.015v-.352a1.45 1.45 0 0 0 .791-.352q.312-.288.459-.786m6.606 2.989H419.1q-.279 0-.513.01a8 8 0 0 0-.435.029v.18q0 .957.44 1.48.444.522 1.25.522.356 0 .703-.117.347-.122.737-.376l.191.313q-.504.41-1.006.62-.498.21-.987.21-.947 0-1.562-.674-.615-.679-.615-1.739 0-1.127.644-1.894.645-.767 1.573-.767.864 0 1.376.577.514.576.586 1.625m-.903-.513q-.147-.6-.444-.918a.94.94 0 0 0-.713-.322q-.469 0-.806.376-.332.376-.434 1.015.966 0 1.518-.034.556-.035.879-.117m3.052-1.748q-.02.2-.034.39-.015.187-.02.376.664-.42 1.035-.561.371-.147.713-.147.415 0 .703.19.294.192.498.601.655-.435 1.07-.61.414-.18.747-.18.713 0 1.035.434.327.434.327 1.406v.103l-.019 1.606q0 .244-.01.444v.02q0 .351.107.464.108.112.43.112h.112V44q-.474-.03-.708-.04a10 10 0 0 0-.381-.009 10 10 0 0 0-.39.01q-.23.01-.659.039v-.342q.028.005.073.01h.122q.312 0 .415-.2.107-.206.107-.987v-.712q0-.176.005-.464l.005-.406q0-.624-.229-.918-.225-.293-.699-.293-.23 0-.547.122a6 6 0 0 0-.786.391l-.039 2.407v.4q0 .44.108.548.112.102.454.102h.058v.337a52 52 0 0 0-1.088-.044q-.186 0-.435.015-.249.01-.523.034l-.004-.342q.341 0 .444-.053.102-.06.146-.264.034-.162.049-.816.02-.654.02-1.674 0-.61-.22-.884-.215-.279-.688-.279-.23 0-.552.122a5.5 5.5 0 0 0-.767.372q-.029.795-.044 1.381-.01.587-.01 1.065 0 .747.098.894.103.146.425.146l.073-.005.088-.005-.005.342a13 13 0 0 0-.586-.034q-.283-.015-.532-.015-.215 0-.478.015a12 12 0 0 0-.557.034l-.005-.342h.093q.61 0 .615-1.186 0-.176.005-.274l.01-1.196v-.483q0-.48-.074-.625-.072-.152-.268-.152a1 1 0 0 0-.103.01 1 1 0 0 0-.127.03l-.058-.303a17 17 0 0 0 1.455-.47m8.672 4.282q.292.142.586.22.293.078.556.078.723 0 1.133-.474.415-.478.415-1.328 0-.918-.405-1.465-.405-.552-1.065-.551-.282 0-.595.092-.308.093-.596.264a103 103 0 0 0-.039 2.51l.005.312q.005.215.005.342m.068-4.34-.039.78q.444-.307.825-.449a2.2 2.2 0 0 1 .757-.141q.805 0 1.348.644.542.64.542 1.592 0 1.24-.694 1.943-.688.699-1.909.699-.225 0-.454-.044a3 3 0 0 1-.454-.137v1.743q0 .576.845.586h.005v.352q-.323-.025-.625-.04a12 12 0 0 0-.987 0q-.258.01-.776.04v-.352q.317 0 .43-.034a.3.3 0 0 0 .17-.112q.128-.22.137-1.993v-.571l.01-1.108v-1.612q0-.605-.073-.757-.069-.15-.274-.15a1 1 0 0 0-.117.009 2 2 0 0 0-.146.03l-.049-.299q.414-.117.791-.268.38-.157.737-.352m8.399 2.319h-2.383q-.279 0-.513.01a8 8 0 0 0-.435.029v.18q0 .957.44 1.48.444.522 1.25.522.357 0 .703-.117.347-.122.737-.376l.191.313q-.504.41-1.006.62-.498.21-.986.21-.948 0-1.563-.674-.615-.679-.615-1.739 0-1.127.644-1.894.645-.767 1.573-.767.864 0 1.377.577.512.576.586 1.625m-.904-.513q-.146-.6-.444-.918a.94.94 0 0 0-.713-.322q-.469 0-.806.376-.332.376-.434 1.015.966 0 1.518-.034.556-.035.879-.117m3.076-1.748q-.033.332-.053.674-.02.337-.03.717.396-.697.728-1.006.338-.307.693-.307.278 0 .44.151a.52.52 0 0 1 .161.4q0 .181-.108.313a.3.3 0 0 1-.244.127.7.7 0 0 1-.273-.093.7.7 0 0 0-.313-.097q-.253 0-.507.224-.255.22-.533.689v.537q0 .78.01 1.27.015.483.039.615.043.25.186.341.146.093.493.093h.141V44q-.38-.03-.678-.044a11 11 0 0 0-1.089 0q-.298.015-.625.044v-.342h.112q.357 0 .484-.17.126-.172.127-.797v-2.099q0-.528-.074-.679-.073-.15-.268-.151l-.083.005q-.044 0-.147.014l-.058-.303q.346-.078.713-.195.366-.118.756-.273m6.768 4.282.137.308q-.366.262-.669.405-.303.146-.489.146-.312 0-.468-.18-.156-.186-.171-.557-.533.357-.884.513-.351.15-.63.151-.493 0-.825-.371a1.32 1.32 0 0 1-.332-.908q0-.913 1.968-1.377.464-.108.722-.171 0-.083.005-.24.015-.321.015-.42 0-.507-.21-.746-.21-.244-.64-.244-.42 0-.664.156a.47.47 0 0 0-.234.483l.005.059q0 .15-.147.254a.6.6 0 0 1-.351.097q-.177 0-.259-.058-.083-.06-.083-.18 0-.392.659-.87.66-.483 1.362-.483.679 0 1.031.376.351.37.351 1.093 0 .39-.049 1.202-.044.81-.044 1.23 0 .318.069.43.073.112.254.112a.6.6 0 0 0 .2-.044q.127-.048.371-.166m-1.665-1.65-.278.073q-1.587.434-1.587 1.025 0 .322.205.528.204.2.542.2.204 0 .473-.108.269-.107.625-.341zm3.325-3.36.322.098q-.029.269-.048.483-.015.21-.02.415h.347q.278 0 .566-.005.288-.009.581-.024l-.117.532a10 10 0 0 0-.591-.029 15 15 0 0 0-.547-.01h-.229l-.044 1.29q-.01.444-.01.737 0 1.103.151 1.44.152.332.542.332.162 0 .357-.068.2-.068.483-.225l.161.322a5.5 5.5 0 0 1-.849.43 2 2 0 0 1-.664.142q-.523 0-.762-.357-.239-.36-.239-1.157 0-.156.019-1.113.025-.963.025-1.763-.045 0-.127.005-.405.015-.557.015v-.352a1.45 1.45 0 0 0 .791-.352q.312-.288.459-.786m3.858.782q-.034.956-.054 1.68-.02.717-.02.995 0 1.045.215 1.397.215.346.737.346.26 0 .577-.127a4.5 4.5 0 0 0 .722-.385q.015-.753.02-1.24.01-.489.01-.718v-.332q0-.615-.103-.772-.102-.156-.395-.156-.05 0-.108.005-.054 0-.112.005l-.029-.313q.414-.03.815-.093.405-.063.791-.156-.03.835-.044 1.49-.015.654-.015 1.142 0 .2-.005.503l-.004.395q0 .455.078.596.077.142.293.142a1 1 0 0 0 .112-.01q.068-.01.176-.04l.039.304-1.489.376-.02-.728a5.3 5.3 0 0 1-.928.586 1.7 1.7 0 0 1-.722.186q-.67 0-1.045-.386-.376-.385-.376-1.074 0-.175.014-.738.005-.234.005-.366l.015-.547q0-.136.005-.346l.005-.293q0-.42-.074-.557-.067-.137-.258-.137-.059 0-.137.01l-.161.02-.034-.318q.351-.058.722-.141.376-.088.782-.206m5.918-.054q-.035.332-.054.674-.02.337-.03.717.396-.697.728-1.006.338-.307.693-.307.279 0 .44.151a.52.52 0 0 1 .161.4q0 .181-.107.313a.3.3 0 0 1-.245.127.7.7 0 0 1-.273-.093.7.7 0 0 0-.313-.097q-.253 0-.507.224-.255.22-.533.689v.537q0 .78.01 1.27.015.483.039.615.044.25.186.341.146.093.493.093h.142V44a25 25 0 0 0-.679-.044 11 11 0 0 0-1.089 0q-.298.015-.625.044v-.342h.112q.357 0 .484-.17.126-.172.127-.797v-2.099q0-.528-.074-.679-.072-.15-.268-.151l-.083.005q-.043 0-.147.014l-.058-.303q.347-.078.713-.195t.757-.273m6.616 2.26h-2.383q-.279 0-.513.01a8 8 0 0 0-.434.03v.18q0 .957.439 1.48.444.522 1.25.522.357 0 .703-.117.346-.122.738-.376l.19.313q-.503.41-1.006.62-.498.21-.986.21-.948 0-1.563-.674-.615-.679-.615-1.739 0-1.127.645-1.894.644-.767 1.572-.767.864 0 1.377.577.513.576.586 1.625m-.904-.512q-.145-.6-.444-.918a.94.94 0 0 0-.713-.322q-.469 0-.805.376-.333.376-.435 1.015.967 0 1.518-.034.558-.035.879-.117m2.486.913h5.849v.571h-5.849zm0-1.87h5.849v.571h-5.849zm9.78-2.33q-.717 0-1.069.694-.352.688-.352 2.095 0 1.64.41 2.495.415.854 1.201.854.714 0 1.065-.698.356-.698.356-2.119 0-1.611-.415-2.466-.414-.855-1.196-.854m-2.31 3.228q0-1.714.679-2.734.68-1.026 1.792-1.026 1.08 0 1.699.918.62.918.62 2.544 0 1.71-.678 2.725-.674 1.016-1.792 1.016-1.08 0-1.699-.918-.621-.923-.621-2.525" opacity=".6"/><defs><filter id="filter0_d_249_8276-cover-svg" width="42" height="34" x="41" y="53" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter1_d_249_8276-cover-svg" width="50" height="34" x="84" y="53" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter2_d_249_8276-cover-svg" width="30" height="34" x="135" y="53" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter3_d_249_8276-cover-svg" width="77" height="34" x="166" y="53" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter4_d_249_8276-cover-svg" width="80" height="34" x="244" y="53" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter5_d_249_8276-cover-svg" width="98" height="34" x="325" y="53" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter6_d_249_8276-cover-svg" width="60" height="34" x="424" y="53" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter7_d_249_8276-cover-svg" width="39" height="34" x="41" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter8_d_249_8276-cover-svg" width="30" height="34" x="81" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter9_d_249_8276-cover-svg" width="24" height="34" x="112" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter10_d_249_8276-cover-svg" width="60" height="34" x="137" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter11_d_249_8276-cover-svg" width="21" height="34" x="198" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter12_d_249_8276-cover-svg" width="39" height="34" x="220" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter13_d_249_8276-cover-svg" width="30" height="34" x="260" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter14_d_249_8276-cover-svg" width="38" height="34" x="291" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter15_d_249_8276-cover-svg" width="67" height="34" x="330" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter16_d_249_8276-cover-svg" width="34" height="34" x="398" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter17_d_249_8276-cover-svg" width="30" height="34" x="433" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter18_d_249_8276-cover-svg" width="29" height="34" x="464" y="88" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter19_d_249_8276-cover-svg" width="70" height="34" x="344" y="202" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter20_d_249_8276-cover-svg" width="65" height="34" x="94" y="15" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter21_d_249_8276-cover-svg" width="90" height="34" x="151" y="202" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter22_d_249_8276-cover-svg" width="69" height="34" x="344" y="164" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter23_d_249_8276-cover-svg" width="51" height="34" x="344" y="126" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter24_d_249_8276-cover-svg" width="90" height="34" x="151" y="126" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter25_d_249_8276-cover-svg" width="80" height="34" x="151" y="164" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter></defs></svg>

    
  </div>
  

  

  <article class="content ">
    
    <nav id="left-toc" class="left-toc" aria-label="Table of contents"></nav>
    
    <p>Reproducibility is a bedrock of scientific progress. However, it&rsquo;s remarkably difficult to get reproducible results out of large language models.</p>
<p>For example, you might observe that asking ChatGPT the same question multiple times provides different results. This by itself is not surprising, since getting a result from a language model involves “sampling”, a process that converts the language model’s output into a probability distribution and probabilistically selects a token.</p>
<p>What might be more surprising is that even when we adjust the temperature down to 0<label for="sn1" class="sidenote-number"></label><input type="checkbox" id="sn1" class="margin-toggle"/><span class="sidenote">This means that the LLM always chooses the highest probability token, which is called greedy sampling.</span> (thus making the sampling theoretically deterministic), LLM APIs are still <strong>not</strong> deterministic in practice (see past discussions <a href="https://152334h.github.io/blog/non-determinism-in-gpt-4/">here</a>, <a href="https://community.openai.com/t/a-question-on-determinism/8185/2">here</a>, or <a href="https://cookbook.openai.com/examples/reproducible_outputs_with_the_seed_parameter">here</a>). Even when running inference on your own hardware with an OSS inference library like vLLM or SGLang, sampling still isn&rsquo;t deterministic (see <a href="https://docs.vllm.ai/en/v0.7.0/getting_started/faq.html">here</a> or <a href="https://docs.sglang.ai/references/faq.html">here</a>).</p>
<p>But why <em>aren’t</em> LLM inference engines deterministic? One common hypothesis is that some combination of floating-point non-associativity and concurrent execution leads to nondeterminism based on which concurrent core finishes first. We will call this the “concurrency + floating point” hypothesis for LLM inference nondeterminism. For example, <a href="https://arxiv.org/abs/2506.09501">a recent arXiv preprint</a> writes:</p>
<blockquote class="epigraph">
<p>Floating-point arithmetic in GPUs exhibits non-associativity, meaning $(a + b) + c \neq a + (b + c)$ due to finite precision and rounding errors. This property directly impacts the computation of attention scores and logits in the transformer architecture, where parallel operations across multiple threads can yield different results based on execution order.</p>
</blockquote>
<p><label for="mn1" class="margin-toggle"></label>
<span class="marginnote">You can also find the “concurrency + floating point” hypothesis repeated by others, like <a href="https://community.openai.com/t/a-question-on-determinism/8185">here</a> (<i>&ldquo;There are speed tradeoffs, and in order to make the endpoints fast GPUs are used, which do parallel [nondeterministic] calculations. Any modern GPU neural net calculations will be subject to these.&quot;</i>), or <a href="https://x.com/hosseeb/status/1773146428594090473">here</a> (<i>&ldquo;Because GPUs are highly parallelized, the ordering of additions or multiplications might be different on each execution, which can cascade into small differences in output.&quot;</i>).</span></p>
<p>While this hypothesis is not entirely wrong, it doesn&rsquo;t reveal the full picture. For example, even on a GPU, running the same matrix multiplication on the same data repeatedly will always provide bitwise equal results. We&rsquo;re definitely using floating-point numbers. And our GPU definitely has a lot of concurrency. Why don&rsquo;t we see nondeterminism in this test?</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bfloat16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">B</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bfloat16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ref</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">ref</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
</span></span></code></pre></div><p>To understand the true cause of LLM inference nondeterminism, we must look deeper.</p>
<p>Unfortunately, even <em>defining</em> what it means for LLM inference to be deterministic is difficult. Perhaps confusingly, the following statements are all simultaneously true:</p>
<ol>
<li>Some kernels on GPUs are <b>nondeterministic</b>.</li>
<li>However, all the kernels used in a language model’s forward pass are <b>deterministic</b>.</li>
<li>Moreover, the forward pass of an LLM inference server (like vLLM) can also be claimed to be <b>deterministic</b>.</li>
<li>Nevertheless, from the perspective of anybody using the inference server, the results are <b>nondeterministic</b>.</li>
</ol>
<p>In this post, we will explain why the “concurrency + floating point” hypothesis misses the mark, unmask the true culprit behind LLM inference nondeterminism, and explain how to defeat nondeterminism and obtain truly reproducible results in LLM inference.</p>
<h2 id="the-original-sin-floating-point-non-associativity">The original sin: floating-point non-associativity</h2>
<p>Before talking about nondeterminism, it&rsquo;s useful to explain why there are numerical differences at all. After all, we typically think of machine learning models as mathematical functions following structural rules such as commutativity or associativity. Shouldn’t there be a “mathematically correct” result that our machine learning libraries should provide us?</p>
<p>The culprit is <strong>floating-point non-associativity.</strong> That is, with floating-point numbers:</p>
$$ (a + b) + c \neq a + (b + c) $$<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="mf">1e20</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1e20</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="mf">0.1</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1e20</span> <span class="o">-</span> <span class="mf">1e20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="mf">0.1</span>
</span></span></code></pre></div><p>Ironically, breaking associativity is what makes floating-point numbers useful.</p>
<p>Floating-point numbers are useful because they allow for a “dynamic” level of precision. For the purposes of explanation, we will use base 10 (instead of binary), where floating-point numbers are in the format $\text{mantissa} * 10^\text{exponent}$. We will also use 3 digits for the mantissa and 1 digit for the exponent.</p>
<p>For example, for the value 3450, we can represent it exactly as $3.45 * 10^3$. We can also represent much smaller values like 0.486 as $4.86 * 10^{-1}$. In this way, floating point allows us to represent both very small as well as very large values. In the sciences, we might say that floating point allows us to maintain a constant number of “significant figures”.</p>
<p>If you add together two floating-point numbers with the same exponent, it looks similar to integer addition. For example, 123 ($1.23 * 10^2$) + 456 ($4.56 * 10^2$) results in 579 ($5.79 * 10^2$).</p>
<p>But what happens when we add two floating-point numbers with different exponents, such as 1230 and 23.4?  In this case, the exact result is 1253.4. However, we can only maintain 3 digits of precision at a time. Floating-point addition will thus <em>drop</em> the last 2 digits and obtain the value $1.25 * 10^3$ (or 1250).</p>
<figure>
<div class="figure-box">
<div class="floating-point-visualization">
    <div class="operation-line">
        <div class="number-group">
            <input type="number" class="number-input" id="num1" value="1230" placeholder="number A">
            <div class="representation" id="num1-rep">1.23 × 10²</div>
        </div>
        <div class="operator">+</div>
        <div class="number-group">
            <input type="number" class="number-input" id="num2" value="23.4" placeholder="number B">
            <div class="representation" id="num2-rep">3.45 × 10¹</div>
        </div>
        <div class="operator">=</div>
        <div class="result-representation">
            <div id="result-rep">1.57<span class="lost-digits">5</span> × 10²</div>
            <div class="exact-value" id="exact-value">Exact: 1575</div>
        </div>
    </div>
</div>
</div>
<!-- javascript must go below figure html -->
<link rel="preload" as="style" href="css/floating-point-visualization.css">
<link rel="stylesheet" href="css/floating-point-visualization.css" media="print" onload="this.media='all'">
<noscript><link rel="stylesheet" href="css/floating-point-visualization.css"></noscript>
<script src="js/floating-point-visualization.js" defer></script>
<figcaption>We require 3 digits of precision to represent 1230 and 3 digits of precision to represent 23.4. However, adding these 2 numbers together results in a number that requires 5 digits of precision to represent (1253.4). Our floating-point format must then drop the 34 off the end. In some sense, we have effectively rounded our original 23.4 to 20.0 before adding it. </figcaption>
</figure>
<p>At this point, however, we’ve destroyed information. Note that this can happen every time we add two floating-point numbers with different “scales” (i.e. different exponents). And adding together floating-point numbers with different exponents happens all of the time. In fact, if we could guarantee that we never needed different exponents, we could just use integers!</p>
<p>In other words, every time we add together floating-point numbers in a different order, we can get a completely different result. To take an extreme example, there are 102 possible different results for summing this array depending on the order.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">vals</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">results</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;There are </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="si">}</span><span class="s2"> unique results: </span><span class="si">{</span><span class="n">results</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Output:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># There are 102 unique results: [-8.326672684688674e-17, -7.45931094670027e-17, ..., 8.326672684688674e-17]</span>
</span></span></code></pre></div><p>Although this is the underlying cause for non-identical outputs, it does not directly answer where the nondeterminism comes from. It doesn’t help us understand why floating-point values get added in different orders, when that happens, nor how it can be avoided.</p>
<p>The answers lie in how kernels are implemented.</p>
<h2 id="why-dont-kernels-always-add-numbers-in-the-same-order">Why don’t kernels always add numbers in the same order?</h2>
<p>As mentioned above, one common explanation for why kernels add numbers in different orders is the “concurrency + floating point” hypothesis. The hypothesis states that if the order in which concurrent threads finish is nondeterministic and the accumulation order depends on the order in which concurrent threads finish (such as with an atomic add), our accumulation order will be nondeterministic as well.</p>
<p>Confusingly, although this can lead to nondeterministic kernels, concurrency (and atomic adds) end up being completely uninvolved in LLM inference nondeterminism! To explain what the real culprit is, let’s first understand why modern GPU kernels rarely need atomic adds.</p>
<h2 id="when-are-atomic-adds-needed">When are atomic adds needed?</h2>
<p>Typically a GPU launches a program concurrently across many “cores” (i.e. SMs). As the cores have no inherent synchronization among them, this poses a challenge if the cores need to communicate among each other. For example, if all cores must accumulate to the same element, you can use an “atomic add” (sometimes known as a &ldquo;<a href="https://en.wikipedia.org/wiki/Fetch-and-add">fetch-and-add</a>&rdquo;). The atomic add is “nondeterministic” &mdash; the order in which the results accumulate is purely dependent on which core finishes first.</p>
<p>Concretely, imagine that you are reducing a 100-element vector with 100 cores (e.g. <code>torch.sum()</code>). Although you can load all 100 elements in parallel, we must eventually reduce down to a single element. One way to accomplish this is with some kind of “atomic add” primitive, where the hardware guarantees that all additions will be processed but does not guarantee the order.</p>
<figure>
<div class="atomic-add-viz">
    <canvas id="atomic-add-canvas"></canvas>
</div>
<link rel="preload" as="style" href="css/atomic-add-viz.css">
<link rel="stylesheet" href="css/atomic-add-viz.css" media="print" onload="this.media='all'">
<noscript><link rel="stylesheet" href="css/atomic-add-viz.css"></noscript>
<script src="js/atomic-add-viz-v2.js" defer></script>
<figcaption> The atomic add ensures that every core's contributions will be reflected in the final sum. However, it makes no guarantee about what <i>order</i> the contributions will be added. The order depends entirely on which core finishes first, a nondeterministic property. Thus, executing the same parallel program multiple times can result in nondeterministic outputs. </figcaption>
</figure>
<p>This is usually what folks mean by &ldquo;nondeterminism&rdquo; — you execute the same kernel twice with exactly the same inputs and you get a different result out. This is known as <i>run-to-run nondeterminism</i>, where you run the same python script twice with the exact same dependencies but get a different result.</p>
<p>Although concurrent atomic adds <strong>do</strong> make a kernel nondeterministic, <i>atomic adds are not necessary for the vast majority of kernels.</i> In fact, in the typical forward pass of an LLM, there is usually <i>not a single atomic add present.</i></p>
<p>This may be surprising, given that parallelizing a reduction can benefit from atomic adds. There are two main reasons why atomic adds do not end up being needed.</p>
<ol>
<li>There is often sufficient parallelism along the “batch” dimension that we don’t need to parallelize along the reduction dimension. For example, let’s say that instead of reducing a single 100-dim vector we were reducing 500 vectors in parallel. In this case, we can reduce an entire vector in each core and allow every core to operate on a different vector.</li>
<li>Over time, most neural network libraries have adopted a variety of strategies for achieving determinism without sacrificing performance. For example, we can perform a &ldquo;split&rdquo; (or tree) reduction, where we split the 100-element reduction into five 20-element reductions (thus achieving five-way parallelism). Then, to combine the remaining five elements, we can either perform a separate &ldquo;clean-up&rdquo; reduction (which isn&rsquo;t parallelized, but operates over few enough elements to be cheap) or utilize a semaphore (which ensures that each concurrent thread-block will accumulate in a deterministic order).<label for="sn2" class="sidenote-number"></label><input type="checkbox" id="sn2" class="margin-toggle"/><span class="sidenote">The semaphore strategy can be found described <a href="https://github.com/NVIDIA/cutlass/issues/1421#issuecomment-2016942675">here</a>.</span></li>
</ol>
<p>Due to these two factors, avoiding atomics adds is a negligible performance penalty for the vast majority of neural network operations.</p>
<p>There are still a couple of common operations that have significant performance penalties for avoiding atomics. For example, <code>scatter_add</code> in PyTorch (<code>a[b] += c</code>). The only one commonly used in LLMs, however, is FlashAttention backward.<label for="sn3" class="sidenote-number"></label><input type="checkbox" id="sn3" class="margin-toggle"/><span class="sidenote">Fun fact: did you know that the widely used Triton implementations of FlashAttention backward actually differ algorithmically from Tri Dao&rsquo;s FlashAttention-2 <a href="https://arxiv.org/abs/2307.08691">paper</a>? The standard Triton implementation does additional recomputation in the backward pass, avoiding atomics but costing 40% more FLOPs!</span></p>
<p>However, the forward pass of an LLM involves <i>no operations that require atomic adds.</i> Thus, the forward pass in an LLM is in fact “run-to-run deterministic.”</p>
<figure style="margin-top: 2rem; margin-bottom: 2.3rem;">
<svg xmlns="http://www.w3.org/2000/svg" width="600" height="250" fill="none" viewBox="0 0 600 250"><style>text{font-family:&quot;GT America&quot;}</style><path fill="#f5f5f5" d="M0 0h600v250H0z"/><path fill="#fff" d="M0 0h600v250H0z"/><g filter="url(#filter0_f_249_8276-deterministic-svg)"><rect width="166" height="163" x="269" y="44" fill="#eaf4bf" rx="4"/></g><g filter="url(#filter1_d_249_8276-deterministic-svg)"><rect width="82" height="82" x="311" y="86" fill="#fff" rx="4" shape-rendering="crispEdges"/><rect width="83" height="83" x="310.5" y="85.5" stroke="#000" stroke-opacity=".2" rx="4.5" shape-rendering="crispEdges"/><text xml:space="preserve" fill="#393939" font-family="GT America" font-size="15" letter-spacing="0em" style="white-space:pre"><tspan x="331" y="132.565">Model</tspan></text></g><text xml:space="preserve" fill="#5a850c" font-family="GT America" font-size="15" letter-spacing="0em" style="white-space:pre"><tspan x="279" y="65.065">Deterministic</tspan></text><g filter="url(#filter2_d_249_8276-deterministic-svg)"><rect width="115" height="35" x="67" y="47" fill="#fff" rx="4" shape-rendering="crispEdges"/><rect width="116" height="36" x="66.5" y="46.5" stroke="#000" stroke-opacity=".2" rx="4.5" shape-rendering="crispEdges"/><text xml:space="preserve" fill="#393939" font-family="GT America" font-size="15" letter-spacing="0em" style="white-space:pre"><tspan x="77" y="70.065">User requests</tspan></text></g><g filter="url(#filter3_d_249_8276-deterministic-svg)"><rect width="156" height="35" x="26" y="172" fill="#fff" rx="4" shape-rendering="crispEdges"/><rect width="157" height="36" x="25.5" y="171.5" stroke="#000" stroke-opacity=".2" rx="4.5" shape-rendering="crispEdges"/><text xml:space="preserve" fill="#393939" font-family="GT America" font-size="15" letter-spacing="0em" style="white-space:pre"><tspan x="36" y="195.065">Other user requests</tspan></text></g><g filter="url(#filter4_d_249_8276-deterministic-svg)"><rect width="69" height="35" x="506" y="110" fill="#fff" rx="4" shape-rendering="crispEdges"/><rect width="70" height="36" x="505.5" y="109.5" stroke="#000" stroke-opacity=".2" rx="4.5" shape-rendering="crispEdges"/><text xml:space="preserve" fill="#393939" font-family="GT America" font-size="15" letter-spacing="0em" style="white-space:pre"><tspan x="516" y="133.065">Output</tspan></text></g><path fill="#000" fill-opacity=".5" d="M496.354 127.354a.5.5 0 0 0 0-.708l-3.182-3.182a.502.502 0 0 0-.708.708l2.829 2.828-2.829 2.828a.502.502 0 0 0 .708.708zM402 127v.5h94v-1h-94z"/><path fill="#000" fill-opacity=".5" d="M207.54 64.514c5.548.28 9.96 4.868 9.96 10.486v42a9.5 9.5 0 0 0 9.5 9.5h72.793l-2.328-2.328a.5.5 0 0 1 .707-.707l3.182 3.181a.5.5 0 0 1 0 .708l-3.182 3.181a.5.5 0 0 1-.707-.707l2.328-2.328H227a9.5 9.5 0 0 0-9.5 9.5v43.5c0 5.799-4.701 10.5-10.5 10.5h-14.5v-1H207a9.5 9.5 0 0 0 9.5-9.5V137c0-4.681 3.063-8.645 7.294-10-4.231-1.355-7.294-5.319-7.294-10V75a9.5 9.5 0 0 0-9.011-9.487L207 65.5h-15v-1h15z"/><defs><filter id="filter0_f_249_8276-deterministic-svg" width="182" height="179" x="261" y="36" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur result="effect1_foregroundBlur_249_8276" stdDeviation="4"/></filter><filter id="filter1_d_249_8276-deterministic-svg" width="92" height="92" x="306" y="83" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="2"/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter2_d_249_8276-deterministic-svg" width="125" height="45" x="62" y="44" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="2"/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter3_d_249_8276-deterministic-svg" width="166" height="45" x="21" y="169" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="2"/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter><filter id="filter4_d_249_8276-deterministic-svg" width="79" height="45" x="501" y="107" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="2"/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_249_8276" result="shape"/></filter></defs></svg>
<figcaption>From the perspective of the inference server, it <i>is</i> deterministic. Given the exact same user requests, it will always provide the same deterministic output. </figcaption>
</figure>
<p>Wikipedia writes that &ldquo;a deterministic algorithm is an algorithm that, given a particular input, will always produce the same output.&rdquo; And in this case, given the exact same inputs (i.e. the exact requests the inference server is processing), the forward pass always produces the exact same outputs.</p>
<p>However, the forward pass itself being “deterministic” is not sufficient to ensure that a system that includes it is deterministic. For example, what if our request’s output depended on the parallel user requests (e.g. batch-norm)? Since each individual request has no way of knowing what the parallel requests will be, from their perspective our overall LLM inference is also nondeterministic!</p>
<p>As it turns out, our request’s output <em>does</em> depend on the parallel user requests. Not because we’re somehow leaking information across batches &mdash; instead, it’s because our forward pass lacks “batch invariance”, causing our request’s output to depend on the <strong>batch size</strong> of our forward pass.</p>
<h3 id="batch-invariance-and-determinism">Batch invariance and “determinism”</h3>
<p>To explain batch invariance, let&rsquo;s simplify the system and look solely at matmuls. You can assume that all matmul implementations are &ldquo;run-to-run deterministic.&quot;<label for="sn4" class="sidenote-number"></label><input type="checkbox" id="sn4" class="margin-toggle"/><span class="sidenote">This is not totally true, but most common matmul implementations do have this property.</span>  However, they are not &ldquo;batch-invariant.&rdquo; In other words, when the batch size changes, each element in the batch can get different results.</p>
<p>This is a fairly unusual property from a mathematical perspective. Matrix multiplication should be “independent” along every element in the batch &mdash; neither the other elements in the batch nor how large the batch is should affect the computation results of a specific element in the batch.</p>
<p>However, as we can observe empirically, this isn’t true.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch</span>
</span></span><span class="line"><span class="cl"><span class="n">torch</span><span class="o">.</span><span class="n">set_default_device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">B</span> <span class="o">=</span> <span class="mi">2048</span>
</span></span><span class="line"><span class="cl"><span class="n">D</span> <span class="o">=</span> <span class="mi">4096</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">B</span><span class="o">*</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">D</span><span class="o">*</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Doing a matrix vector multiplication by taking</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the first element of the batch</span>
</span></span><span class="line"><span class="cl"><span class="n">out1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Doing a matrix matrix multiplication and then taking</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the first element of the batch</span>
</span></span><span class="line"><span class="cl"><span class="n">out2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)[:</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">((</span><span class="n">out1</span> <span class="o">-</span> <span class="n">out2</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="c1"># tensor(1669.2500, device=&#39;cuda:0&#39;)</span>
</span></span></code></pre></div><p>Note that this <i>is</i> &ldquo;run-to-run deterministic.&rdquo; If you run the script multiple times, it will deterministically return the same result.<label for="sn5" class="sidenote-number"></label><input type="checkbox" id="sn5" class="margin-toggle"/><span class="sidenote">It is not &ldquo;hardware/software version invariant&rdquo; — your GPU/PyTorch version may return a different value, but it should deterministically return the same value.</span></p>
<p>However, when a non-batch-invariant kernel is used as part of a larger inference system, the system can become nondeterministic. When you make a query to an inference endpoint, the amount of load the server is under is effectively “nondeterministic” from the user’s perspective. The load determines the batch size that the kernels are run under, and thus changes the eventual result of each individual request!</p>
<figure style="margin-top: 2.3rem;">
<svg xmlns="http://www.w3.org/2000/svg" width="600" height="250" fill="none" viewBox="0 0 600 250"><style>text{font-family:&quot;GT America&quot;}</style><path fill="#f5f5f5" d="M0 0h600v250H0z"/><g clip-path="url(#nd_clip0_249_8276-nondeterministic-svg)"><path fill="#fff" d="M0 0h600v250H0z"/><g filter="url(#nd_filter0_f_249_8276-nondeterministic-svg)"><rect width="222" height="238" x="252" y="6" fill="#faf9d3" rx="4"/></g><g filter="url(#nd_filter1_f_249_8276-nondeterministic-svg)"><rect width="247" height="91" x="9" y="153" fill="#faf9d3" rx="4"/></g><g filter="url(#nd_filter2_f_249_8276-nondeterministic-svg)"><rect width="166" height="163" x="280" y="53" fill="#e3eeb0" rx="4"/></g><g filter="url(#nd_filter3_d_249_8276-nondeterministic-svg)"><rect width="82" height="82" x="322" y="95" fill="#fff" rx="4" shape-rendering="crispEdges"/><rect width="83" height="83" x="321.5" y="94.5" stroke="#000" stroke-opacity=".2" rx="4.5" shape-rendering="crispEdges"/><text xml:space="preserve" fill="#393939" font-family="GT America" font-size="15" letter-spacing="0em" style="white-space:pre"><tspan x="342" y="141.565">Model</tspan></text></g><text xml:space="preserve" fill="#5a850c" font-family="GT America" font-size="15" letter-spacing="0em" style="white-space:pre"><tspan x="290" y="74.065">Deterministic</tspan></text><text xml:space="preserve" fill="#9c960a" font-family="GT America" font-size="15" letter-spacing="0em" style="white-space:pre"><tspan x="262" y="27.065">Nondeterministic</tspan></text><g filter="url(#nd_filter4_d_249_8276-nondeterministic-svg)"><rect width="115" height="35" x="78" y="56" fill="#fff" rx="4" shape-rendering="crispEdges"/><rect width="116" height="36" x="77.5" y="55.5" stroke="#000" stroke-opacity=".2" rx="4.5" shape-rendering="crispEdges"/><text xml:space="preserve" fill="#393939" font-family="GT America" font-size="15" letter-spacing="0em" style="white-space:pre"><tspan x="88" y="79.065">User requests</tspan></text></g><g filter="url(#nd_filter5_d_249_8276-nondeterministic-svg)"><rect width="156" height="35" x="37" y="181" fill="#fff" rx="4" shape-rendering="crispEdges"/><rect width="157" height="36" x="36.5" y="180.5" stroke="#000" stroke-opacity=".2" rx="4.5" shape-rendering="crispEdges"/><text xml:space="preserve" fill="#393939" font-family="GT America" font-size="15" letter-spacing="0em" style="white-space:pre"><tspan x="47" y="204.065">Other user requests</tspan></text></g><g filter="url(#nd_filter6_d_249_8276-nondeterministic-svg)"><rect width="69" height="35" x="517" y="119" fill="#fff" rx="4" shape-rendering="crispEdges"/><rect width="70" height="36" x="516.5" y="118.5" stroke="#000" stroke-opacity=".2" rx="4.5" shape-rendering="crispEdges"/><text xml:space="preserve" fill="#393939" font-family="GT America" font-size="15" letter-spacing="0em" style="white-space:pre"><tspan x="527" y="142.065">Output</tspan></text></g><path fill="#000" fill-opacity=".5" d="M507.354 136.354a.5.5 0 0 0 0-.708l-3.182-3.182a.502.502 0 0 0-.708.708l2.829 2.828-2.829 2.828a.502.502 0 0 0 .708.708zM413 136v.5h94v-1h-94z"/><path fill="#000" fill-opacity=".5" d="M218.54 73.514c5.548.28 9.96 4.868 9.96 10.486v42a9.5 9.5 0 0 0 9.5 9.5h72.793l-2.328-2.328a.5.5 0 0 1 .707-.707l3.182 3.181a.5.5 0 0 1 0 .708l-3.182 3.181a.5.5 0 0 1-.707-.707l2.328-2.328H238a9.5 9.5 0 0 0-9.5 9.5v43.5c0 5.799-4.701 10.5-10.5 10.5h-14.5v-1H218a9.5 9.5 0 0 0 9.5-9.5V146c0-4.681 3.063-8.645 7.294-10-4.231-1.355-7.294-5.319-7.294-10V84a9.5 9.5 0 0 0-9.011-9.487L218 74.5h-15v-1h15z"/></g><defs><filter id="nd_filter0_f_249_8276-nondeterministic-svg" width="238" height="254" x="244" y="-2" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur result="nd_effect1_foregroundBlur_249_8276" stdDeviation="4"/></filter><filter id="nd_filter1_f_249_8276-nondeterministic-svg" width="263" height="107" x="1" y="145" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur result="nd_effect2_foregroundBlur_249_8276" stdDeviation="4"/></filter><filter id="nd_filter2_f_249_8276-nondeterministic-svg" width="182" height="179" x="272" y="45" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur result="nd_effect3_foregroundBlur_249_8276" stdDeviation="4"/></filter><filter id="nd_filter3_d_249_8276-nondeterministic-svg" width="92" height="92" x="317" y="92" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="2"/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"/><feBlend in2="BackgroundImageFix" result="nd_effect1_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="nd_effect1_dropShadow_249_8276" result="shape"/></filter><filter id="nd_filter4_d_249_8276-nondeterministic-svg" width="125" height="45" x="73" y="53" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="2"/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"/><feBlend in2="BackgroundImageFix" result="nd_effect2_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="nd_effect2_dropShadow_249_8276" result="shape"/></filter><filter id="nd_filter5_d_249_8276-nondeterministic-svg" width="166" height="45" x="32" y="178" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="2"/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"/><feBlend in2="BackgroundImageFix" result="nd_effect3_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="nd_effect3_dropShadow_249_8276" result="shape"/></filter><filter id="nd_filter6_d_249_8276-nondeterministic-svg" width="79" height="45" x="512" y="116" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="2"/><feGaussianBlur stdDeviation="2"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"/><feBlend in2="BackgroundImageFix" result="nd_effect4_dropShadow_249_8276"/><feBlend in="SourceGraphic" in2="nd_effect4_dropShadow_249_8276" result="shape"/></filter><clipPath id="nd_clip0_249_8276-nondeterministic-svg"><path fill="#fff" d="M0 0h600v250H0z"/></clipPath></defs></svg>
<figcaption style="margin-top: 3rem;">Although the inference server itself can be claimed to be "deterministic", the story is different for an individual user. From the perspective of an individual user, the other concurrent users are not an "input" to the system but rather a nondeterministic property of the system. This makes LLM inference "nondeterministic" from the perspective of each user.</figcaption>
</figure>
<p>If you compose some property under which the kernel is not invariant (i.e. batch-size) with nondeterminism of that property (i.e. the load the server is under), you get a nondeterministic system.</p>
<p>In other words, <b>the primary reason nearly all LLM inference endpoints are nondeterministic is that the load (and thus batch-size) nondeterministically varies!</b> This nondeterminism is not unique to GPUs — LLM inference endpoints served from CPUs or TPUs will also have this source of nondeterminism.</p>
<p>So, if we’d like to avoid nondeterminism in our inference servers, we must achieve batch invariance in our kernels. In order to understand how that can be achieved, let’s first take a look at why kernels don’t have batch invariance in the first place.</p>
<h2 id="how-do-we-make-kernels-batch-invariant">How do we make kernels batch-invariant?</h2>
<p>In order to make a transformer implementation batch-invariant, we must make every kernel batch-invariant. Luckily, we can assume that every pointwise operation is batch-invariant.<label for="sn6" class="sidenote-number"></label><input type="checkbox" id="sn6" class="margin-toggle"/><span class="sidenote">Although this is true for all kernels in say, PyTorch, it&rsquo;s not inherently true. For example, there are some kernel implementations on CPU that will use vectorized intrinsics on some parts of the array and non-vectorized intrinsics on other parts, and these intrinsics don&rsquo;t necessarily always have bitwise identical numerics.</span> Thus, we only need to worry about the 3 operations that involve reductions — RMSNorm, matrix multiplication, and attention.<label for="sn7" class="sidenote-number"></label><input type="checkbox" id="sn7" class="margin-toggle"/><span class="sidenote">Reductions related to parallelism are out of the scope of this discussion, but the same principles apply. One factoid that may be useful is that NVLink-Sharp in-switch reductions are deterministic on Blackwell as well as Hopper with CUDA 12.8+. As is the case with many things, this information can be found on NCCL&rsquo;s <a href="https://github.com/NVIDIA/nccl/issues/1497#issuecomment-3210819243">github issues</a></span></p>
<p>Conveniently, these are also ordered in ascending levels of difficulty. Each one requires some additional considerations to achieve batch invariance with reasonable performance. Let’s talk about RMSNorm first.</p>
<h3 id="batch-invariant-rmsnorm">Batch-invariant RMSNorm</h3>
<figure class="half-width">
<svg xmlns="http://www.w3.org/2000/svg" width="480" height="350" fill="none" viewBox="0 0 480 350"><path fill="#f5f5f5" d="M0 0h480v350H0z"/><path fill="#fff" d="M0 0h480v350H0z"/><g clip-path="url(#clip0_249_8276-rmsnorm-01-svg)"><path fill="#ef402c" d="M111 79.902h45v45h-45z"/><path fill="#ef402c" d="M157 79.902h45v45h-45z" opacity=".86"/><path fill="#ef402c" d="M203 79.902h45v45h-45z" opacity=".72"/><path fill="#ef402c" d="M249 79.902h45v45h-45z" opacity=".58"/><path fill="#ef402c" d="M295 79.902h45v45h-45z" opacity=".44"/><path fill="#ef402c" d="M341 79.902h45v45h-45z" opacity=".3"/><path fill="#f7a224" d="M111 125.902h45v45h-45z"/><path fill="#f7a224" d="M157 125.902h45v45h-45z" opacity=".86"/><path fill="#f7a224" d="M203 125.902h45v45h-45z" opacity=".72"/><path fill="#f7a224" d="M249 125.902h45v45h-45z" opacity=".58"/><path fill="#f7a224" d="M295 125.902h45v45h-45z" opacity=".44"/><path fill="#f7a224" d="M341 125.902h45v45h-45z" opacity=".3"/><path fill="#009de4" d="M111 171.902h45v45h-45z"/><path fill="#009de4" d="M157 171.902h45v45h-45z" opacity=".86"/><path fill="#009de4" d="M203 171.902h45v45h-45z" opacity=".72"/><path fill="#009de4" d="M249 171.902h45v45h-45z" opacity=".58"/><path fill="#009de4" d="M295 171.902h45v45h-45z" opacity=".44"/><path fill="#009de4" d="M341 171.902h45v45h-45z" opacity=".3"/><path fill="#6d2764" d="M111 217.902h45v45h-45z"/><path fill="#6d2764" d="M157 217.902h45v45h-45z" opacity=".86"/><path fill="#6d2764" d="M203 217.902h45v45h-45z" opacity=".72"/><path fill="#6d2764" d="M249 217.902h45v45h-45z" opacity=".58"/><path fill="#6d2764" d="M295 217.902h45v45h-45z" opacity=".44"/><path fill="#6d2764" d="M341 217.902h45v45h-45z" opacity=".3"/></g><path fill="#000" d="m220.557 37.524.11.015h.175q.587 0 .791-.381.213-.39.213-1.721 0-.22-.008-.784a71 71 0 0 1-.007-.93V31.73q0-.404.007-1.26.008-.864.008-1.319 0-.622-.242-.864-.234-.249-.828-.249h-.117v-.49l2.454.058q.945.015 1.596.015.71 0 1.531-.015.828-.022 1.846-.059 0 .506.029 1.07.037.556.103 1.267l-.506.058q-.05-.93-.52-1.252-.468-.322-2.094-.322-.571 0-1.78.029h-.044a278 278 0 0 1-.081 3.89h.242q.41 0 1.018.006.608.008.828.008 1.077 0 1.421-.198.351-.198.381-.732l.461.029q-.059.55-.081.908a11 11 0 0 0-.014 1.172q.014.3.036.674l-.483.036v-.124q0-.6-.359-.813-.358-.22-1.663-.22h-1.787v2.85q0 1.054.235 1.332.234.271.952.271h.286V38a43 43 0 0 0-2.146-.059q-.257 0-.784.015-.52.014-1.179.044zm14.487-3.618h-3.574q-.418 0-.769.014t-.652.044v.271q0 1.436.659 2.22.666.783 1.875.783.534 0 1.055-.175.52-.184 1.106-.565l.285.47q-.755.615-1.508.93-.748.315-1.48.314-1.421 0-2.344-1.01-.923-1.019-.923-2.608 0-1.692.967-2.842t2.359-1.15q1.296 0 2.065.865.77.864.879 2.439m-1.355-.77q-.22-.9-.667-1.376-.446-.484-1.069-.484-.703 0-1.208.564-.498.564-.652 1.524 1.45 0 2.278-.051.835-.052 1.318-.176m8.906 3.802.205.461q-.549.396-1.003.608-.454.22-.733.22-.468 0-.703-.27-.234-.28-.256-.836-.798.534-1.326.77-.526.226-.945.226-.74 0-1.237-.556-.498-.557-.498-1.363 0-1.37 2.951-2.065.696-.161 1.084-.257 0-.123.008-.358.022-.484.022-.63 0-.763-.315-1.12-.315-.367-.96-.367-.63 0-.996.234-.359.228-.359.623a1 1 0 0 0 .008.102q.006.06.007.088 0 .228-.22.381a.93.93 0 0 1-.527.147q-.264 0-.388-.088-.125-.089-.125-.271 0-.585.989-1.304.988-.725 2.043-.725 1.018 0 1.546.564.527.556.527 1.64 0 .587-.073 1.802-.066 1.216-.066 1.846 0 .476.102.645.111.168.381.168a1 1 0 0 0 .301-.066 8 8 0 0 0 .556-.249m-2.497-2.476-.418.11q-2.38.652-2.38 1.538 0 .484.307.791.308.3.813.3.308 0 .711-.16a5.5 5.5 0 0 0 .937-.513zm4.987-5.039.484.147q-.044.402-.073.725-.022.315-.03.622h.52q.418 0 .85-.007.432-.015.872-.037l-.176.799q-.47-.037-.886-.044-.41-.015-.821-.015h-.344l-.066 1.934q-.015.666-.015 1.106 0 1.655.227 2.16.228.498.813.498.243 0 .535-.102.3-.102.725-.337l.242.483a8 8 0 0 1-1.275.645q-.57.213-.996.212-.783 0-1.142-.534-.359-.543-.359-1.736 0-.234.029-1.67.037-1.443.037-2.644-.066 0-.191.007-.607.022-.835.022v-.527q.718-.103 1.187-.527.469-.433.688-1.18m5.787 1.172q-.052 1.435-.081 2.52a62 62 0 0 0-.029 1.494q0 1.567.322 2.095.322.52 1.106.52.389 0 .864-.19a6.7 6.7 0 0 0 1.084-.58q.023-1.126.029-1.86.015-.732.015-1.076v-.498q0-.923-.154-1.158-.153-.234-.593-.234-.073 0-.161.007-.08 0-.169.008l-.043-.47q.622-.043 1.223-.138.607-.096 1.186-.235-.043 1.253-.066 2.234a82 82 0 0 0-.022 1.714q0 .3-.007.754a42 42 0 0 0-.007.594q0 .681.117.893.117.213.439.213.073 0 .169-.015.102-.015.263-.059l.059.455-2.234.564-.029-1.092q-.791.6-1.392.88-.593.277-1.084.277-1.003 0-1.567-.578-.564-.579-.564-1.611 0-.264.022-1.107.007-.351.007-.549l.022-.82q0-.205.007-.52.008-.322.008-.44 0-.63-.11-.835-.103-.204-.388-.205-.088 0-.205.015l-.242.03-.051-.477q.527-.088 1.084-.212.563-.132 1.172-.308m8.877-.08q-.052.498-.081 1.01-.03.506-.044 1.077.594-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .66.227.241.22.241.6 0 .271-.161.47a.46.46 0 0 1-.366.19q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.015 1.905.022.724.058.922.066.374.279.513.22.14.739.14h.213V38q-.572-.044-1.018-.066a16 16 0 0 0-1.634 0q-.447.022-.937.066v-.513h.168q.535 0 .725-.256t.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.058 0-.124.007-.066 0-.22.022l-.088-.454q.52-.117 1.069-.293.55-.176 1.136-.41m9.924 3.39h-3.574q-.418 0-.769.015t-.652.044v.271q0 1.436.659 2.22.666.783 1.875.783.534 0 1.055-.175.52-.184 1.106-.565l.285.47a6.2 6.2 0 0 1-1.509.93q-.747.315-1.479.314-1.421 0-2.344-1.01-.923-1.019-.923-2.608 0-1.692.967-2.842t2.359-1.15q1.296 0 2.065.865.77.864.879 2.439m-1.355-.768q-.22-.9-.667-1.377-.446-.484-1.069-.484-.704 0-1.208.564-.499.564-.652 1.524 1.45 0 2.278-.051.834-.052 1.318-.176m7.28-2.234q0 .447.044.9.052.455.139.916l-.556.088q-.088-.762-.484-1.135-.395-.374-1.106-.374-.615 0-1.01.337-.396.33-.396.842 0 .814 1.729 1.29l.461.124q.864.241 1.26.689.403.446.403 1.172 0 1.068-.843 1.765-.834.695-2.146.695a5 5 0 0 1-.974-.102 6 6 0 0 1-1.018-.308q.007-.073.007-.154.008-.08.008-.249 0-.336-.044-.725a10 10 0 0 0-.117-.835l.549-.131q.117.908.571 1.362.454.447 1.26.447.732 0 1.194-.352.468-.36.469-.923 0-.79-1.553-1.26l-.227-.073q-1.113-.336-1.568-.828-.446-.49-.446-1.303 0-.938.747-1.553.747-.623 1.911-.623.36 0 .777.074.425.073.959.227"/><path fill="#000" d="M36.135 174.138q.168.015.359.022h.586q.417 0 .769-.014.358-.015.688-.052a2.7 2.7 0 0 0 .806-.857q.27-.483.27-1.062 0-.93-.593-1.465-.593-.542-1.626-.542-.226 0-.527.03-.293.029-.666.088-.023.981-.044 2.277-.015 1.298-.022 1.575m.014 4.812q.426.125.835.191.41.058.799.058 1.2 0 1.86-.586.66-.585.66-1.633 0-1.114-.74-1.648-.74-.542-2.271-.542-.249 0-.505.007-.25 0-.652.022 0 .308-.008.909-.006.593-.007.871 0 .454.007.967zm-2.592.476.095.015h.146q.975 0 .99-2.739.006-.689.014-1.077l.03-2q.006-.644.006-1.252.008-.608.008-1.318 0-.63-.235-.872t-.835-.242h-.058v-.512q.468.036.915.051a28 28 0 0 0 2.176-.015q.746-.036.974-.036 1.509 0 2.38.674.879.666.879 1.801 0 .799-.432 1.385-.425.578-1.414 1.12 1.29.249 1.927.879.636.63.637 1.663 0 1.34-1.062 2.16t-2.835.821q-.322 0-1.208-.037-.887-.036-1.465-.037-.242 0-.674.015-.425.014-.96.044zm15.813-.586.205.462q-.55.395-1.004.608-.454.219-.732.219-.47 0-.703-.271-.235-.277-.257-.835-.798.535-1.325.769-.528.228-.945.228-.74 0-1.238-.557-.498-.556-.498-1.362 0-1.37 2.952-2.066.696-.161 1.084-.256 0-.125.007-.359a18 18 0 0 0 .022-.63q0-.761-.315-1.121-.315-.366-.96-.366-.63 0-.995.235-.36.226-.36.622 0 .037.008.103l.007.088q0 .227-.22.38a.93.93 0 0 1-.527.147q-.264 0-.388-.088-.125-.088-.125-.271 0-.586.99-1.304.988-.725 2.043-.725 1.018 0 1.545.564.528.557.528 1.641 0 .585-.074 1.802a37 37 0 0 0-.066 1.845q0 .477.103.645.11.168.38.168a1 1 0 0 0 .301-.066q.19-.072.557-.249m-2.498-2.475-.417.11q-2.38.651-2.38 1.538 0 .483.307.791.308.3.813.3.308 0 .71-.161.403-.161.938-.513zm4.988-5.039.483.146q-.043.403-.073.725-.022.315-.03.623h.52q.419 0 .85-.008.432-.013.872-.036l-.176.798a15 15 0 0 0-.886-.044 25 25 0 0 0-.82-.014h-.345l-.066 1.933q-.015.667-.014 1.106 0 1.656.227 2.161.227.498.813.498.242 0 .534-.103.3-.102.726-.337l.241.484a8 8 0 0 1-1.274.644q-.572.213-.996.213-.785 0-1.143-.535-.359-.542-.359-1.736 0-.234.03-1.67.036-1.443.036-2.644-.066 0-.19.008-.608.022-.835.022v-.528q.718-.102 1.186-.527.469-.432.689-1.179m9.17 7.133.366.557q-.71.542-1.399.82a3.5 3.5 0 0 1-1.304.279q-1.436 0-2.343-1.026-.909-1.032-.909-2.636 0-1.663 1.15-2.813t2.806-1.15q.85 0 1.31.242.462.234.462.659a.8.8 0 0 1-.19.535q-.184.22-.425.22-.081 0-.681-.367-.593-.373-1.136-.373-.952 0-1.516.688-.555.68-.556 1.861 0 1.487.673 2.321.681.828 1.883.828.447 0 .886-.154.447-.153.923-.491m3.362-9.88q-.03 1.23-.052 2.512t-.029 2.63q.82-.623 1.465-.916.645-.3 1.172-.3 1.077 0 1.618.608t.542 1.824l-.007.644q-.007.638-.007 1.274 0 .271-.008.682-.007.402-.007.549 0 .82.147 1.069.146.249.556.249l.08-.007a1 1 0 0 1 .103-.007v.512a52 52 0 0 0-1.003-.058 13 13 0 0 0-.557-.015q-.351 0-.761.022-.403.015-.843.051l-.007-.512h.11q.938 0 .96-1.714v-.147l.014-1.574v-.301q0-1.333-.315-1.765-.315-.44-1.084-.439-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.037 2.607q0 .22-.007.564-.007.345-.007.476 0 .909.146 1.179.147.271.564.271.03 0 .088-.007a1 1 0 0 1 .103-.007v.512a21 21 0 0 0-.872-.051 13 13 0 0 0-1.362-.007q-.374.015-.974.051v-.505q.043 0 .124.007t.117.007q.506 0 .681-.263.177-.272.176-1.56v-.542l.03-5.508v-1.26q0-.315-.14-.469-.131-.16-.402-.161-.103 0-.337.044a.4.4 0 0 1-.081.015l-.11-.476q.6-.118 1.18-.271.577-.162 1.157-.374"/><path stroke="#000" d="M134 68V49.5h229V68"/><path stroke="#000" d="M99.5 106.902h-17v135.5h17"/><path fill="#000" d="M329.398 313.137q.096.014.198.014h.308q1.553 0 2.439-.651.893-.653.893-1.773 0-1.004-.549-1.523-.549-.52-1.597-.52a7 7 0 0 0-.402.014q-.236.015-.528.044l-.491 2.747q-.175 1.032-.271 1.648m-3.09 4.38h.285q.454 0 .645-.257.198-.264.403-1.45l1.062-6.328q.021-.11.036-.205.015-.096.015-.154 0-.3-.205-.439-.198-.147-.608-.147h-.198l.095-.542q.462.043.843.066.38.022.688.022.477 0 1.267-.044.798-.044 1.114-.044 1.347 0 2.102.623.76.615.761 1.699 0 1.033-.659 1.816-.659.777-1.933 1.26l1.113 2.117q.043.095.139.285.93 1.817 1.985 1.817.036 0 .11-.008.08-.007.117-.007l-.088.491a8 8 0 0 1-.564.08q-.227.03-.395.03-.667 0-1.136-.242a1.96 1.96 0 0 1-.769-.754q-.212-.345-.791-1.575-.571-1.23-.923-1.948-.234.022-.476.036-.234.008-.483.008a8 8 0 0 1-.286-.008 7 7 0 0 0-.285-.007l-.418 2.761-.037.271a4 4 0 0 0-.007.183q0 .36.154.476.161.118.666.118h.169l-.095.483a45 45 0 0 1-.681-.029q-.858-.03-1.099-.03-.374 0-1.318.044-.257.007-.411.015zm11.55-2.82.073-.037q2.608-1.334 2.608-2.058a.93.93 0 0 0-.279-.674.88.88 0 0 0-.652-.285q-.578 0-1.04.798-.46.798-.71 2.256m2.204-.506-2.241 1.158v.073q0 .872.271 1.326.279.454.799.454.307 0 .769-.271.468-.279 1.194-.894l.256.462q-1.047.966-1.67 1.34-.615.373-1.121.373-.768 0-1.245-.666-.476-.666-.476-1.751 0-.768.249-1.648.257-.885.659-1.545.505-.805 1.158-1.245.651-.44 1.347-.44.71 0 1.187.455.483.446.483 1.091 0 .52-.293.864-.285.337-1.326.864m6.343 1.187.55-3.318a4 4 0 0 0-.718-.337 1.8 1.8 0 0 0-.586-.11q-.901 0-1.516 1.158-.615 1.149-.615 2.871 0 .695.161 1.054.168.36.49.359.22 0 .813-.447.601-.446 1.421-1.23m.015.747-1.245 1.128q-.549.498-.879.688-.323.19-.608.191-.659 0-1.011-.557-.351-.564-.351-1.618 0-2.08 1.047-3.575 1.054-1.494 2.505-1.494.293 0 .593.081.308.073.637.219l.418-2.651q.022-.153.029-.308.015-.16.015-.322 0-.292-.117-.403-.118-.11-.432-.109-.096 0-.198.007a3 3 0 0 0-.213.007l-.029-.432q.608-.059 1.223-.161.623-.102 1.253-.249-.681 3.515-1.121 6.35-.44 2.828-.439 3.435 0 .374.065.527a.245.245 0 0 0 .235.147.4.4 0 0 0 .205-.073 2 2 0 0 0 .308-.242l.446-.403.242.418-.842.827q-.44.425-.637.542a.75.75 0 0 1-.381.117q-.389 0-.572-.366-.175-.366-.175-1.135a5 5 0 0 1 .029-.586m10.071.645-1.011.944a2 2 0 0 1-.491.374.95.95 0 0 1-.439.11q-.33 0-.535-.315-.198-.323-.198-.857 0-.155.022-.366.03-.22.11-.681-1.355 1.384-1.919 1.801t-.959.418q-.418 0-.696-.388-.279-.388-.278-.997 0-.512.439-2.307.11-.425.161-.644.154-.608.227-.974.074-.374.074-.557a.35.35 0 0 0-.074-.234.22.22 0 0 0-.183-.096q-.073 0-.285.103a10 10 0 0 0-.586.315l-.205-.403q.681-.505 1.193-.784.513-.285.725-.285a.53.53 0 0 1 .469.256q.176.256.176.711 0 .57-.454 2.211-.447 1.642-.447 2.461 0 .256.088.381.088.117.271.117.206 0 .696-.402.498-.411 1.662-1.56.279-1.319.447-2.227.176-.915.271-1.633l1.319-.315-.162.725a91 91 0 0 0-.454 1.985l-.175.937q-.132.667-.213 1.275a8 8 0 0 0-.073.857q0 .168.066.263a.2.2 0 0 0 .176.095q.102 0 .38-.197.279-.198.638-.535zm5.302-4.593-.388.381q-.483-.49-.776-.652a1.2 1.2 0 0 0-.586-.161q-.674 0-1.172 1.004-.498.996-.498 2.46 0 .982.256 1.48.257.498.755.498.278 0 .762-.315a6.3 6.3 0 0 0 1.018-.879l.3.52q-.85.901-1.45 1.304-.601.395-1.099.395-.791 0-1.267-.688-.47-.688-.469-1.86 0-2.007 1.026-3.384 1.032-1.377 2.541-1.377.55 0 .938.234.395.234.395.535a.5.5 0 0 1-.066.234 1 1 0 0 1-.22.271m3.999-2.937q-.138.49-.388 1.538-.073.308-.11.454.433 0 .879-.007.454-.015.952-.037l-.175.733a12 12 0 0 0-.44-.007h-1.362q-.344 1.508-.513 2.636-.16 1.128-.161 1.89 0 .322.103.505.11.183.3.183.147 0 .461-.234t.857-.754l.257.468q-1.055 1.084-1.451 1.385-.395.293-.666.293-.506 0-.806-.476-.3-.477-.3-1.297 0-.534.168-1.531.169-1.003.638-3.105-.117 0-.308.007l-.249.008h-.505l.088-.491q.336-.015.615-.117.285-.103.571-.323.066-.263.147-.549.087-.292.197-.615zm4.842 7.097.256.433q-.9.93-1.252 1.186t-.623.256a.73.73 0 0 1-.622-.322q-.235-.33-.235-.879 0-.688.432-2.3.44-1.611.44-2.321 0-.183-.088-.293a.28.28 0 0 0-.227-.11.75.75 0 0 0-.308.095 4 4 0 0 0-.476.293l-.22-.388.975-.711q.277-.204.483-.293a.9.9 0 0 1 .388-.095q.345 0 .542.286.205.278.205.769 0 .534-.381 2.095l-.131.527a33 33 0 0 0-.315 1.37q-.103.541-.103.747 0 .183.081.3a.24.24 0 0 0 .205.117q.117 0 .307-.146.19-.147.667-.616m-.059-9.441.418.469q.175.183.241.33a.6.6 0 0 1 .074.285.47.47 0 0 1-.11.293 1.1 1.1 0 0 1-.308.264l-.644.359-.469-.557a1.4 1.4 0 0 1-.191-.285.6.6 0 0 1-.044-.227q0-.169.088-.293a.9.9 0 0 1 .301-.257zm4.592 4.732q-.849 0-1.464 1.164-.616 1.165-.616 2.872 0 .9.308 1.377.315.476.908.476.894 0 1.516-1.143.63-1.15.63-2.812 0-.99-.315-1.458-.315-.476-.967-.476m.315-.711q1.092 0 1.656.682.571.674.571 1.977 0 .747-.293 1.597a5.8 5.8 0 0 1-.791 1.523q-.534.734-1.216 1.128a2.8 2.8 0 0 1-1.421.388q-.98 0-1.567-.71-.579-.71-.579-1.904 0-.886.286-1.729.286-.842.82-1.523a4 4 0 0 1 1.194-1.055q.674-.374 1.34-.374m5.406 2.103 1.186-1.158q.623-.593.938-.783.322-.19.608-.191.483 0 .783.425.308.425.308 1.121 0 .71-.359 2.197-.359 1.479-.359 2.109 0 .19.073.293.073.096.213.095a.36.36 0 0 0 .161-.051 1 1 0 0 0 .198-.154l.556-.542.257.389-.799.813q-.285.293-.571.461-.278.168-.491.168a.72.72 0 0 1-.6-.315q-.227-.321-.227-.842 0-.623.373-2.19.374-1.575.374-2.292a.7.7 0 0 0-.117-.432.34.34 0 0 0-.301-.169q-.286 0-1.75 1.355-.389.358-.608.564l-.462 2.578-.043.22q-.154.783-.184 1.201l-1.303.322q.483-2.101.761-3.654.286-1.553.286-2.037 0-.292-.066-.417a.22.22 0 0 0-.212-.132q-.089 0-.293.103a6 6 0 0 0-.506.3l-.197-.388.234-.191q1.128-.908 1.509-.908.366 0 .542.279.176.27.176.849 0 .205-.022.462-.022.255-.066.542"/><path fill="#000" d="M386.354 296.854a.5.5 0 0 0 0-.708l-3.182-3.182a.502.502 0 0 0-.708.708l2.829 2.828-2.829 2.828a.502.502 0 0 0 .708.708zM150 296.5v.5h236v-1H150z"/><defs><clipPath id="clip0_249_8276-rmsnorm-01-svg"><rect width="275" height="183" x="111" y="79.902" fill="#fff" rx="2"/></clipPath></defs></svg>
<figcaption><b>Data Parallel RMSNorm</b> Ideally, we'd like to avoid communication between cores in our parallelization strategy. One way to achieve that is by assigning one batch-element to each core, thus guaranteeing that each reduction is done entirely within a single core. This is what's known as a "data-parallel" strategy, since we're simply parallelizing along a dimension that doesn't require communication. In this example, we have four rows and four cores, saturating our cores. </figcaption>
</figure>
RMSNorm can be implemented as:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># x: [batch_size, hidden_dim]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># weight: [hidden_dim]</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rms_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weight</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">rsqrt</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">*</span> <span class="n">weight</span>
</span></span></code></pre></div><p>The requirement for batch invariance is that the <b>reduction order for each element must be fixed regardless of the batch-size of the kernel.</b> Note that this doesn’t mean we must always use the same reduction strategy. For example, if we change the number of elements we’re reducing over, we can still be batch-invariant even if our reduction strategy changes.<label for="sn8" class="sidenote-number"></label><input type="checkbox" id="sn8" class="margin-toggle"/><span class="sidenote"><a href="https://github.com/Dao-AILab/quack/blob/main/media/2025-07-10-membound-sol.md">The Quack</a> blog post has some nice examples showing the hierarchy of various reduction strategies you can do (e.g. thread reduction, warp reduction, block reduction, cluster reduction).</span></p>
<p>Thus, we only break batch invariance when our batch-size affects the reduction strategy.</p>
<p>Let&rsquo;s look at the standard parallelism strategy for RMSNorm. Generally, parallel algorithms benefit from minimizing communication across cores. <label for="sn9" class="sidenote-number"></label><input type="checkbox" id="sn9" class="margin-toggle"/><span class="sidenote">For the purpose of this discussion you can assume that when we refer to “cores” we mean SMs. More specifically, the property here that’s important is that the # of threadblocks our kernel launches is greater than the # of SMs.</span> So, one strategy we can start with is to assign each batch element to one core, as seen in the above figure.</p>
<p>Increasing our batch size doesn&rsquo;t affect our reduction strategy; if a batch size of 200 provides sufficient parallelism to our kernel then a batch size of 2000 will <em>definitely</em> provide sufficient parallelism.</p>
<figure class="half-width">
<svg xmlns="http://www.w3.org/2000/svg" width="430" height="500" fill="none" viewBox="0 0 430 500"><path fill="#f5f5f5" d="M0 0h430v500H0z"/><path fill="#fff" d="M0 0h430v500H0z"/><g clip-path="url(#clip0_249_8276-rmsnorm-02-svg)"><path fill="#ef402c" d="M111 79.902h40v40h-40z"/><path fill="#ef402c" d="M152 79.902h40v40h-40z" opacity=".86"/><path fill="#ef402c" d="M193 79.902h40v40h-40z" opacity=".72"/><path fill="#ef402c" d="M234 79.902h40v40h-40z" opacity=".58"/><path fill="#ef402c" d="M275 79.902h40v40h-40z" opacity=".44"/><path fill="#ef402c" d="M316 79.902h40v40h-40z" opacity=".3"/><path fill="#f7a224" d="M111 120.902h40v40h-40z"/><path fill="#f7a224" d="M152 120.902h40v40h-40z" opacity=".86"/><path fill="#f7a224" d="M193 120.902h40v40h-40z" opacity=".72"/><path fill="#f7a224" d="M234 120.902h40v40h-40z" opacity=".58"/><path fill="#f7a224" d="M275 120.902h40v40h-40z" opacity=".44"/><path fill="#f7a224" d="M316 120.902h40v40h-40z" opacity=".3"/><path fill="#009de4" d="M111 161.902h40v40h-40z"/><path fill="#009de4" d="M152 161.902h40v40h-40z" opacity=".86"/><path fill="#009de4" d="M193 161.902h40v40h-40z" opacity=".72"/><path fill="#009de4" d="M234 161.902h40v40h-40z" opacity=".58"/><path fill="#009de4" d="M275 161.902h40v40h-40z" opacity=".44"/><path fill="#009de4" d="M316 161.902h40v40h-40z" opacity=".3"/><path fill="#6d274c" d="M111 202.902h40v40h-40z"/><path fill="#6d274c" d="M152 202.902h40v40h-40z" opacity=".86"/><path fill="#6d274c" d="M193 202.902h40v40h-40z" opacity=".72"/><path fill="#6d274c" d="M234 202.902h40v40h-40z" opacity=".58"/><path fill="#6d274c" d="M275 202.902h40v40h-40z" opacity=".44"/><path fill="#6d274c" d="M316 202.902h40v40h-40z" opacity=".3"/><path fill="#ef402c" d="M111 243.902h40v40h-40z"/><path fill="#ef402c" d="M152 243.902h40v40h-40z" opacity=".86"/><path fill="#ef402c" d="M193 243.902h40v40h-40z" opacity=".72"/><path fill="#ef402c" d="M234 243.902h40v40h-40z" opacity=".58"/><path fill="#ef402c" d="M275 243.902h40v40h-40z" opacity=".44"/><path fill="#ef402c" d="M316 243.902h40v40h-40z" opacity=".3"/><path fill="#f7a224" d="M111 284.902h40v40h-40z"/><path fill="#f7a224" d="M152 284.902h40v40h-40z" opacity=".86"/><path fill="#f7a224" d="M193 284.902h40v40h-40z" opacity=".72"/><path fill="#f7a224" d="M234 284.902h40v40h-40z" opacity=".58"/><path fill="#f7a224" d="M275 284.902h40v40h-40z" opacity=".44"/><path fill="#f7a224" d="M316 284.902h40v40h-40z" opacity=".3"/><path fill="#009de4" d="M111 325.902h40v40h-40z"/><path fill="#009de4" d="M152 325.902h40v40h-40z" opacity=".86"/><path fill="#009de4" d="M193 325.902h40v40h-40z" opacity=".72"/><path fill="#009de4" d="M234 325.902h40v40h-40z" opacity=".58"/><path fill="#009de4" d="M275 325.902h40v40h-40z" opacity=".44"/><path fill="#009de4" d="M316 325.902h40v40h-40z" opacity=".3"/><path fill="#6d274c" d="M111 366.902h40v40h-40z"/><path fill="#6d274c" d="M152 366.902h40v40h-40z" opacity=".86"/><path fill="#6d274c" d="M193 366.902h40v40h-40z" opacity=".72"/><path fill="#6d274c" d="M234 366.902h40v40h-40z" opacity=".58"/><path fill="#6d274c" d="M275 366.902h40v40h-40z" opacity=".44"/><path fill="#6d274c" d="M316 366.902h40v40h-40z" opacity=".3"/></g><path fill="#000" d="m205.557 37.524.11.015h.175q.587 0 .791-.381.213-.39.213-1.721 0-.22-.008-.784a71 71 0 0 1-.007-.93V31.73q0-.404.007-1.26.008-.864.008-1.319 0-.622-.242-.864-.234-.249-.828-.249h-.117v-.49l2.454.058q.945.015 1.596.015.71 0 1.531-.015.828-.022 1.846-.059 0 .506.029 1.07.037.556.103 1.267l-.506.058q-.05-.93-.52-1.252-.468-.322-2.094-.322-.571 0-1.78.029h-.044a278 278 0 0 1-.081 3.89h.242q.41 0 1.018.006.608.008.828.008 1.077 0 1.421-.198.351-.198.381-.732l.461.029q-.059.55-.081.908a11 11 0 0 0-.014 1.172q.014.3.036.674l-.483.036v-.124q0-.6-.359-.813-.358-.22-1.663-.22h-1.787v2.85q0 1.054.235 1.332.234.271.952.271h.286V38a43 43 0 0 0-2.146-.059q-.257 0-.784.015-.52.014-1.179.044zm14.487-3.618h-3.574q-.418 0-.769.014t-.652.044v.271q0 1.436.659 2.22.666.783 1.875.783.534 0 1.055-.175.52-.184 1.106-.565l.285.47q-.755.615-1.508.93-.748.315-1.48.314-1.421 0-2.344-1.01-.923-1.019-.923-2.608 0-1.692.967-2.842t2.359-1.15q1.296 0 2.065.865.77.864.879 2.439m-1.355-.77q-.22-.9-.667-1.376-.446-.484-1.069-.484-.703 0-1.208.564-.498.564-.652 1.524 1.45 0 2.278-.051.835-.052 1.318-.176m8.906 3.802.205.461q-.549.396-1.003.608-.454.22-.733.22-.468 0-.703-.27-.234-.28-.256-.836-.798.534-1.326.77-.526.226-.945.226-.74 0-1.237-.556-.498-.557-.498-1.363 0-1.37 2.951-2.065.696-.161 1.084-.257 0-.123.008-.358.022-.484.022-.63 0-.763-.315-1.12-.315-.367-.96-.367-.63 0-.996.234-.359.228-.359.623a1 1 0 0 0 .008.102q.006.06.007.088 0 .228-.22.381a.93.93 0 0 1-.527.147q-.264 0-.388-.088-.125-.089-.125-.271 0-.585.989-1.304.988-.725 2.043-.725 1.018 0 1.546.564.527.556.527 1.64 0 .587-.073 1.802-.066 1.216-.066 1.846 0 .476.102.645.111.168.381.168a1 1 0 0 0 .301-.066 8 8 0 0 0 .556-.249m-2.497-2.476-.418.11q-2.38.652-2.38 1.538 0 .484.307.791.308.3.813.3.308 0 .711-.16a5.5 5.5 0 0 0 .937-.513zm4.987-5.039.484.147q-.044.402-.073.725-.022.315-.03.622h.52q.418 0 .85-.007.432-.015.872-.037l-.176.799q-.47-.037-.886-.044-.41-.015-.821-.015h-.344l-.066 1.934q-.015.666-.015 1.106 0 1.655.227 2.16.228.498.813.498.243 0 .535-.102.3-.102.725-.337l.242.483a8 8 0 0 1-1.275.645q-.57.213-.996.212-.783 0-1.142-.534-.359-.543-.359-1.736 0-.234.029-1.67.037-1.443.037-2.644-.066 0-.191.007-.607.022-.835.022v-.527q.718-.103 1.187-.527.469-.433.688-1.18m5.787 1.172q-.052 1.435-.081 2.52a62 62 0 0 0-.029 1.494q0 1.567.322 2.095.322.52 1.106.52.389 0 .864-.19a6.7 6.7 0 0 0 1.084-.58q.023-1.126.029-1.86.015-.732.015-1.076v-.498q0-.923-.154-1.158-.153-.234-.593-.234-.073 0-.161.007-.08 0-.169.008l-.043-.47q.622-.043 1.223-.138.607-.096 1.186-.235-.043 1.253-.066 2.234a82 82 0 0 0-.022 1.714q0 .3-.007.754a42 42 0 0 0-.007.594q0 .681.117.893.117.213.439.213.073 0 .169-.015.102-.015.263-.059l.059.455-2.234.564-.029-1.092q-.791.6-1.392.88-.593.277-1.084.277-1.003 0-1.567-.578-.564-.579-.564-1.611 0-.264.022-1.107.007-.351.007-.549l.022-.82q0-.205.007-.52.008-.322.008-.44 0-.63-.11-.835-.103-.204-.388-.205-.088 0-.205.015l-.242.03-.051-.477q.527-.088 1.084-.212.563-.132 1.172-.308m8.877-.08q-.052.498-.081 1.01-.03.506-.044 1.077.593-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .66.227.241.22.241.6 0 .271-.161.47a.46.46 0 0 1-.366.19q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.015 1.905.021.724.058.922.066.374.279.513.22.14.739.14h.213V38q-.572-.044-1.018-.066a16 16 0 0 0-1.634 0q-.447.022-.937.066v-.513h.168q.535 0 .725-.256t.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.058 0-.124.007-.066 0-.22.022l-.088-.454q.52-.117 1.069-.293.55-.176 1.136-.41m9.924 3.39h-3.574q-.418 0-.769.015t-.652.044v.271q0 1.436.659 2.22.666.783 1.875.783.534 0 1.055-.175.52-.184 1.106-.565l.285.47a6.2 6.2 0 0 1-1.509.93q-.747.315-1.479.314-1.421 0-2.344-1.01-.923-1.019-.923-2.608 0-1.692.967-2.842t2.359-1.15q1.296 0 2.065.865.77.864.879 2.439m-1.355-.768q-.22-.9-.667-1.377-.446-.484-1.069-.484-.704 0-1.208.564-.499.564-.652 1.524 1.45 0 2.278-.051.835-.052 1.318-.176m7.28-2.234q0 .447.044.9.052.455.139.916l-.556.088q-.088-.762-.484-1.135-.395-.374-1.106-.374-.615 0-1.01.337-.396.33-.396.842 0 .814 1.729 1.29l.461.124q.864.241 1.26.689.403.446.403 1.172 0 1.068-.843 1.765-.834.695-2.146.695a5 5 0 0 1-.974-.102 6 6 0 0 1-1.018-.308q.007-.073.007-.154.008-.08.008-.249 0-.336-.044-.725a10 10 0 0 0-.117-.835l.549-.131q.117.908.571 1.362.454.447 1.26.447.732 0 1.194-.352.468-.36.469-.923 0-.79-1.553-1.26l-.227-.073q-1.113-.336-1.568-.828-.446-.49-.446-1.303 0-.938.747-1.553.747-.623 1.911-.623.36 0 .777.074.425.073.959.227"/><path fill="#000" d="M36.135 246.236q.168.015.359.022h.586q.417 0 .769-.015.358-.015.688-.051a2.7 2.7 0 0 0 .806-.857q.27-.483.27-1.062 0-.93-.593-1.465-.593-.542-1.626-.542-.226 0-.527.029-.293.03-.666.088-.023.982-.044 2.278-.015 1.296-.022 1.575m.014 4.812q.426.124.835.19.41.059.799.059 1.2 0 1.86-.586t.66-1.633q0-1.114-.74-1.648-.74-.543-2.271-.542-.249 0-.505.007-.25 0-.652.022 0 .308-.008.908-.006.594-.007.872 0 .454.007.967zm-2.592.476.095.015h.146q.975 0 .99-2.74.006-.689.014-1.076l.03-2q.006-.645.006-1.252.008-.609.008-1.319 0-.63-.235-.871-.234-.242-.835-.242h-.058v-.513q.468.037.915.052.454.014.916.014.512 0 1.26-.029.746-.036.974-.037 1.509 0 2.38.674.879.667.879 1.802 0 .799-.432 1.384-.425.58-1.414 1.121 1.29.249 1.927.879.636.63.637 1.662 0 1.34-1.062 2.161-1.062.82-2.835.82-.322 0-1.208-.036-.887-.037-1.465-.037-.242 0-.674.015a40 40 0 0 0-.96.044zm15.813-.586.205.461q-.55.396-1.004.608-.454.22-.732.22-.47 0-.703-.271-.235-.278-.257-.835-.798.535-1.325.769-.528.228-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.162 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.96-.366-.63 0-.995.234-.36.227-.36.623 0 .036.008.102l.007.088q0 .228-.22.381a.93.93 0 0 1-.527.147q-.264 0-.388-.088-.125-.088-.125-.271 0-.586.99-1.304.988-.725 2.043-.725 1.018 0 1.545.564.528.557.528 1.64 0 .587-.074 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.38.169a1 1 0 0 0 .301-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.38 1.538 0 .484.307.791.308.301.813.301.308 0 .71-.161.403-.162.938-.513zm4.988-5.039.483.147q-.043.402-.073.725-.022.315-.03.622h.52q.419 0 .85-.007.432-.015.872-.036l-.176.798a14 14 0 0 0-.886-.044q-.41-.015-.82-.015h-.345l-.066 1.934q-.015.666-.014 1.106 0 1.655.227 2.16.227.5.813.499.242 0 .534-.103.3-.103.726-.337l.241.483a8 8 0 0 1-1.274.645q-.572.212-.996.212-.785 0-1.143-.534-.359-.543-.359-1.736 0-.234.03-1.67.036-1.443.036-2.644-.066 0-.19.007-.608.022-.835.022v-.527q.718-.102 1.186-.527.469-.433.689-1.18m9.17 7.134.366.557q-.71.542-1.399.82a3.5 3.5 0 0 1-1.304.278q-1.436 0-2.343-1.025-.909-1.032-.909-2.637 0-1.662 1.15-2.812t2.806-1.15q.85 0 1.31.242.462.234.462.659a.8.8 0 0 1-.19.534q-.184.22-.425.22-.081 0-.681-.366-.593-.374-1.136-.374-.952 0-1.516.689-.555.681-.556 1.86 0 1.486.673 2.322.681.828 1.883.828.447 0 .886-.154.447-.154.923-.491m3.362-9.88q-.03 1.23-.052 2.512t-.029 2.629q.82-.622 1.465-.915.645-.3 1.172-.3 1.077 0 1.618.607.542.609.542 1.824l-.007.645q-.007.637-.007 1.274 0 .272-.008.681a36 36 0 0 0-.007.55q0 .82.147 1.069.146.249.556.249l.08-.007a1 1 0 0 1 .103-.008V252a54 54 0 0 0-1.003-.059 15 15 0 0 0-.557-.014q-.351 0-.761.022-.403.014-.843.051l-.007-.513h.11q.938 0 .96-1.714v-.146l.014-1.575v-.3q0-1.333-.315-1.765-.315-.44-1.084-.44-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.037 2.608q0 .219-.007.564a27 27 0 0 0-.007.476q0 .907.146 1.179.147.271.564.271.03 0 .088-.007a1 1 0 0 1 .103-.008V252a20 20 0 0 0-.872-.051 13 13 0 0 0-1.362-.008q-.374.015-.974.052v-.506q.043 0 .124.008.081.007.117.007.506 0 .681-.264.177-.27.176-1.56v-.542l.03-5.508v-1.259q0-.315-.14-.469-.131-.162-.402-.161-.103 0-.337.044l-.081.014-.11-.476q.6-.117 1.18-.271.577-.161 1.157-.373"/><path stroke="#000" d="M134 68V49.5h199V68"/><path stroke="#000" d="M99.5 107h-17v279.5h17"/><path fill="#000" d="M299.398 457.637q.096.014.198.014h.308q1.553 0 2.439-.651.893-.653.893-1.773 0-1.004-.549-1.523-.549-.52-1.597-.52a7 7 0 0 0-.402.014q-.236.015-.528.044l-.491 2.747q-.175 1.033-.271 1.648m-3.09 4.38h.285q.454 0 .645-.257.198-.264.403-1.45l1.062-6.328q.021-.11.036-.205.015-.096.015-.154 0-.3-.205-.439-.198-.147-.608-.147h-.198l.095-.542q.462.043.843.066.38.022.688.022.477 0 1.267-.044.798-.044 1.114-.044 1.347 0 2.102.623.76.615.761 1.699 0 1.032-.659 1.816-.659.777-1.933 1.26l1.113 2.117q.043.094.139.285.93 1.817 1.985 1.817.036 0 .11-.008.08-.007.117-.007l-.088.491a8 8 0 0 1-.564.08q-.227.03-.395.03-.667 0-1.136-.242a1.96 1.96 0 0 1-.769-.754q-.212-.345-.791-1.575-.571-1.23-.923-1.948-.234.022-.476.036-.234.008-.483.008a8 8 0 0 1-.286-.008 7 7 0 0 0-.285-.007l-.418 2.761-.037.271a4 4 0 0 0-.007.183q0 .36.154.476.161.118.666.118h.169l-.095.483a45 45 0 0 1-.681-.029q-.858-.03-1.099-.03-.374 0-1.318.044-.257.008-.411.015zm11.55-2.82.073-.037q2.608-1.334 2.608-2.058a.93.93 0 0 0-.279-.674.88.88 0 0 0-.652-.285q-.578 0-1.04.798-.46.798-.71 2.256m2.204-.506-2.241 1.158v.073q0 .871.271 1.326.279.454.799.454.307 0 .769-.271.468-.279 1.194-.894l.256.462q-1.047.966-1.67 1.34-.615.373-1.121.373-.768 0-1.245-.666-.476-.666-.476-1.751 0-.768.249-1.648.257-.885.659-1.545.505-.806 1.158-1.245.651-.44 1.347-.44.71 0 1.187.455.483.446.483 1.091 0 .52-.293.864-.285.337-1.326.864m6.343 1.187.55-3.318a4 4 0 0 0-.718-.337 1.8 1.8 0 0 0-.586-.11q-.901 0-1.516 1.158-.615 1.149-.615 2.871 0 .695.161 1.054.169.36.49.359.22 0 .813-.447.601-.446 1.421-1.23m.015.747-1.245 1.128q-.549.498-.879.688-.323.19-.608.191-.659 0-1.011-.557-.351-.564-.351-1.618 0-2.08 1.047-3.575 1.054-1.494 2.505-1.494.293 0 .593.081.308.074.637.219l.418-2.651q.022-.153.029-.308.015-.16.015-.322 0-.292-.117-.403-.118-.11-.432-.109-.096 0-.198.007a3 3 0 0 0-.213.007l-.029-.432q.608-.059 1.223-.161.623-.102 1.253-.249-.681 3.515-1.121 6.35-.44 2.828-.439 3.435 0 .374.065.527a.245.245 0 0 0 .235.147.4.4 0 0 0 .205-.073 2 2 0 0 0 .308-.242l.446-.403.242.418-.842.827q-.44.425-.637.542a.75.75 0 0 1-.381.117q-.389 0-.572-.366-.175-.366-.175-1.135a5 5 0 0 1 .029-.586m10.071.645-1.011.944a2 2 0 0 1-.491.374.95.95 0 0 1-.439.11q-.33 0-.535-.315-.198-.323-.198-.857 0-.155.022-.366.03-.22.11-.681-1.355 1.384-1.919 1.801t-.959.418q-.418 0-.696-.388-.279-.388-.278-.997 0-.512.439-2.307.11-.425.161-.644.154-.608.227-.974.074-.374.074-.557a.35.35 0 0 0-.074-.234.22.22 0 0 0-.183-.096q-.073 0-.285.103a10 10 0 0 0-.586.315l-.205-.403q.681-.505 1.193-.784.513-.285.725-.285a.53.53 0 0 1 .469.256q.176.257.176.711 0 .57-.454 2.211-.447 1.642-.447 2.461 0 .256.088.381.088.117.271.117.205 0 .696-.402.498-.411 1.662-1.56.279-1.319.447-2.227.176-.915.271-1.633l1.319-.315-.162.725a91 91 0 0 0-.454 1.985l-.175.937q-.132.667-.213 1.275a8 8 0 0 0-.073.857q0 .168.066.263a.2.2 0 0 0 .176.095q.102 0 .38-.197.279-.198.638-.535zm5.302-4.593-.388.381q-.483-.49-.776-.652a1.2 1.2 0 0 0-.586-.161q-.674 0-1.172 1.004-.498.996-.498 2.46 0 .982.256 1.48.257.498.755.498.278 0 .762-.315a6.3 6.3 0 0 0 1.018-.879l.3.52q-.85.901-1.45 1.304-.601.395-1.099.395-.791 0-1.267-.688-.47-.688-.469-1.86 0-2.007 1.026-3.384 1.032-1.377 2.541-1.377.55 0 .938.234.395.234.395.535a.5.5 0 0 1-.066.234 1 1 0 0 1-.22.271m3.999-2.937q-.138.49-.388 1.538-.073.308-.11.454.433 0 .879-.007.454-.015.952-.037l-.175.733a12 12 0 0 0-.44-.007h-1.362q-.344 1.508-.513 2.636-.16 1.128-.161 1.89 0 .322.103.505.11.183.3.183.147 0 .461-.234t.857-.754l.257.468q-1.055 1.084-1.451 1.385-.394.293-.666.293-.506 0-.806-.476-.3-.477-.3-1.297 0-.534.168-1.531.169-1.003.638-3.105-.117 0-.308.007l-.249.008h-.505l.088-.491q.336-.015.615-.117.285-.103.571-.323.066-.263.147-.549.087-.293.197-.615zm4.842 7.097.256.433q-.9.93-1.252 1.186t-.623.256a.73.73 0 0 1-.622-.322q-.235-.33-.235-.879 0-.688.432-2.3.44-1.611.44-2.321 0-.183-.088-.293a.28.28 0 0 0-.227-.11.75.75 0 0 0-.308.095 4 4 0 0 0-.476.293l-.22-.388.975-.711q.277-.204.483-.293a.9.9 0 0 1 .388-.095q.345 0 .542.286.205.278.205.769 0 .534-.381 2.095l-.131.527a33 33 0 0 0-.315 1.37q-.103.541-.103.747 0 .183.081.3a.24.24 0 0 0 .205.117q.117 0 .307-.146.19-.147.667-.616m-.059-9.441.418.469q.175.183.241.33a.6.6 0 0 1 .074.285.47.47 0 0 1-.11.293 1.1 1.1 0 0 1-.308.264l-.644.359-.469-.557a1.4 1.4 0 0 1-.191-.285.6.6 0 0 1-.044-.227q0-.169.088-.293a.9.9 0 0 1 .301-.257zm4.592 4.732q-.849 0-1.464 1.164-.616 1.165-.616 2.872 0 .9.308 1.377.315.476.908.476.894 0 1.516-1.143.63-1.15.63-2.812 0-.99-.315-1.458-.315-.476-.967-.476m.315-.711q1.092 0 1.656.682.571.674.571 1.977 0 .747-.293 1.597a5.8 5.8 0 0 1-.791 1.523q-.534.733-1.216 1.128a2.8 2.8 0 0 1-1.421.388q-.98 0-1.567-.71-.579-.71-.579-1.904 0-.886.286-1.729.286-.842.82-1.523a4 4 0 0 1 1.194-1.055q.674-.374 1.34-.374m5.406 2.103 1.186-1.158q.623-.593.938-.783.322-.19.608-.191.483 0 .783.425.308.425.308 1.121 0 .71-.359 2.197-.359 1.479-.359 2.109 0 .19.073.293.073.096.213.095a.36.36 0 0 0 .161-.051 1 1 0 0 0 .198-.154l.556-.542.257.389-.799.813q-.285.293-.571.461-.278.168-.491.168a.72.72 0 0 1-.6-.315q-.227-.321-.227-.842 0-.623.373-2.19.374-1.575.374-2.292a.7.7 0 0 0-.117-.432.34.34 0 0 0-.301-.169q-.286 0-1.75 1.355-.389.358-.608.564l-.462 2.578-.043.22q-.154.783-.184 1.201l-1.303.322q.483-2.101.761-3.654.286-1.553.286-2.037 0-.292-.066-.417a.22.22 0 0 0-.212-.132q-.089 0-.293.103a6 6 0 0 0-.506.3l-.197-.388.234-.191q1.128-.908 1.509-.908.366 0 .542.279.176.27.176.849 0 .205-.022.462-.022.255-.066.542"/><path fill="#000" d="M356.354 441.354a.5.5 0 0 0 0-.708l-3.182-3.182a.502.502 0 0 0-.708.708l2.829 2.828-2.829 2.828a.502.502 0 0 0 .708.708zM120 441v.5h236v-1H120z"/><defs><clipPath id="clip0_249_8276-rmsnorm-02-svg"><rect width="245" height="327" x="111" y="79.902" fill="#fff" rx="2"/></clipPath></defs></svg>
<figcaption><b>Data Parallel RMSNorm for larger batches</b> Extending the data-parallel strategy to larger batches is fairly straightforward --- instead of having each core handle one row you allow each core to handle different rows sequentially. This <i>preserves batch invariance</i> as the reduction strategy for each batch element remains identical. </figcaption>
</figure>
<p>On the other hand, decreasing the batch size can pose challenges. Because we assign each batch element to one core, decreasing our batch size will eventually lead to having more cores than batch elements, leaving some cores idle.</p>
<p>Upon encountering this situation, a good kernel engineer would reach for one of the solutions mentioned in the prior section (atomic adds or split reductions), maintaining good parallelism and thus, good performance. Unfortunately, this changes the reduction strategy, preventing this kernel from being batch-invariant.</p>
<figure class="half-width">
<svg xmlns="http://www.w3.org/2000/svg" width="480" height="269" fill="none" viewBox="0 0 480 269"><path fill="#f5f5f5" d="M0 0h480v269H0z"/><path fill="#fff" d="M0 0h480v269H0z"/><g clip-path="url(#clip0_249_8276-rmsnorm-03-svg)"><path fill="#ef402c" d="M122 82a2 2 0 0 1 2-2h43v45h-45z"/><path fill="#ef402c" d="M168 80h45v45h-45z" opacity=".65"/><path fill="#ef402c" d="M214 80h45v45h-45z" opacity=".3"/><path fill="#6d274c" d="M260 80h45v45h-45z"/><path fill="#6d274c" d="M306 80h45v45h-45z" opacity=".65"/><path fill="#6d274c" d="M352 80h43a2 2 0 0 1 2 2v43h-45z" opacity=".3"/><path fill="#009de4" d="M122 126h45v45h-45z"/><path fill="#009de4" d="M168 126h45v45h-45z" opacity=".65"/><path fill="#009de4" d="M214 126h45v45h-45z" opacity=".3"/><path fill="#f7a224" d="M260 126h45v45h-45z"/><path fill="#f7a224" d="M306 126h45v45h-45z" opacity=".65"/><path fill="#f7a224" d="M352 126h45v45h-45z" opacity=".3"/></g><path fill="#000" d="m231.557 37.524.11.015h.175q.587 0 .791-.381.213-.39.213-1.721 0-.22-.008-.784a71 71 0 0 1-.007-.93V31.73q0-.404.007-1.26.008-.864.008-1.319 0-.622-.242-.864-.234-.249-.828-.249h-.117v-.49l2.454.058q.945.015 1.596.015.71 0 1.531-.015.828-.022 1.846-.059 0 .506.029 1.07.037.556.103 1.267l-.506.058q-.05-.93-.52-1.252-.468-.322-2.094-.322-.571 0-1.78.029h-.044a278 278 0 0 1-.081 3.89h.242q.41 0 1.018.006.608.008.828.008 1.077 0 1.421-.198.351-.198.381-.732l.461.029q-.059.55-.081.908a11 11 0 0 0-.014 1.172q.014.3.036.674l-.483.036v-.124q0-.6-.359-.813-.358-.22-1.663-.22h-1.787v2.85q0 1.054.235 1.332.234.271.952.271h.286V38a43 43 0 0 0-2.146-.059q-.257 0-.784.015-.52.014-1.179.044zm14.487-3.618h-3.574q-.418 0-.769.014t-.652.044v.271q0 1.436.659 2.22.666.783 1.875.783.534 0 1.055-.175.52-.184 1.106-.565l.285.47q-.755.615-1.508.93-.748.315-1.48.314-1.421 0-2.344-1.01-.923-1.019-.923-2.608 0-1.692.967-2.842t2.359-1.15q1.296 0 2.065.865.77.864.879 2.439m-1.355-.77q-.22-.9-.667-1.376-.446-.484-1.069-.484-.703 0-1.208.564-.498.564-.652 1.524 1.45 0 2.278-.051.835-.052 1.318-.176m8.906 3.802.205.461q-.549.396-1.003.608-.454.22-.733.22-.468 0-.703-.27-.234-.28-.256-.836-.798.534-1.326.77-.526.226-.945.226-.74 0-1.237-.556-.498-.557-.498-1.363 0-1.37 2.951-2.065.696-.161 1.084-.257 0-.123.008-.358.022-.484.022-.63 0-.763-.315-1.12-.315-.367-.96-.367-.63 0-.996.234-.359.228-.359.623a1 1 0 0 0 .008.102q.006.06.007.088 0 .228-.22.381a.93.93 0 0 1-.527.147q-.264 0-.388-.088-.125-.089-.125-.271 0-.585.989-1.304.988-.725 2.043-.725 1.018 0 1.546.564.527.556.527 1.64 0 .587-.073 1.802-.066 1.216-.066 1.846 0 .476.102.645.111.168.381.168a1 1 0 0 0 .301-.066 8 8 0 0 0 .556-.249m-2.497-2.476-.418.11q-2.38.652-2.38 1.538 0 .484.307.791.308.3.813.3.308 0 .711-.16a5.5 5.5 0 0 0 .937-.513zm4.987-5.039.484.147q-.044.402-.073.725-.022.315-.03.622h.52q.418 0 .85-.007.432-.015.872-.037l-.176.799q-.47-.037-.886-.044-.41-.015-.821-.015h-.344l-.066 1.934q-.015.666-.015 1.106 0 1.655.227 2.16.228.498.813.498.243 0 .535-.102.3-.102.725-.337l.242.483a8 8 0 0 1-1.275.645q-.57.213-.996.212-.783 0-1.142-.534-.359-.543-.359-1.736 0-.234.029-1.67.037-1.443.037-2.644-.066 0-.191.007-.607.022-.835.022v-.527q.718-.103 1.187-.527.469-.433.688-1.18m5.787 1.172q-.052 1.435-.081 2.52a62 62 0 0 0-.029 1.494q0 1.567.322 2.095.322.52 1.106.52.388 0 .864-.19a6.7 6.7 0 0 0 1.084-.58q.023-1.126.029-1.86.015-.732.015-1.076v-.498q0-.923-.154-1.158-.153-.234-.593-.234-.073 0-.161.007-.08 0-.169.008l-.043-.47q.622-.043 1.223-.138.607-.096 1.186-.235-.043 1.253-.066 2.234a82 82 0 0 0-.022 1.714q0 .3-.007.754a42 42 0 0 0-.007.594q0 .681.117.893.117.213.439.213.073 0 .169-.015.102-.015.263-.059l.059.455-2.234.564-.029-1.092q-.791.6-1.392.88-.593.277-1.084.277-1.003 0-1.567-.578-.564-.579-.564-1.611 0-.264.022-1.107.007-.351.007-.549l.022-.82q0-.205.007-.52.008-.322.008-.44 0-.63-.11-.835-.102-.204-.388-.205-.088 0-.205.015l-.242.03-.051-.477q.527-.088 1.084-.212.563-.132 1.172-.308m8.877-.08q-.052.498-.081 1.01-.03.506-.044 1.077.594-1.047 1.091-1.509.506-.46 1.04-.461.418 0 .66.227.241.22.241.6 0 .271-.161.47a.46.46 0 0 1-.366.19q-.132 0-.41-.14-.271-.146-.469-.146-.381 0-.762.337-.381.33-.798 1.033v.805q0 1.172.015 1.905.022.724.058.922.066.374.279.513.22.14.739.14h.213V38q-.572-.044-1.018-.066a16 16 0 0 0-1.634 0q-.447.022-.937.066v-.513h.168q.535 0 .725-.256t.191-1.194v-3.149q0-.792-.11-1.018-.11-.228-.403-.227-.058 0-.124.007-.066 0-.22.022l-.088-.454q.52-.117 1.069-.293.55-.176 1.136-.41m9.924 3.39h-3.574q-.418 0-.769.015t-.652.044v.271q0 1.436.659 2.22.666.783 1.875.783.534 0 1.055-.175.52-.184 1.106-.565l.285.47a6.2 6.2 0 0 1-1.509.93q-.747.315-1.479.314-1.421 0-2.344-1.01-.923-1.019-.923-2.608 0-1.692.967-2.842t2.359-1.15q1.296 0 2.065.865.77.864.879 2.439m-1.355-.768q-.22-.9-.667-1.377-.446-.484-1.069-.484-.704 0-1.208.564-.499.564-.652 1.524 1.45 0 2.278-.051.834-.052 1.318-.176m7.28-2.234q0 .447.044.9.052.455.139.916l-.556.088q-.088-.762-.484-1.135-.395-.374-1.106-.374-.615 0-1.01.337-.396.33-.396.842 0 .814 1.729 1.29l.461.124q.864.241 1.26.689.403.446.403 1.172 0 1.068-.843 1.765-.834.695-2.146.695a5 5 0 0 1-.974-.102 6 6 0 0 1-1.018-.308q.007-.073.007-.154.008-.08.008-.249 0-.336-.044-.725a10 10 0 0 0-.117-.835l.549-.131q.117.908.571 1.362.454.447 1.26.447.732 0 1.194-.352.468-.36.469-.923 0-.79-1.553-1.26l-.227-.073q-1.113-.336-1.568-.828-.446-.49-.446-1.303 0-.938.747-1.553.747-.623 1.911-.623.36 0 .777.074.425.073.959.227"/><path stroke="#000" d="M145 68V49.5h229V68"/><path fill="#000" d="M47.135 124.236q.168.015.359.022h.586q.417 0 .769-.015.358-.015.688-.051a2.7 2.7 0 0 0 .806-.857q.27-.483.27-1.062 0-.93-.593-1.465-.593-.542-1.626-.542-.226 0-.527.029-.293.03-.666.088-.023.982-.044 2.278-.015 1.296-.022 1.575m.014 4.812q.426.124.835.19.41.059.799.059 1.2 0 1.86-.586t.66-1.633q0-1.114-.74-1.648-.74-.542-2.271-.542-.249 0-.505.007-.25 0-.652.022 0 .308-.008.908-.006.594-.007.872 0 .454.007.967zm-2.592.476.095.015h.146q.975 0 .99-2.74.006-.689.014-1.076l.03-2q.006-.645.006-1.252.008-.608.008-1.319 0-.63-.235-.871-.234-.242-.835-.242h-.058v-.513q.468.037.915.052.454.014.916.014.512 0 1.26-.029.746-.037.974-.037 1.509 0 2.38.674.879.667.879 1.802 0 .799-.432 1.384-.425.58-1.414 1.121 1.29.249 1.927.879.636.63.637 1.662 0 1.34-1.062 2.161-1.062.82-2.835.82-.322 0-1.208-.036-.887-.037-1.465-.037-.242 0-.674.015a40 40 0 0 0-.96.044zm15.813-.586.205.461q-.55.396-1.004.608-.454.22-.732.22-.47 0-.703-.271-.235-.278-.257-.835-.798.535-1.325.769-.528.228-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.161 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.96-.366-.63 0-.995.234-.36.227-.36.623 0 .036.008.102l.007.088q0 .228-.22.381a.93.93 0 0 1-.527.147q-.264 0-.388-.088-.125-.088-.125-.271 0-.586.99-1.304.988-.725 2.043-.725 1.018 0 1.545.564.528.557.528 1.64 0 .587-.074 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.38.169a1 1 0 0 0 .301-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.38 1.538 0 .484.307.791.308.301.813.301.308 0 .71-.161.403-.162.938-.513zm4.988-5.039.483.147q-.043.402-.073.725-.022.315-.03.622h.52q.419 0 .85-.007.432-.015.872-.036l-.176.798a14 14 0 0 0-.886-.044q-.41-.015-.82-.015h-.345l-.066 1.934q-.015.666-.014 1.106 0 1.655.227 2.16.227.5.813.499.242 0 .534-.103.3-.103.726-.337l.241.483a8 8 0 0 1-1.274.645q-.572.212-.996.212-.785 0-1.143-.534-.359-.543-.359-1.736 0-.234.03-1.67.036-1.443.036-2.644-.066 0-.19.007-.608.022-.835.022v-.527q.718-.102 1.186-.527.469-.433.689-1.18m9.17 7.134.366.557q-.71.542-1.399.82a3.5 3.5 0 0 1-1.304.278q-1.435 0-2.343-1.025-.909-1.032-.909-2.637 0-1.663 1.15-2.812 1.15-1.15 2.806-1.15.85 0 1.31.242.462.234.462.659a.8.8 0 0 1-.19.534q-.184.22-.425.22-.081 0-.681-.366-.594-.374-1.136-.374-.951 0-1.516.689-.556.681-.556 1.86 0 1.486.673 2.322.682.828 1.883.828.447 0 .886-.154.447-.154.923-.491m3.362-9.88q-.03 1.23-.052 2.512-.021 1.281-.029 2.629.82-.623 1.465-.915.645-.3 1.172-.3 1.077 0 1.618.607.542.609.542 1.824l-.007.645q-.007.637-.007 1.274 0 .272-.008.681a36 36 0 0 0-.007.55q0 .82.147 1.069.146.249.556.249l.08-.007a1 1 0 0 1 .103-.008V130a54 54 0 0 0-1.003-.059 15 15 0 0 0-.557-.014q-.351 0-.761.022-.403.014-.843.051l-.007-.513h.11q.938 0 .96-1.714v-.146l.014-1.575v-.3q0-1.333-.315-1.765-.315-.44-1.084-.44-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.037 2.608q0 .219-.007.564a27 27 0 0 0-.007.476q0 .907.146 1.179.147.271.564.271.03 0 .088-.007a1 1 0 0 1 .103-.008V130a20 20 0 0 0-.872-.051 13 13 0 0 0-1.362-.008q-.374.015-.974.052v-.506q.043 0 .124.008.081.007.117.007.505 0 .681-.264.177-.27.176-1.56v-.542l.03-5.508v-1.259q0-.316-.14-.469-.132-.162-.403-.161-.102 0-.336.044l-.081.014-.11-.476q.6-.117 1.18-.271.577-.161 1.157-.373"/><path stroke="#000" d="M105.5 99h-17v52.5h17"/><path fill="#000" d="M340.398 227.637q.096.014.198.014h.308q1.553 0 2.439-.651.893-.653.893-1.773 0-1.004-.549-1.523-.549-.52-1.597-.52a7 7 0 0 0-.402.014q-.236.015-.528.044l-.491 2.747q-.175 1.032-.271 1.648m-3.09 4.38h.285q.454 0 .645-.257.198-.264.403-1.45l1.062-6.328q.021-.11.036-.205.015-.096.015-.154 0-.3-.205-.439-.198-.147-.608-.147h-.198l.095-.542q.462.043.843.066.38.022.688.022.477 0 1.267-.044.798-.044 1.114-.044 1.347 0 2.102.623.76.615.761 1.699 0 1.032-.659 1.816-.659.777-1.933 1.26l1.113 2.117q.043.094.139.285.93 1.817 1.985 1.817.036 0 .11-.008.08-.006.117-.007l-.088.491a8 8 0 0 1-.564.08q-.227.03-.395.03-.667 0-1.136-.242a1.96 1.96 0 0 1-.769-.754q-.212-.345-.791-1.575-.571-1.23-.923-1.948-.234.022-.476.036-.234.008-.483.008a8 8 0 0 1-.286-.008 7 7 0 0 0-.285-.007l-.418 2.761-.037.271a4 4 0 0 0-.007.183q0 .36.154.476.161.118.666.118h.169l-.095.483a45 45 0 0 1-.681-.029q-.858-.03-1.099-.03-.374 0-1.318.044-.257.007-.411.015zm11.55-2.82.073-.037q2.608-1.333 2.608-2.058a.93.93 0 0 0-.279-.674.88.88 0 0 0-.652-.285q-.578 0-1.04.798-.46.798-.71 2.256m2.204-.506-2.241 1.158v.073q0 .871.271 1.326.279.454.799.454.307 0 .769-.271.468-.279 1.194-.894l.256.462q-1.047.966-1.67 1.34-.615.373-1.121.373-.768 0-1.245-.666-.476-.666-.476-1.751 0-.768.249-1.648.257-.885.659-1.545.505-.805 1.158-1.245.651-.44 1.347-.44.71 0 1.187.455.483.446.483 1.091 0 .52-.293.864-.285.337-1.326.864m6.343 1.187.55-3.318a4 4 0 0 0-.718-.337 1.8 1.8 0 0 0-.586-.11q-.901 0-1.516 1.158-.615 1.149-.615 2.871 0 .695.161 1.054.168.36.49.359.22 0 .813-.447.601-.446 1.421-1.23m.015.747-1.245 1.128q-.549.498-.879.688-.323.19-.608.191-.659 0-1.011-.557-.351-.564-.351-1.618 0-2.08 1.047-3.575 1.054-1.494 2.505-1.494.293 0 .593.081.308.074.637.219l.418-2.651q.022-.153.029-.308.015-.16.015-.322 0-.292-.117-.403-.118-.11-.432-.109-.096 0-.198.007a3 3 0 0 0-.213.007l-.029-.432q.608-.059 1.223-.161.623-.102 1.253-.249-.681 3.515-1.121 6.35-.44 2.827-.439 3.435 0 .374.065.527a.245.245 0 0 0 .235.147.4.4 0 0 0 .205-.073 2 2 0 0 0 .308-.242l.446-.403.242.418-.842.827q-.44.425-.637.542a.75.75 0 0 1-.381.117q-.389 0-.572-.366-.175-.366-.175-1.135a5 5 0 0 1 .029-.586m10.071.645-1.011.944a2 2 0 0 1-.491.374.95.95 0 0 1-.439.11q-.33 0-.535-.315-.198-.323-.198-.857 0-.154.022-.366.03-.22.11-.681-1.355 1.383-1.919 1.801t-.959.418q-.418 0-.696-.388-.279-.388-.278-.997 0-.512.439-2.307.11-.425.161-.644.154-.608.227-.974.074-.374.074-.557a.35.35 0 0 0-.074-.234.22.22 0 0 0-.183-.096q-.073 0-.285.103a10 10 0 0 0-.586.315l-.205-.403q.681-.505 1.193-.784.513-.285.725-.285a.53.53 0 0 1 .469.256q.176.256.176.711 0 .57-.454 2.211-.447 1.641-.447 2.461 0 .256.088.381.088.117.271.117.206 0 .696-.402.498-.411 1.662-1.56.279-1.319.447-2.227.176-.915.271-1.633l1.319-.315-.162.725a91 91 0 0 0-.454 1.985l-.175.937q-.132.667-.213 1.275a8 8 0 0 0-.073.857q0 .168.066.263a.2.2 0 0 0 .176.095q.102 0 .38-.197.279-.198.638-.535zm5.302-4.593-.388.381q-.483-.49-.776-.652a1.2 1.2 0 0 0-.586-.161q-.674 0-1.172 1.004-.498.996-.498 2.46 0 .982.256 1.48.257.498.755.498.278 0 .762-.315a6.3 6.3 0 0 0 1.018-.879l.3.52q-.85.901-1.45 1.304-.601.396-1.099.395-.791 0-1.267-.688-.47-.689-.469-1.86 0-2.007 1.026-3.384 1.032-1.377 2.541-1.377.55 0 .938.234.395.235.395.535a.5.5 0 0 1-.066.234 1 1 0 0 1-.22.271m3.999-2.937q-.138.49-.388 1.538-.073.308-.11.454.433 0 .879-.007.454-.015.952-.037l-.175.733a12 12 0 0 0-.44-.007h-1.362q-.344 1.508-.513 2.636-.16 1.128-.161 1.89 0 .322.103.505.11.183.3.183.147 0 .461-.234t.857-.754l.257.468q-1.055 1.084-1.451 1.385-.395.293-.666.293-.506 0-.806-.476-.3-.477-.3-1.297 0-.534.168-1.531.169-1.004.638-3.105-.117 0-.308.007l-.249.008h-.505l.088-.491q.336-.015.615-.117.285-.103.571-.323.066-.263.147-.549.087-.292.197-.615zm4.842 7.097.256.433q-.9.93-1.252 1.186t-.623.256a.73.73 0 0 1-.622-.322q-.235-.33-.235-.879 0-.688.432-2.3.44-1.611.44-2.321 0-.183-.088-.293a.28.28 0 0 0-.227-.11.75.75 0 0 0-.308.095 4 4 0 0 0-.476.293l-.22-.388.975-.711q.277-.204.483-.293a.9.9 0 0 1 .388-.095q.345 0 .542.286.205.278.205.769 0 .535-.381 2.095l-.131.527a33 33 0 0 0-.315 1.37q-.103.541-.103.747 0 .183.081.3a.24.24 0 0 0 .205.117q.117 0 .307-.146.19-.147.667-.616m-.059-9.441.418.469q.175.183.241.33a.6.6 0 0 1 .074.285.47.47 0 0 1-.11.293 1.1 1.1 0 0 1-.308.264l-.644.359-.469-.557a1.4 1.4 0 0 1-.191-.285.6.6 0 0 1-.044-.227q0-.169.088-.293a.9.9 0 0 1 .301-.257zm4.592 4.732q-.849 0-1.464 1.164-.616 1.165-.616 2.872 0 .9.308 1.377.315.476.908.476.894 0 1.516-1.143.63-1.15.63-2.812 0-.99-.315-1.458-.315-.476-.967-.476m.315-.711q1.092 0 1.656.682.571.673.571 1.977 0 .747-.293 1.597a5.8 5.8 0 0 1-.791 1.523q-.534.734-1.216 1.128a2.8 2.8 0 0 1-1.421.388q-.98 0-1.567-.71-.579-.71-.579-1.904 0-.886.286-1.729.286-.842.82-1.523a4 4 0 0 1 1.194-1.055q.674-.374 1.34-.374m5.406 2.103 1.186-1.158q.623-.593.938-.783.322-.19.608-.191.483 0 .783.425.308.425.308 1.121 0 .71-.359 2.197-.359 1.479-.359 2.109 0 .19.073.293.073.095.213.095a.36.36 0 0 0 .161-.051 1 1 0 0 0 .198-.154l.556-.542.257.389-.799.813q-.285.293-.571.461-.278.168-.491.168a.72.72 0 0 1-.6-.315q-.227-.321-.227-.842 0-.623.373-2.19.374-1.575.374-2.292a.7.7 0 0 0-.117-.432.34.34 0 0 0-.301-.169q-.286 0-1.75 1.355-.389.358-.608.564l-.462 2.578-.043.22q-.154.784-.184 1.201l-1.303.322q.483-2.101.761-3.654.286-1.553.286-2.037 0-.292-.066-.417a.22.22 0 0 0-.212-.132q-.089 0-.293.103a6 6 0 0 0-.506.3l-.197-.388.234-.191q1.128-.908 1.509-.908.366 0 .542.279.176.27.176.849 0 .206-.022.462-.022.255-.066.542"/><path fill="#000" d="M397.354 211.354a.5.5 0 0 0 0-.708l-3.182-3.182a.502.502 0 0 0-.708.708l2.829 2.828-2.829 2.828a.502.502 0 0 0 .708.708zM161 211v.5h236v-1H161z"/><defs><clipPath id="clip0_249_8276-rmsnorm-03-svg"><rect width="275" height="91" x="122" y="80" fill="#fff" rx="2"/></clipPath></defs></svg>
<figcaption><b>Split-Reduction RMSNorm</b> If we have a small batch size, our data-parallel strategy may no longer have sufficient parallelism to saturate our cores. In this case, it may be more efficient to "split" a reduction among multiple cores, allowing us to fully utilize our GPU. However, this <i>loses</i> batch invariance, as we are no longer reducing each element in the same order.</figcaption>
</figure>
<p>The easiest solution is to simply ignore these cases altogether. This is not completely <em>unreasonable</em> &mdash; a small batch size means that the kernel is likely to execute quickly anyways, and so a slowdown may not be catastrophic.</p>
<p>If we <em>were</em> compelled to optimize this use case, one approach would be to consistently use a reduction strategy that has enough parallelism even for very small batch sizes. Such a reduction strategy would lead to an excess amount of parallelism for larger batch sizes but would allow us to achieve decent (but not peak) performance across the entire range of sizes.</p>
<h3 id="batch-invariant-matrix-multiplication">Batch-invariant matrix multiplication</h3>
<figure class="half-width matmul">
<svg xmlns="http://www.w3.org/2000/svg" width="537" height="458" fill="none" viewBox="0 0 537 458"><path fill="#f5f5f5" d="M0 0h537v458H0z"/><path fill="#fff" d="M0 0h537v458H0z"/><g fill="#dfe2e7" clip-path="url(#clip0_249_8276-matmul-01-svg)"><path d="M145 236h35v35h-35z"/><path d="M181 236h35v35h-35z" opacity=".8"/><path d="M217 236h35v35h-35z" opacity=".6"/><path d="M253 236h35v35h-35z" opacity=".4"/><path d="M145 272h35v35h-35z"/><path d="M181 272h35v35h-35z" opacity=".8"/><path d="M217 272h35v35h-35z" opacity=".6"/><path d="M253 272h35v35h-35z" opacity=".4"/><path d="M145 308h35v35h-35z"/><path d="M181 308h35v35h-35z" opacity=".8"/><path d="M217 308h35v35h-35z" opacity=".6"/><path d="M253 308h35v35h-35z" opacity=".4"/><path d="M145 344h35v35h-35z"/><path d="M181 344h35v35h-35z" opacity=".8"/><path d="M217 344h35v35h-35z" opacity=".6"/><path d="M253 344h35v35h-35z" opacity=".4"/></g><g clip-path="url(#clip1_249_8276-matmul-01-svg)"><path fill="#3870fc" d="M318 238a2 2 0 0 1 2-2h33v35h-35z"/><path fill="#f63236" d="M354 236h35v35h-35z"/><path fill="#f360a5" d="M390 236h35v35h-35z"/><path fill="#ffa8aa" d="M426 236h35v35h-35z"/><path fill="#160e8a" d="M318 272h35v35h-35z"/><path fill="#856ad1" d="M354 272h35v35h-35z"/><path fill="#c35980" d="M390 272h35v35h-35z"/><path fill="#ea3b40" d="M426 272h35v35h-35z"/><path fill="#3870fc" d="M318 310a2 2 0 0 1 2-2h33v35h-35z"/><path fill="#f63236" d="M354 308h35v35h-35z"/><path fill="#f360a5" d="M390 308h35v35h-35z"/><path fill="#ffa8aa" d="M426 308h35v35h-35z"/><path fill="#160e8a" d="M318 344h35v35h-35z"/><path fill="#856ad1" d="M354 344h35v35h-35z"/><path fill="#c35980" d="M390 344h35v35h-35z"/><path fill="#ea3b40" d="M426 344h35v35h-35z"/></g><g fill="#dfe2e7" clip-path="url(#clip2_249_8276-matmul-01-svg)"><path d="M461 63v35h-35V63z"/><path d="M461 99v35h-35V99z" opacity=".8"/><path d="M461 135v35h-35v-35z" opacity=".6"/><path d="M461 171v35h-35v-35z" opacity=".4"/><path d="M425 63v35h-35V63z"/><path d="M425 99v35h-35V99z" opacity=".8"/><path d="M425 135v35h-35v-35z" opacity=".6"/><path d="M425 171v35h-35v-35z" opacity=".4"/><path d="M389 63v35h-35V63z"/><path d="M389 99v35h-35V99z" opacity=".8"/><path d="M389 135v35h-35v-35z" opacity=".6"/><path d="M389 171v35h-35v-35z" opacity=".4"/><path d="M353 63v35h-35V63z"/><path d="M353 99v35h-35V99z" opacity=".8"/><path d="M353 135v35h-35v-35z" opacity=".6"/><path d="M353 171v35h-35v-35z" opacity=".4"/></g><path fill="#000" d="M231.398 415.137q.096.014.198.014h.308q1.553 0 2.439-.651.893-.653.893-1.773 0-1.004-.549-1.523-.549-.52-1.597-.52a7 7 0 0 0-.402.014q-.236.015-.528.044l-.491 2.747q-.175 1.033-.271 1.648m-3.09 4.38h.285q.455 0 .645-.257.198-.264.403-1.45l1.062-6.328q.021-.11.036-.205.015-.096.015-.154 0-.3-.205-.439-.198-.147-.608-.147h-.198l.095-.542q.462.043.843.066.38.022.688.022.477 0 1.267-.044.799-.044 1.114-.044 1.347 0 2.102.623.76.615.761 1.699 0 1.032-.659 1.816-.659.777-1.933 1.26l1.113 2.117q.043.094.139.285.93 1.817 1.985 1.817.036 0 .11-.008.08-.007.117-.007l-.088.491a8 8 0 0 1-.564.08q-.227.03-.395.03-.667 0-1.136-.242a1.96 1.96 0 0 1-.769-.754q-.212-.345-.791-1.575-.571-1.23-.923-1.948-.234.022-.476.036-.234.008-.483.008a8 8 0 0 1-.286-.008 7 7 0 0 0-.285-.007l-.418 2.761-.037.271a4 4 0 0 0-.007.183q0 .36.154.476.161.118.666.118h.169l-.095.483a45 45 0 0 1-.681-.029q-.858-.03-1.099-.03-.374 0-1.318.044-.257.008-.411.015zm11.55-2.82.073-.037q2.608-1.334 2.608-2.058a.93.93 0 0 0-.279-.674.88.88 0 0 0-.652-.285q-.578 0-1.04.798-.46.798-.71 2.256m2.204-.506-2.241 1.158v.073q0 .871.271 1.326.279.454.799.454.307 0 .769-.271.468-.279 1.194-.894l.256.462q-1.047.966-1.67 1.34-.615.373-1.121.373-.768 0-1.245-.666-.476-.666-.476-1.751 0-.768.249-1.648.257-.885.659-1.545.506-.806 1.158-1.245t1.347-.44q.71 0 1.187.455.483.446.483 1.091 0 .52-.293.864-.285.337-1.326.864m6.343 1.187.55-3.318a4 4 0 0 0-.718-.337 1.8 1.8 0 0 0-.586-.11q-.901 0-1.516 1.158-.615 1.149-.615 2.871 0 .695.161 1.054.168.36.49.359.22 0 .813-.447.601-.446 1.421-1.23m.015.747-1.245 1.128q-.549.498-.879.688-.323.19-.608.191-.659 0-1.011-.557-.351-.564-.351-1.618 0-2.08 1.047-3.575 1.054-1.494 2.505-1.494.293 0 .593.081.308.074.637.219l.418-2.651q.022-.153.029-.308.015-.16.015-.322 0-.292-.117-.403-.118-.11-.432-.109-.096 0-.198.007a3 3 0 0 0-.213.007l-.029-.432q.608-.059 1.223-.161.623-.102 1.253-.249-.681 3.515-1.121 6.35-.44 2.828-.439 3.435 0 .374.065.527a.245.245 0 0 0 .235.147.4.4 0 0 0 .205-.073 2 2 0 0 0 .308-.242l.446-.403.242.418-.842.827q-.44.425-.637.542a.75.75 0 0 1-.381.117q-.389 0-.572-.366-.175-.366-.175-1.135a5 5 0 0 1 .029-.586m10.071.645-1.011.944a2 2 0 0 1-.491.374.95.95 0 0 1-.439.11q-.33 0-.535-.315-.198-.323-.198-.857 0-.155.022-.366.03-.22.11-.681-1.355 1.384-1.919 1.801t-.959.418q-.418 0-.696-.388t-.278-.997q0-.512.439-2.307.11-.425.161-.644.154-.608.227-.974.074-.374.074-.557a.35.35 0 0 0-.074-.234.22.22 0 0 0-.183-.096q-.073 0-.285.103a10 10 0 0 0-.586.315l-.205-.403q.681-.505 1.193-.784.513-.285.725-.285a.53.53 0 0 1 .469.256q.176.257.176.711 0 .57-.454 2.211-.447 1.642-.447 2.461 0 .256.088.381.088.117.271.117.206 0 .696-.402.498-.411 1.662-1.56.279-1.319.447-2.227.176-.915.271-1.633l1.319-.315-.162.725a91 91 0 0 0-.454 1.985l-.175.937q-.132.667-.213 1.275a8 8 0 0 0-.073.857q0 .168.066.263a.2.2 0 0 0 .176.095q.102 0 .38-.197.279-.198.638-.535zm5.302-4.593-.388.381q-.483-.49-.776-.652a1.2 1.2 0 0 0-.586-.161q-.674 0-1.172 1.004-.498.996-.498 2.46 0 .982.256 1.48.257.498.755.498.278 0 .762-.315a6.3 6.3 0 0 0 1.018-.879l.3.52q-.85.901-1.45 1.304-.601.395-1.099.395-.791 0-1.267-.688-.47-.688-.469-1.86 0-2.007 1.026-3.384 1.032-1.377 2.541-1.377.55 0 .938.234.395.234.395.535a.5.5 0 0 1-.066.234 1 1 0 0 1-.22.271m3.999-2.937q-.138.49-.388 1.538-.073.308-.11.454.433 0 .879-.007.454-.015.952-.037l-.175.733a12 12 0 0 0-.44-.007h-1.362q-.344 1.508-.513 2.636-.16 1.128-.161 1.89 0 .322.103.505.11.183.3.183.147 0 .461-.234t.857-.754l.257.468q-1.055 1.084-1.451 1.385-.394.293-.666.293-.506 0-.806-.476-.3-.477-.3-1.297 0-.534.168-1.531.169-1.003.638-3.105-.117 0-.308.007l-.249.008h-.505l.088-.491q.336-.015.615-.117.285-.103.571-.323.066-.263.147-.549.087-.293.197-.615zm4.842 7.097.256.433q-.9.93-1.252 1.186t-.623.256a.73.73 0 0 1-.622-.322q-.235-.33-.235-.879 0-.688.432-2.3.44-1.611.44-2.321 0-.183-.088-.293a.28.28 0 0 0-.227-.11.75.75 0 0 0-.308.095 4 4 0 0 0-.476.293l-.22-.388.975-.711q.277-.204.483-.293a.9.9 0 0 1 .388-.095q.345 0 .542.286.205.278.205.769 0 .534-.381 2.095l-.131.527a33 33 0 0 0-.315 1.37q-.103.541-.103.747 0 .183.081.3a.24.24 0 0 0 .205.117q.117 0 .307-.146.19-.147.667-.616m-.059-9.441.418.469q.175.183.241.33a.6.6 0 0 1 .074.285.47.47 0 0 1-.11.293 1.1 1.1 0 0 1-.308.264l-.644.359-.469-.557a1.4 1.4 0 0 1-.191-.285.6.6 0 0 1-.044-.227q0-.169.088-.293a.9.9 0 0 1 .301-.257zm4.592 4.732q-.849 0-1.464 1.164-.616 1.165-.616 2.872 0 .9.308 1.377.315.476.908.476.894 0 1.516-1.143.63-1.15.63-2.812 0-.99-.315-1.458-.315-.476-.967-.476m.315-.711q1.092 0 1.656.682.571.674.571 1.977 0 .747-.293 1.597a5.8 5.8 0 0 1-.791 1.523q-.534.733-1.216 1.128a2.8 2.8 0 0 1-1.421.388q-.98 0-1.567-.71-.579-.71-.579-1.904 0-.886.286-1.729.286-.842.82-1.523a4 4 0 0 1 1.194-1.055q.674-.374 1.34-.374m5.406 2.103 1.186-1.158q.623-.593.938-.783.322-.19.608-.191.483 0 .783.425.308.425.308 1.121 0 .71-.359 2.197-.359 1.479-.359 2.109 0 .19.073.293.073.096.213.095a.36.36 0 0 0 .161-.051 1 1 0 0 0 .198-.154l.556-.542.257.389-.799.813q-.285.293-.571.461-.278.168-.491.168a.72.72 0 0 1-.6-.315q-.227-.321-.227-.842 0-.623.373-2.19.374-1.575.374-2.292a.7.7 0 0 0-.117-.432.34.34 0 0 0-.301-.169q-.286 0-1.75 1.355-.389.358-.608.564l-.462 2.578-.043.22q-.154.783-.184 1.201l-1.303.322q.483-2.101.761-3.654.286-1.553.286-2.037 0-.292-.066-.417a.22.22 0 0 0-.212-.132q-.089 0-.293.103a6 6 0 0 0-.506.3l-.197-.388.234-.191q1.128-.908 1.509-.908.366 0 .542.279.176.27.176.849 0 .205-.022.462-.022.255-.066.542"/><path fill="#000" d="M288.354 399.354a.5.5 0 0 0 0-.708l-3.182-3.182a.502.502 0 0 0-.708.708l2.829 2.828-2.829 2.828a.502.502 0 0 0 .708.708zM152 399v.5h136v-1H152z"/><path fill="#000" d="M480.65 206.354a.5.5 0 0 0 .707 0l3.182-3.182a.5.5 0 1 0-.707-.708l-2.828 2.829-2.829-2.829a.5.5 0 0 0-.707.708zM481.004 90h-.5v116h1V90z"/><path fill="#000" d="M383.318 18.548q.344.03.666.044.33.015.645.015.234 0 .549-.015t.681-.044a3 3 0 0 0 .264.498q.168.257.425.564l6.042 7.149a461 461 0 0 1-.044-2.952q-.059-3.86-.131-4.153-.089-.336-.315-.468-.22-.132-.725-.132h-.228v-.506q.089 0 .264.008 1.04.05 1.465.05.432 0 1.509-.05.153-.008.234-.008l-.007.506a1 1 0 0 0-.095-.008 1 1 0 0 0-.14-.007q-.981 0-.996 2.732-.007.689-.007 1.077l-.029 1.948q-.015.432-.022.893v1.253q0 .885.022 1.384.022.49.073.791h-.813q-.124-.293-.886-1.172l-.073-.088-6.285-7.39v.169q.044 6.855.147 7.25.087.338.307.47.228.13.718.131h.22V29a11 11 0 0 0-.322-.015q-1.026-.044-1.399-.044-.36 0-.799.015-.432.015-.915.044v-.505q.044 0 .095.007h.147q.981 0 .996-2.717.007-.69.007-1.077l.037-1.948q.007-.63.007-1.223.007-.6.007-1.37 0-.63-.241-.872-.243-.24-.857-.241h-.198z"/><path stroke="#000" d="M337 53V38.5h103V53"/><path fill="#000" d="M37.283 309.236q.168.015.36.022h.585q.417 0 .77-.015.358-.015.688-.051a2.7 2.7 0 0 0 .805-.857q.27-.483.271-1.062 0-.93-.593-1.465-.594-.542-1.626-.542-.227 0-.527.029-.294.03-.667.088-.022.982-.044 2.278-.015 1.296-.022 1.575m.015 4.812q.424.124.835.19.41.059.798.059 1.2 0 1.86-.586t.66-1.633q0-1.114-.74-1.648-.74-.543-2.27-.542-.25 0-.506.007-.249 0-.652.022 0 .308-.007.908-.007.594-.007.872 0 .454.007.967zm-2.593.476.095.015h.147q.975 0 .988-2.74.008-.689.015-1.076l.03-2q.006-.645.007-1.252.007-.609.007-1.319 0-.63-.234-.871-.235-.242-.835-.242h-.059v-.513q.47.037.916.052.454.014.915.014.513 0 1.26-.029.747-.037.974-.037 1.51 0 2.38.674.88.667.88 1.802 0 .798-.433 1.384-.425.58-1.413 1.121 1.29.249 1.926.879.637.63.637 1.662 0 1.34-1.062 2.161-1.062.82-2.834.82-.322 0-1.209-.036-.886-.037-1.465-.037-.24 0-.673.015-.425.014-.96.044zm15.813-.586.205.461a6.3 6.3 0 0 1-1.003.608q-.454.22-.733.22-.468 0-.703-.271-.234-.278-.256-.835-.798.535-1.326.769-.526.227-.945.227-.74 0-1.237-.556-.499-.558-.498-1.363 0-1.37 2.951-2.065.696-.161 1.084-.257 0-.124.008-.358.021-.484.021-.63 0-.762-.314-1.121-.315-.366-.96-.366-.63 0-.996.234-.36.227-.359.623 0 .036.007.102l.008.088q0 .228-.22.381a.93.93 0 0 1-.527.147q-.264 0-.389-.088-.124-.088-.124-.271 0-.586.989-1.304.989-.725 2.043-.725 1.018 0 1.546.564.527.557.527 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.102.644.11.17.381.169a1 1 0 0 0 .3-.066 9 9 0 0 0 .557-.249m-2.498-2.476-.417.11q-2.38.653-2.38 1.538 0 .484.307.791.307.301.813.301.308 0 .71-.161.405-.162.938-.513zm4.988-5.039.484.147q-.045.402-.073.725-.023.315-.03.622h.52q.418 0 .85-.007.432-.015.871-.036l-.175.798a14 14 0 0 0-.887-.044q-.41-.015-.82-.015h-.344q-.045 1.26-.066 1.934-.015.666-.015 1.106 0 1.655.227 2.16.228.5.813.499.242 0 .535-.103.3-.103.725-.337l.242.483a8 8 0 0 1-1.275.645q-.57.212-.996.212-.783 0-1.142-.534-.36-.543-.36-1.736 0-.234.03-1.67.037-1.443.037-2.644-.066 0-.19.007-.608.022-.836.022v-.527q.718-.102 1.187-.527.468-.433.688-1.18m9.17 7.134.366.557q-.71.542-1.398.82a3.5 3.5 0 0 1-1.304.278q-1.436 0-2.344-1.025-.908-1.032-.908-2.637 0-1.662 1.15-2.812t2.805-1.15q.849 0 1.311.242.462.234.461.659a.8.8 0 0 1-.19.534q-.183.22-.425.22-.08 0-.681-.366-.593-.374-1.135-.374-.952 0-1.516.689-.557.681-.557 1.86 0 1.486.674 2.322.68.828 1.882.828.447 0 .886-.154.447-.154.923-.491m3.362-9.88q-.03 1.23-.051 2.512-.023 1.281-.03 2.629.821-.623 1.465-.915.644-.3 1.172-.3 1.077 0 1.619.607.542.609.542 1.824l-.008.645q-.007.637-.007 1.274 0 .272-.007.681-.007.403-.007.55 0 .82.146 1.069.147.249.557.249l.08-.007a1 1 0 0 1 .103-.008V315a54 54 0 0 0-1.004-.059 15 15 0 0 0-.556-.014q-.353 0-.762.022-.404.014-.842.051l-.008-.513h.11q.938 0 .96-1.714v-.146l.014-1.575v-.3q0-1.333-.315-1.765-.314-.44-1.084-.44-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.036 2.608q0 .219-.007.564-.008.344-.008.476 0 .908.147 1.179.145.271.564.271.029 0 .088-.007a1 1 0 0 1 .102-.008V315a20 20 0 0 0-.872-.051 13 13 0 0 0-1.362-.008q-.374.015-.974.052v-.506q.044 0 .124.008.08.007.118.007.506 0 .68-.264.177-.27.177-1.56v-.542l.029-5.508v-1.259q0-.316-.14-.469-.13-.162-.402-.161-.102 0-.337.044l-.08.014-.11-.476q.6-.117 1.179-.271.578-.161 1.157-.373m15.82-.183.374.388q-1.355 1.501-2.05 3.222a9.5 9.5 0 0 0-.697 3.575q0 1.852.696 3.508t2.11 3.201l-.389.446q-1.837-1.42-2.746-3.222-.9-1.802-.901-4.05 0-2.103.915-3.904.924-1.802 2.688-3.164m7.53 8.943 2.116-4.805.088-.198q1.048-2.366 1.048-2.798a.2.2 0 0 0-.008-.044.2.2 0 0 1-.007-.044q.432.022.776.037a29 29 0 0 0 1.216 0q.337-.015.74-.037v.506h-.088q-.638 0-.879.219-.234.22-.234.784 0 .22.029.982.03.761.073 1.648l.125 2.058.007.197q.161 2.74.25 3.099.043.212.27.329t.593.117h.184V315q-.579-.03-1.077-.044-.498-.015-.828-.015-.389 0-.871.015-.484.014-1.033.044v-.527q.066 0 .168.007a2 2 0 0 0 .147.007q.556 0 .769-.197.22-.199.22-.718a15 15 0 0 0-.03-.96l-.285-6.299-3.003 6.907-.03.066a6.6 6.6 0 0 0-.52 1.546h-.483q-.103-.455-.513-1.392l-.029-.066-2.952-6.687q-.043.783-.124 2.153-.205 3.399-.205 4.256v.073q0 .93.205 1.128.212.19.857.19h.154V315a32 32 0 0 0-1.758-.059q-.294 0-.733.015-.432.014-.93.044v-.513h.205q.418 0 .623-.102a.7.7 0 0 0 .322-.359q.14-.3.286-2.432.036-.585.066-.93l.132-1.772v-.022q.197-2.63.197-2.989 0-.46-.227-.644-.22-.183-.842-.183h-.117v-.506q.058 0 .19.008.85.051 1.187.051.255 0 .974-.044.227-.015.344-.015v.044q0 .652 2.483 6.153zm7.544-8.943q1.758 1.362 2.673 3.171.915 1.802.915 3.897 0 2.248-.9 4.057-.902 1.802-2.732 3.215l-.389-.446q1.414-1.538 2.11-3.179a8.8 8.8 0 0 0 .696-3.442q0-1.92-.689-3.641t-2.058-3.244z"/><path stroke="#000" d="M130.5 256h-17v108.5h17"/><defs><clipPath id="clip0_249_8276-matmul-01-svg"><path fill="#fff" d="M145 236h143v143H145z"/></clipPath><clipPath id="clip1_249_8276-matmul-01-svg"><rect width="143" height="143" x="318" y="236" fill="#fff" rx="2"/></clipPath><clipPath id="clip2_249_8276-matmul-01-svg"><path fill="#fff" d="M461 63v143H318V63z"/></clipPath></defs></svg>
<figcaption><b>Data Parallel Matmul</b> Similar to RMSNorm, the standard parallelism strategy for matmuls is a "data-parallel" strategy, keeping the entire reduction in one core. It is most straightforward to think about splitting the output tensor into 2D tiles and assigning each tile to a different core. Each core then computes the dot products that belong to that tile, once again performing the entire reduction within one core.
<p>Unlike for RMSNorm, additional constraints around arithmetic intensity and utilizing tensorcores force us to split 2D tiles instead of individual output elements for efficient matmul kernels.</p>
</figcaption>
</figure>
<p>At its core, you can view matrix multiplication as simply a pointwise operation followed by a reduction. Then, if we parallelize our matrix multiplication by chunking the <strong>output</strong> into tiles, we have an analogous &ldquo;data-parallel&rdquo; kernel strategy that keeps each reduction within one core.</p>
<p>Also similar to RMSNorm, it is possible for our &ldquo;batch&rdquo; dimensions (M and N) to become too small, forcing us to split along the reduction dimension (K). Despite having two &ldquo;batch&rdquo; dimensions, matmuls also require us to have much more &ldquo;work&rdquo; per core in order to leverage tensorcores effectively. For example, if you have a [1024, K] x [K, 1024] matmul and a standard 2D tile size of [128, 128], a data-parallel strategy would only be able to split this matmul into 64 cores, insufficient to saturate the GPU.</p>
<p>Splitting along the reduction dimension in a matmul is known as a <a href="https://github.com/NVIDIA/cutlass/blob/main/media/docs/cpp/efficient_gemm.md#parallelized-reductions">Split-K Matmul</a>. And just like RMSNorm, using this strategy breaks batch invariance.
<label for="sn10" class="sidenote-number"></label><input type="checkbox" id="sn10" class="margin-toggle"/><span class="sidenote">
Another interesting parallelism strategy for matmuls is stream-k. Stream-k is interesting because it has even <i>less</i> invariance than typical matmuls. As discussed, most matmul libraries are not batch-invariant, but they&rsquo;re at least what you could call batch-position-invariant (i.e. changing the position of the element <em>within</em> the batch does not affect numerics). However, stream-k is not batch-position-invariant either! Its core insight is that you can get cleaner load-balancing by splitting along k in different ways for different output tiles, but taking advantage of this makes our kernel not batch-position-invariant either. </span></p>
<figure class="half-width matmul">
<svg xmlns="http://www.w3.org/2000/svg" width="527" height="342" fill="none" viewBox="0 0 527 342"><path fill="#f5f5f5" d="M0 0h527v342H0z"/><path fill="#fff" d="M0 0h527v342H0z"/><path fill="#dfe2e7" d="M145 236h35v35h-35z"/><path fill="#dfe2e7" d="M181 236h35v35h-35z"/><path fill="#eceef1" d="M217 236h35v35h-35z"/><path fill="#eceef1" d="M253 236h35v35h-35z"/><path fill="#ea3b40" d="M461 63v35h-35V63z"/><path fill="#ea3b40" d="M461 99v35h-35V99z"/><path fill="#ea3b40" d="M461 135v35h-35v-35z" opacity=".7"/><path fill="#ea3b40" d="M461 171v35h-35v-35z" opacity=".7"/><path fill="#c35980" d="M425 63v35h-35V63z"/><path fill="#c35980" d="M425 99v35h-35V99z"/><path fill="#c35980" d="M425 135v35h-35v-35z" opacity=".7"/><path fill="#c35980" d="M425 171v35h-35v-35z" opacity=".7"/><path fill="#856ad1" d="M389 63v35h-35V63z"/><path fill="#856ad1" d="M389 99v35h-35V99z"/><path fill="#856ad1" d="M389 135v35h-35v-35z" opacity=".7"/><path fill="#856ad1" d="M389 171v35h-35v-35z" opacity=".7"/><path fill="#160e8a" d="M353 63v35h-35V63z"/><path fill="#160e8a" d="M353 99v35h-35V99z"/><path fill="#160e8a" d="M353 135v35h-35v-35z" opacity=".7"/><path fill="#160e8a" d="M353 171v35h-35v-35z" opacity=".7"/><path fill="#000" d="M231.398 307.137q.096.014.198.014h.308q1.553 0 2.439-.651.893-.653.893-1.773 0-1.004-.549-1.523-.549-.52-1.597-.52a7 7 0 0 0-.402.014q-.236.015-.528.044l-.491 2.747q-.175 1.032-.271 1.648m-3.09 4.38h.285q.455 0 .645-.257.198-.264.403-1.45l1.062-6.328q.021-.11.036-.205.015-.096.015-.154 0-.3-.205-.439-.198-.147-.608-.147h-.198l.095-.542q.462.043.843.066.38.022.688.022.477 0 1.267-.044.799-.044 1.114-.044 1.347 0 2.102.623.76.615.761 1.699 0 1.033-.659 1.816-.659.777-1.933 1.26l1.113 2.117q.043.095.139.285.93 1.817 1.985 1.817.036 0 .11-.008.08-.007.117-.007l-.088.491a8 8 0 0 1-.564.08q-.227.03-.395.03-.667 0-1.136-.242a1.96 1.96 0 0 1-.769-.754q-.212-.345-.791-1.575-.571-1.23-.923-1.948-.234.022-.476.036-.234.008-.483.008a8 8 0 0 1-.286-.008 7 7 0 0 0-.285-.007l-.418 2.761-.037.271a4 4 0 0 0-.007.183q0 .36.154.476.161.118.666.118h.169l-.095.483a45 45 0 0 1-.681-.029q-.858-.03-1.099-.03-.374 0-1.318.044-.257.007-.411.015zm11.55-2.82.073-.037q2.608-1.334 2.608-2.058a.93.93 0 0 0-.279-.674.88.88 0 0 0-.652-.285q-.578 0-1.04.798-.46.798-.71 2.256m2.204-.506-2.241 1.158v.073q0 .872.271 1.326.279.454.799.454.307 0 .769-.271.468-.279 1.194-.894l.256.462q-1.047.966-1.67 1.34-.615.373-1.121.373-.768 0-1.245-.666-.476-.666-.476-1.751 0-.768.249-1.648.257-.885.659-1.545.506-.805 1.158-1.245t1.347-.44q.71 0 1.187.455.483.446.483 1.091 0 .52-.293.864-.285.337-1.326.864m6.343 1.187.55-3.318a4 4 0 0 0-.718-.337 1.8 1.8 0 0 0-.586-.11q-.901 0-1.516 1.158-.615 1.149-.615 2.871 0 .695.161 1.054.168.36.49.359.22 0 .813-.447.601-.446 1.421-1.23m.015.747-1.245 1.128q-.549.498-.879.688-.323.19-.608.191-.659 0-1.011-.557-.351-.564-.351-1.618 0-2.08 1.047-3.575 1.054-1.494 2.505-1.494.293 0 .593.081.308.073.637.219l.418-2.651q.022-.153.029-.308.015-.16.015-.322 0-.292-.117-.403-.118-.11-.432-.109-.096 0-.198.007a3 3 0 0 0-.213.007l-.029-.432q.608-.059 1.223-.161.623-.102 1.253-.249-.681 3.515-1.121 6.35-.44 2.828-.439 3.435 0 .374.065.527a.245.245 0 0 0 .235.147.4.4 0 0 0 .205-.073 2 2 0 0 0 .308-.242l.446-.403.242.418-.842.827q-.44.425-.637.542a.75.75 0 0 1-.381.117q-.389 0-.572-.366-.175-.366-.175-1.135a5 5 0 0 1 .029-.586m10.071.645-1.011.944a2 2 0 0 1-.491.374.95.95 0 0 1-.439.11q-.33 0-.535-.315-.198-.323-.198-.857 0-.155.022-.366.03-.22.11-.681-1.355 1.384-1.919 1.801t-.959.418q-.418 0-.696-.388t-.278-.997q0-.512.439-2.307.11-.425.161-.644.154-.608.227-.974.074-.374.074-.557a.35.35 0 0 0-.074-.234.22.22 0 0 0-.183-.096q-.073 0-.285.103a10 10 0 0 0-.586.315l-.205-.403q.681-.505 1.193-.784.513-.285.725-.285a.53.53 0 0 1 .469.256q.176.256.176.711 0 .57-.454 2.211-.447 1.642-.447 2.461 0 .256.088.381.088.117.271.117.206 0 .696-.402.498-.411 1.662-1.56.279-1.319.447-2.227.176-.915.271-1.633l1.319-.315-.162.725a91 91 0 0 0-.454 1.985l-.175.937q-.132.667-.213 1.275a8 8 0 0 0-.073.857q0 .168.066.263a.2.2 0 0 0 .176.095q.102 0 .38-.197.279-.198.638-.535zm5.302-4.593-.388.381q-.483-.49-.776-.652a1.2 1.2 0 0 0-.586-.161q-.674 0-1.172 1.004-.498.996-.498 2.46 0 .982.256 1.48.257.498.755.498.278 0 .762-.315a6.3 6.3 0 0 0 1.018-.879l.3.52q-.85.901-1.45 1.304-.601.395-1.099.395-.791 0-1.267-.688-.47-.688-.469-1.86 0-2.007 1.026-3.384 1.032-1.377 2.541-1.377.55 0 .938.234.395.234.395.535a.5.5 0 0 1-.066.234 1 1 0 0 1-.22.271m3.999-2.937q-.138.49-.388 1.538-.073.308-.11.454.433 0 .879-.007.454-.015.952-.037l-.175.733a12 12 0 0 0-.44-.007h-1.362q-.344 1.508-.513 2.636-.16 1.128-.161 1.89 0 .322.103.505.11.183.3.183.147 0 .461-.234t.857-.754l.257.468q-1.055 1.084-1.451 1.385-.394.293-.666.293-.506 0-.806-.476-.3-.477-.3-1.297 0-.534.168-1.531.169-1.003.638-3.105-.117 0-.308.007l-.249.008h-.505l.088-.491q.336-.015.615-.117.285-.103.571-.323.066-.263.147-.549.087-.292.197-.615zm4.842 7.097.256.433q-.9.93-1.252 1.186t-.623.256a.73.73 0 0 1-.622-.322q-.235-.33-.235-.879 0-.688.432-2.3.44-1.611.44-2.321 0-.183-.088-.293a.28.28 0 0 0-.227-.11.75.75 0 0 0-.308.095 4 4 0 0 0-.476.293l-.22-.388.975-.711q.277-.204.483-.293a.9.9 0 0 1 .388-.095q.345 0 .542.286.205.278.205.769 0 .534-.381 2.095l-.131.527a33 33 0 0 0-.315 1.37q-.103.541-.103.747 0 .183.081.3a.24.24 0 0 0 .205.117q.117 0 .307-.146.19-.147.667-.616m-.059-9.441.418.469q.175.183.241.33a.6.6 0 0 1 .074.285.47.47 0 0 1-.11.293 1.1 1.1 0 0 1-.308.264l-.644.359-.469-.557a1.4 1.4 0 0 1-.191-.285.6.6 0 0 1-.044-.227q0-.169.088-.293a.9.9 0 0 1 .301-.257zm4.592 4.732q-.849 0-1.464 1.164-.616 1.165-.616 2.872 0 .9.308 1.377.315.476.908.476.894 0 1.516-1.143.63-1.15.63-2.812 0-.99-.315-1.458-.315-.476-.967-.476m.315-.711q1.092 0 1.656.682.571.674.571 1.977 0 .747-.293 1.597a5.8 5.8 0 0 1-.791 1.523q-.534.734-1.216 1.128a2.8 2.8 0 0 1-1.421.388q-.98 0-1.567-.71-.579-.71-.579-1.904 0-.886.286-1.729.286-.842.82-1.523a4 4 0 0 1 1.194-1.055q.674-.374 1.34-.374m5.406 2.103 1.186-1.158q.623-.593.938-.783.322-.19.608-.191.483 0 .783.425.308.425.308 1.121 0 .71-.359 2.197-.359 1.479-.359 2.109 0 .19.073.293.073.096.213.095a.36.36 0 0 0 .161-.051 1 1 0 0 0 .198-.154l.556-.542.257.389-.799.813q-.285.293-.571.461-.278.168-.491.168a.72.72 0 0 1-.6-.315q-.227-.321-.227-.842 0-.623.373-2.19.374-1.575.374-2.292a.7.7 0 0 0-.117-.432.34.34 0 0 0-.301-.169q-.286 0-1.75 1.355-.389.358-.608.564l-.462 2.578-.043.22q-.154.783-.184 1.201l-1.303.322q.483-2.101.761-3.654.286-1.553.286-2.037 0-.292-.066-.417a.22.22 0 0 0-.212-.132q-.089 0-.293.103a6 6 0 0 0-.506.3l-.197-.388.234-.191q1.128-.908 1.509-.908.366 0 .542.279.176.27.176.849 0 .205-.022.462-.022.255-.066.542"/><path fill="#000" d="M288.354 291.354a.5.5 0 0 0 0-.708l-3.182-3.182a.502.502 0 0 0-.708.708l2.829 2.828-2.829 2.828a.502.502 0 0 0 .708.708zM152 291v.5h136v-1H152z"/><path fill="#000" d="M480.65 206.354a.5.5 0 0 0 .707 0l3.182-3.182a.5.5 0 1 0-.707-.708l-2.828 2.829-2.829-2.829a.5.5 0 0 0-.707.708zM481.004 90h-.5v116h1V90z"/><path fill="#000" d="M383.318 18.548q.344.03.666.044.33.015.645.015.234 0 .549-.015t.681-.044a3 3 0 0 0 .264.498q.168.257.425.564l6.042 7.149a461 461 0 0 1-.044-2.952q-.059-3.86-.131-4.153-.089-.336-.315-.468-.22-.132-.725-.132h-.228v-.506q.089 0 .264.008 1.04.05 1.465.05.432 0 1.509-.05.153-.008.234-.008l-.007.506a1 1 0 0 0-.095-.008 1 1 0 0 0-.14-.007q-.981 0-.996 2.732-.007.689-.007 1.077l-.029 1.948q-.015.432-.022.893v1.253q0 .885.022 1.384.022.49.073.791h-.813q-.124-.293-.886-1.172l-.073-.088-6.285-7.39v.169q.044 6.855.147 7.25.087.338.307.47.228.13.718.131h.22V29a11 11 0 0 0-.322-.015q-1.026-.044-1.399-.044-.36 0-.799.015-.432.015-.915.044v-.505q.044 0 .095.007h.147q.981 0 .996-2.717.007-.69.007-1.077l.037-1.948q.007-.63.007-1.223.007-.6.007-1.37 0-.63-.241-.872-.243-.24-.857-.241h-.198z"/><path stroke="#000" d="M337 53V38.5h103V53"/><path fill="#000" d="M64.283 253.236q.168.015.36.022h.585q.417 0 .77-.015.358-.015.688-.051a2.7 2.7 0 0 0 .805-.857q.27-.483.271-1.062 0-.93-.593-1.465-.594-.542-1.626-.542-.227 0-.527.029-.294.03-.667.088-.022.982-.044 2.278-.015 1.296-.022 1.575m.015 4.812q.424.124.835.19.41.059.798.059 1.2 0 1.86-.586t.66-1.633q0-1.114-.74-1.648-.74-.543-2.27-.542-.25 0-.506.007-.249 0-.652.022 0 .308-.007.908-.007.594-.007.872 0 .454.007.967zm-2.593.476.095.015h.147q.975 0 .988-2.74.008-.689.015-1.076l.03-2q.006-.645.007-1.252.007-.609.007-1.319 0-.63-.234-.871-.235-.242-.835-.242h-.059v-.513q.47.037.916.052.454.014.915.014.513 0 1.26-.029.747-.036.974-.037 1.51 0 2.38.674.88.667.88 1.802 0 .799-.433 1.384-.425.58-1.413 1.121 1.29.249 1.926.879.637.63.637 1.662 0 1.34-1.062 2.161-1.062.82-2.834.82-.323 0-1.209-.036-.886-.037-1.465-.037-.24 0-.673.015-.425.014-.96.044zm15.813-.586.205.461a6.3 6.3 0 0 1-1.003.608q-.454.22-.733.22-.468 0-.703-.271-.234-.278-.256-.835-.798.535-1.326.769-.526.227-.945.227-.739 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.162 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.314-1.121-.315-.366-.96-.366-.63 0-.996.234-.36.227-.359.623 0 .036.007.102l.008.088q0 .228-.22.381a.93.93 0 0 1-.527.147q-.264 0-.389-.088-.124-.088-.124-.271 0-.586.989-1.304.989-.725 2.043-.725 1.018 0 1.546.564.527.557.527 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.102.644.11.17.381.169a1 1 0 0 0 .3-.066 9 9 0 0 0 .557-.249m-2.498-2.476-.417.11q-2.38.653-2.38 1.538 0 .484.307.791.307.301.813.301.308 0 .71-.161.404-.162.938-.513zm4.988-5.039.484.147q-.045.402-.074.725-.021.315-.029.622h.52q.417 0 .85-.007.432-.015.871-.036l-.175.798a14 14 0 0 0-.887-.044q-.41-.015-.82-.015h-.344q-.044 1.26-.066 1.934-.015.666-.015 1.106 0 1.655.227 2.16.228.5.813.499.242 0 .535-.103.3-.103.725-.337l.242.483a8 8 0 0 1-1.275.645q-.57.212-.996.212-.783 0-1.142-.534-.36-.543-.36-1.736 0-.234.03-1.67.037-1.443.037-2.644-.067 0-.19.007-.609.022-.836.022v-.527q.718-.102 1.187-.527.468-.433.688-1.18m9.17 7.134.366.557q-.71.542-1.398.82a3.5 3.5 0 0 1-1.304.278q-1.436 0-2.344-1.025-.908-1.032-.908-2.637 0-1.662 1.15-2.812t2.805-1.15q.849 0 1.311.242.462.234.461.659a.8.8 0 0 1-.19.534q-.183.22-.425.22-.08 0-.681-.366-.593-.374-1.135-.374-.952 0-1.516.689-.557.681-.557 1.86 0 1.487.674 2.322.68.828 1.882.828.447 0 .886-.154.447-.154.923-.491m3.362-9.88q-.03 1.23-.051 2.512-.023 1.282-.03 2.629.821-.622 1.465-.915.644-.3 1.172-.3 1.076 0 1.619.607.542.609.542 1.824l-.008.645q-.007.637-.007 1.274 0 .272-.007.681-.007.403-.007.55 0 .82.146 1.069.147.249.557.249l.08-.007a1 1 0 0 1 .103-.008V259a54 54 0 0 0-1.004-.059 15 15 0 0 0-.556-.014q-.353 0-.762.022-.404.014-.842.051l-.008-.513h.11q.938 0 .96-1.714v-.146l.014-1.575v-.3q0-1.333-.315-1.765-.314-.44-1.084-.44-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.036 2.608q0 .219-.007.564-.008.344-.008.476 0 .908.147 1.179.145.271.564.271.029 0 .088-.007a1 1 0 0 1 .102-.008V259a20 20 0 0 0-.872-.051 13 13 0 0 0-1.362-.008q-.374.015-.974.052v-.506q.044 0 .124.008.08.007.118.007.506 0 .68-.264.177-.27.177-1.56v-.542l.029-5.508v-1.259q0-.315-.14-.469-.13-.162-.402-.161-.102 0-.337.044l-.08.014-.11-.476q.6-.117 1.179-.271.578-.161 1.157-.373m15.82-.183.374.388q-1.355 1.501-2.051 3.222a9.5 9.5 0 0 0-.696 3.575 9 9 0 0 0 .696 3.508q.696 1.655 2.109 3.201l-.388.446q-1.838-1.42-2.746-3.222-.901-1.802-.901-4.05 0-2.103.915-3.904.924-1.802 2.688-3.164m7.53 8.943 2.116-4.805.088-.198q1.047-2.366 1.048-2.798a.2.2 0 0 0-.008-.044.2.2 0 0 1-.007-.044q.432.022.776.037a29 29 0 0 0 1.216 0q.337-.015.74-.037v.506h-.088q-.638 0-.879.219-.234.22-.234.784 0 .22.029.982.03.761.073 1.648l.125 2.058.007.197q.162 2.74.249 3.099.044.212.271.329t.593.117h.183V259q-.578-.03-1.076-.044a28 28 0 0 0-.828-.015q-.388 0-.871.015-.484.014-1.033.044v-.527q.066 0 .168.007t.147.007q.556 0 .769-.197.22-.199.22-.718a15 15 0 0 0-.03-.96l-.285-6.299-3.003 6.907-.03.066a6.6 6.6 0 0 0-.52 1.546h-.483q-.102-.455-.513-1.392l-.029-.066-2.952-6.687q-.043.783-.124 2.153-.205 3.398-.205 4.256v.073q0 .93.205 1.128.212.19.857.19h.154V259a32 32 0 0 0-1.758-.059q-.294 0-.733.015-.432.014-.93.044v-.513h.205q.418 0 .623-.102a.7.7 0 0 0 .322-.359q.14-.3.286-2.432.036-.585.066-.93l.131-1.772v-.022q.198-2.63.198-2.989 0-.46-.227-.644-.22-.183-.842-.183h-.117v-.506q.058 0 .19.008.85.051 1.187.051.256 0 .974-.044.227-.015.344-.015v.044q0 .653 2.483 6.153zm7.544-8.943q1.757 1.362 2.673 3.171.915 1.802.915 3.897 0 2.248-.9 4.057-.902 1.802-2.732 3.215l-.389-.446q1.414-1.538 2.11-3.179a8.8 8.8 0 0 0 .696-3.442q0-1.92-.689-3.641t-2.058-3.244z"/><path fill="#000" d="M166.538 258h-7.368v-1.135h3.12v-7.969h-.117l-3.025 1.956v-1.377l3.149-2.044h1.267v9.434h2.974zm6.992-4.9v-1.084h1.15c1.186 0 2.014-.776 2.014-1.882 0-1.077-.791-1.787-1.985-1.787-1.187 0-1.978.695-2.08 1.831h-1.238c.125-1.831 1.414-2.967 3.369-2.967 1.89 0 3.238 1.136 3.238 2.74 0 1.274-.667 2.182-1.802 2.461v.117c1.406.183 2.241 1.172 2.241 2.615 0 1.794-1.509 3.076-3.618 3.076-2.088 0-3.538-1.201-3.633-3.025h1.223c.117 1.128 1.055 1.86 2.373 1.86 1.45 0 2.351-.747 2.351-1.941 0-1.23-.93-2.014-2.395-2.014zm13.473 5.112c-1.97 0-3.361-1.215-3.471-3.032h1.245c.117 1.106 1.062 1.868 2.3 1.868 1.362 0 2.27-.96 2.27-2.395 0-1.45-.915-2.432-2.27-2.432-.945 0-1.729.432-2.146 1.179h-1.223l.534-5.969h5.779v1.165h-4.761l-.293 3.449h.117c.52-.629 1.275-.959 2.205-.959 1.956 0 3.318 1.457 3.318 3.538 0 2.138-1.458 3.588-3.604 3.588m9.827-.212 4.797-9.316v-.096h-5.735v-1.157h7.053v1.194L198.207 258z"/><path fill="#000" d="M230.722 250.405c0-1.861 1.377-3.194 3.303-3.194 1.941 0 3.274 1.202 3.274 2.967 0 1.098-.498 1.977-2.182 3.816l-2.491 2.71v.124h4.842V258h-6.687v-.894l3.574-3.977c1.34-1.501 1.663-2.065 1.663-2.9 0-1.135-.799-1.882-2.029-1.882-1.216 0-2.022.813-2.022 2.058v.044h-1.245zm16.88 7.595v-2.234h-4.82v-1.047l3.589-7.288h1.318l-3.537 7.119v.096h3.464v-3.018h1.172v3.003h1.611v1.135h-1.618V258zm14.66-3.391c0 2.095-1.509 3.611-3.604 3.611-2.08 0-3.581-1.509-3.581-3.611 0-1.238.417-2.359 1.428-3.831.095-.161 2.292-3.237 2.366-3.347h1.486l-2.885 3.963c-.323.454-.293.424-.345.542l.11.058c.315-.425 1.077-.74 1.751-.74 1.882 0 3.274 1.429 3.274 3.355m-3.596 2.461c1.333 0 2.343-1.04 2.343-2.395 0-1.363-1.01-2.403-2.343-2.403-1.326 0-2.337 1.04-2.337 2.403 0 1.355 1.011 2.395 2.337 2.395m12.279 1.164c-2.197 0-3.728-1.259-3.728-3.061 0-1.311.85-2.381 2.154-2.695v-.118c-1.062-.293-1.729-1.201-1.729-2.351 0-1.648 1.377-2.812 3.303-2.812 1.927 0 3.296 1.164 3.296 2.812 0 1.15-.652 2.051-1.728 2.351v.118c1.281.271 2.153 1.362 2.153 2.695 0 1.802-1.523 3.061-3.721 3.061m0-6.313c1.223 0 2.029-.718 2.029-1.802 0-1.077-.806-1.794-2.029-1.794s-2.036.717-2.036 1.794c0 1.084.813 1.802 2.036 1.802m0 5.193c1.436 0 2.425-.835 2.425-2.044 0-1.208-.989-2.043-2.425-2.043s-2.424.835-2.424 2.043.989 2.044 2.424 2.044"/><path fill="#160e8a" d="M318 236h35l-17.5 17.5L318 271z"/><path fill="#5c56ad" d="M335.5 253.5 353 236v35h-35z"/><path fill="#fff" d="m356.498 232 .707.707L318.5 271.5l-.707-.707z"/><path fill="#856ad1" d="M353.979 236h35l-17.5 17.5-17.5 17.5z"/><path fill="#aa97df" d="m371.479 253.5 17.5-17.5v35h-35z"/><path fill="#fff" d="m392.477 232 .707.707-49.497 49.498-.707-.708z"/><path fill="#c35980" d="M389.973 236h35l-17.5 17.5-17.5 17.5z"/><path fill="#d58ba6" d="m407.473 253.5 17.5-17.5v35h-35z"/><path fill="#fff" d="m428.471 232 .707.707-49.497 49.498-.707-.708z"/><path fill="#ea3b40" d="M425.992 236h35l-17.5 17.5-17.5 17.5z"/><path fill="#f07679" d="m443.492 253.5 17.5-17.5v35h-35z"/><path fill="#fff" d="m464.49 232 .707.707-49.497 49.498-.707-.708z"/><path fill="#fff" d="M329.959 250h-6.385v-.984h2.704v-6.906h-.102l-2.621 1.695v-1.194l2.729-1.771h1.098v8.176h2.577z"/><path fill="#fff" d="M362.383 245.753v-.939h.996c1.029 0 1.746-.673 1.746-1.631 0-.933-.686-1.549-1.72-1.549-1.029 0-1.714.603-1.803 1.587h-1.073c.108-1.587 1.225-2.571 2.92-2.571 1.638 0 2.806.984 2.806 2.374 0 1.104-.578 1.892-1.562 2.133v.101c1.219.159 1.943 1.016 1.943 2.266 0 1.556-1.308 2.666-3.136 2.666-1.809 0-3.066-1.041-3.148-2.621h1.06c.101.977.914 1.612 2.056 1.612 1.257 0 2.038-.647 2.038-1.682 0-1.066-.806-1.746-2.076-1.746z"/><path fill="#fff" d="M399.424 250.184c-1.708 0-2.914-1.054-3.009-2.628h1.079c.102.959.921 1.619 1.993 1.619 1.181 0 1.968-.832 1.968-2.076 0-1.257-.793-2.107-1.968-2.107-.819 0-1.498.374-1.86 1.022h-1.06l.464-5.174h5.008v1.01h-4.126l-.254 2.989h.102c.45-.546 1.104-.831 1.91-.831 1.695 0 2.876 1.263 2.876 3.066 0 1.853-1.263 3.11-3.123 3.11"/><path fill="#fff" d="m432.304 250 4.157-8.074v-.083h-4.97v-1.003h6.113v1.035L433.497 250z"/><path fill="#fff" d="M340.58 258.417c0-1.612 1.193-2.767 2.863-2.767 1.682 0 2.837 1.041 2.837 2.571 0 .952-.431 1.714-1.891 3.307l-2.159 2.348v.108h4.196V265h-5.795v-.774l3.098-3.447c1.161-1.301 1.44-1.79 1.44-2.514 0-.984-.691-1.631-1.758-1.631-1.054 0-1.752.704-1.752 1.783v.039h-1.079z"/><path fill="#fff" d="M379.573 265v-1.936h-4.177v-.908l3.11-6.316h1.143l-3.066 6.17v.083h3.002v-2.615h1.016v2.602h1.397v.984h-1.403V265z"/><path fill="#fff" d="M418.642 262.061c0 1.815-1.308 3.129-3.123 3.129-1.803 0-3.104-1.307-3.104-3.129 0-1.073.362-2.044 1.238-3.32.082-.139 1.987-2.805 2.05-2.901h1.289l-2.501 3.434c-.28.394-.254.369-.299.47l.096.051c.273-.368.933-.641 1.517-.641 1.631 0 2.837 1.238 2.837 2.907m-3.117 2.133c1.156 0 2.032-.902 2.032-2.076 0-1.18-.876-2.082-2.032-2.082-1.149 0-2.025.902-2.025 2.082 0 1.174.876 2.076 2.025 2.076"/><path fill="#fff" d="M450.532 265.203c-1.905 0-3.231-1.092-3.231-2.653 0-1.136.736-2.063 1.866-2.336v-.102c-.92-.254-1.498-1.041-1.498-2.037 0-1.429 1.193-2.438 2.863-2.438s2.856 1.009 2.856 2.438c0 .996-.565 1.777-1.498 2.037v.102c1.111.235 1.866 1.181 1.866 2.336 0 1.561-1.32 2.653-3.224 2.653m0-5.472c1.06 0 1.758-.622 1.758-1.561 0-.933-.698-1.555-1.758-1.555s-1.765.622-1.765 1.555c0 .939.705 1.561 1.765 1.561m0 4.501c1.244 0 2.101-.724 2.101-1.771s-.857-1.771-2.101-1.771-2.101.724-2.101 1.771.857 1.771 2.101 1.771"/></svg>
<figcaption><b>Split-K Matmul</b> If our batch dimension is fairly small we may not have enough parallelism and require a split-k matmul. In this example, we split each reduction across two cores, which would accumulate separately and then combine their results at the end. However, splitting each reduction across two cores allows us to still leverage eight cores.
</figcaption>
</figure>
<!-- Todo (lowpri): Clean up writing here a bit more -->
<p>There’s an additional complexity with matmuls &mdash; tensor core instructions. Whereas with reductions we could simply operate on one row at a time, efficient matrix multiplication kernels must operate on an entire “tile” at a time.</p>
<p>Each tensor-core instruction (like say, <a href="https://docs.nvidia.com/cuda/parallel-thread-execution/#asynchronous-warpgroup-level-matrix-instructions-wgmma-mma"><code>wgmma.mma_async.sync.aligned.m64n128k16</code></a>) may have a different reduction order internally. One reason to use a different tensor-core instruction might be that the batch size is very small. For example, if we use a tensor-core PTX instruction that operates on a tile of length 256 but the batch size is only 32, we’re wasting almost all of that compute! At a batch-size of 1, the fastest kernels usually don’t use tensor cores at all.</p>
<figure class="half-width matmul">
<svg xmlns="http://www.w3.org/2000/svg" width="527" height="322" fill="none" viewBox="0 0 527 322"><path fill="#f5f5f5" d="M0 0h527v322H0z"/><path fill="#fff" d="M0 0h527v322H0z"/><path fill="#dfe2e7" d="M145 241h35v8h-35z"/><path fill="#000" fill-opacity=".05" d="M145 241h35v8h-35z"/><path fill="#e5e8ec" d="M181 241h35v8h-35z"/><path fill="#000" fill-opacity=".05" d="M181 241h35v8h-35z"/><path fill="#eceef1" d="M217 241h35v8h-35z"/><path fill="#000" fill-opacity=".05" d="M217 241h35v8h-35z"/><path fill="#f2f3f5" d="M253 241h35v8h-35z"/><path fill="#000" fill-opacity=".05" d="M253 241h35v8h-35z"/><path fill="#856ad1" d="M354 241h35v8h-35z"/><g opacity=".5"><mask id="path-10-inside-1_249_8276-matmul-02-svg" fill="#fff"><path d="M354 241h35v35h-35z"/></mask><path fill="#856ad1" d="M389 276v.5h.5v-.5zm-35 0h-.5v.5h.5zm0-35h-.5v.972h1V241zm0 2.917h-.5v1.944h1v-1.944zm0 3.889h-.5v1.944h1v-1.944zm0 3.888h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.944h1v-1.944zm0 3.889h-.5v1.944h1v-1.944zm0 3.889h-.5V276h1v-.972zm0 .972v.5h.972v-1H354zm2.917 0v.5h1.944v-1h-1.944zm3.889 0v.5h1.944v-1h-1.944zm3.888 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.944v-1h-1.944zm3.889 0v.5h1.944v-1h-1.944zm3.889 0v.5H389v-1h-.972zm.972 0h.5v-.972h-1V276zm0-2.917h.5v-1.944h-1v1.944zm0-3.889h.5v-1.944h-1v1.944zm0-3.888h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.944h-1v1.944zm0-3.889h.5v-1.944h-1v1.944zm0-3.889h.5V241h-1v.972zM389 276v1h1v-1zm-35 0h-1v1h1zm0-35h-1v.972h2V241zm0 2.917h-1v1.944h2v-1.944zm0 3.889h-1v1.944h2v-1.944zm0 3.888h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.944h2v-1.944zm0 3.889h-1v1.944h2v-1.944zm0 3.889h-1V276h2v-.972zm0 .972v1h.972v-2H354zm2.917 0v1h1.944v-2h-1.944zm3.889 0v1h1.944v-2h-1.944zm3.888 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.944v-2h-1.944zm3.889 0v1h1.944v-2h-1.944zm3.889 0v1H389v-2h-.972zm.972 0h1v-.972h-2V276zm0-2.917h1v-1.944h-2v1.944zm0-3.889h1v-1.944h-2v1.944zm0-3.888h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.944h-2v1.944zm0-3.889h1v-1.944h-2v1.944zm0-3.889h1V241h-2v.972z" mask="url(#path-10-inside-1_249_8276-matmul-02-svg)"/></g><path fill="#c35980" d="M390 241h35v8h-35z"/><g opacity=".5"><mask id="path-13-inside-2_249_8276-matmul-02-svg" fill="#fff"><path d="M390 241h35v35h-35z"/></mask><path fill="#c35980" d="M425 276v.5h.5v-.5zm-35 0h-.5v.5h.5zm0-35h-.5v.972h1V241zm0 2.917h-.5v1.944h1v-1.944zm0 3.889h-.5v1.944h1v-1.944zm0 3.888h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.944h1v-1.944zm0 3.889h-.5v1.944h1v-1.944zm0 3.889h-.5V276h1v-.972zm0 .972v.5h.972v-1H390zm2.917 0v.5h1.944v-1h-1.944zm3.889 0v.5h1.944v-1h-1.944zm3.888 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.944v-1h-1.944zm3.889 0v.5h1.944v-1h-1.944zm3.889 0v.5H425v-1h-.972zm.972 0h.5v-.972h-1V276zm0-2.917h.5v-1.944h-1v1.944zm0-3.889h.5v-1.944h-1v1.944zm0-3.888h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.944h-1v1.944zm0-3.889h.5v-1.944h-1v1.944zm0-3.889h.5V241h-1v.972zM425 276v1h1v-1zm-35 0h-1v1h1zm0-35h-1v.972h2V241zm0 2.917h-1v1.944h2v-1.944zm0 3.889h-1v1.944h2v-1.944zm0 3.888h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.944h2v-1.944zm0 3.889h-1v1.944h2v-1.944zm0 3.889h-1V276h2v-.972zm0 .972v1h.972v-2H390zm2.917 0v1h1.944v-2h-1.944zm3.889 0v1h1.944v-2h-1.944zm3.888 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.944v-2h-1.944zm3.889 0v1h1.944v-2h-1.944zm3.889 0v1H425v-2h-.972zm.972 0h1v-.972h-2V276zm0-2.917h1v-1.944h-2v1.944zm0-3.889h1v-1.944h-2v1.944zm0-3.888h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.944h-2v1.944zm0-3.889h1v-1.944h-2v1.944zm0-3.889h1V241h-2v.972z" mask="url(#path-13-inside-2_249_8276-matmul-02-svg)"/></g><path fill="#ea3b40" d="M426 241h35v8h-35z"/><g opacity=".5"><mask id="path-16-inside-3_249_8276-matmul-02-svg" fill="#fff"><path d="M426 241h35v35h-35z"/></mask><path fill="#ea3b40" d="M461 276v.5h.5v-.5zm-35 0h-.5v.5h.5zm0-35h-.5v.972h1V241zm0 2.917h-.5v1.944h1v-1.944zm0 3.889h-.5v1.944h1v-1.944zm0 3.888h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.944h1v-1.944zm0 3.889h-.5v1.944h1v-1.944zm0 3.889h-.5V276h1v-.972zm0 .972v.5h.972v-1H426zm2.917 0v.5h1.944v-1h-1.944zm3.889 0v.5h1.944v-1h-1.944zm3.888 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.944v-1h-1.944zm3.889 0v.5h1.944v-1h-1.944zm3.889 0v.5H461v-1h-.972zm.972 0h.5v-.972h-1V276zm0-2.917h.5v-1.944h-1v1.944zm0-3.889h.5v-1.944h-1v1.944zm0-3.888h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.944h-1v1.944zm0-3.889h.5v-1.944h-1v1.944zm0-3.889h.5V241h-1v.972zM461 276v1h1v-1zm-35 0h-1v1h1zm0-35h-1v.972h2V241zm0 2.917h-1v1.944h2v-1.944zm0 3.889h-1v1.944h2v-1.944zm0 3.888h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.944h2v-1.944zm0 3.889h-1v1.944h2v-1.944zm0 3.889h-1V276h2v-.972zm0 .972v1h.972v-2H426zm2.917 0v1h1.944v-2h-1.944zm3.889 0v1h1.944v-2h-1.944zm3.888 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.944v-2h-1.944zm3.889 0v1h1.944v-2h-1.944zm3.889 0v1H461v-2h-.972zm.972 0h1v-.972h-2V276zm0-2.917h1v-1.944h-2v1.944zm0-3.889h1v-1.944h-2v1.944zm0-3.888h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.944h-2v1.944zm0-3.889h1v-1.944h-2v1.944zm0-3.889h1V241h-2v.972z" mask="url(#path-16-inside-3_249_8276-matmul-02-svg)"/></g><path fill="#160e8a" d="M318 241h35v8h-35z"/><g opacity=".5"><mask id="path-19-inside-4_249_8276-matmul-02-svg" fill="#fff"><path d="M318 241h35v35h-35z"/></mask><path fill="#160e8a" d="M353 276v.5h.5v-.5zm-35 0h-.5v.5h.5zm0-35h-.5v.972h1V241zm0 2.917h-.5v1.944h1v-1.944zm0 3.889h-.5v1.944h1v-1.944zm0 3.888h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.945h1v-1.945zm0 3.889h-.5v1.944h1v-1.944zm0 3.889h-.5v1.944h1v-1.944zm0 3.889h-.5V276h1v-.972zm0 .972v.5h.972v-1H318zm2.917 0v.5h1.944v-1h-1.944zm3.889 0v.5h1.944v-1h-1.944zm3.888 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.945v-1h-1.945zm3.889 0v.5h1.944v-1h-1.944zm3.889 0v.5h1.944v-1h-1.944zm3.889 0v.5H353v-1h-.972zm.972 0h.5v-.972h-1V276zm0-2.917h.5v-1.944h-1v1.944zm0-3.889h.5v-1.944h-1v1.944zm0-3.888h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.945h-1v1.945zm0-3.889h.5v-1.944h-1v1.944zm0-3.889h.5v-1.944h-1v1.944zm0-3.889h.5V241h-1v.972zM353 276v1h1v-1zm-35 0h-1v1h1zm0-35h-1v.972h2V241zm0 2.917h-1v1.944h2v-1.944zm0 3.889h-1v1.944h2v-1.944zm0 3.888h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.945h2v-1.945zm0 3.889h-1v1.944h2v-1.944zm0 3.889h-1v1.944h2v-1.944zm0 3.889h-1V276h2v-.972zm0 .972v1h.972v-2H318zm2.917 0v1h1.944v-2h-1.944zm3.889 0v1h1.944v-2h-1.944zm3.888 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.945v-2h-1.945zm3.889 0v1h1.944v-2h-1.944zm3.889 0v1h1.944v-2h-1.944zm3.889 0v1H353v-2h-.972zm.972 0h1v-.972h-2V276zm0-2.917h1v-1.944h-2v1.944zm0-3.889h1v-1.944h-2v1.944zm0-3.888h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.945h-2v1.945zm0-3.889h1v-1.944h-2v1.944zm0-3.889h1v-1.944h-2v1.944zm0-3.889h1V241h-2v.972z" mask="url(#path-19-inside-4_249_8276-matmul-02-svg)"/></g><g fill="#dfe2e7" clip-path="url(#clip0_249_8276-matmul-02-svg)"><path d="M461 68v35h-35V68z"/><path d="M461 104v35h-35v-35z" opacity=".8"/><path d="M461 140v35h-35v-35z" opacity=".6"/><path d="M461 176v35h-35v-35z" opacity=".4"/><path d="M425 68v35h-35V68z"/><path d="M425 104v35h-35v-35z" opacity=".8"/><path d="M425 140v35h-35v-35z" opacity=".6"/><path d="M425 176v35h-35v-35z" opacity=".4"/><path d="M389 68v35h-35V68z"/><path d="M389 104v35h-35v-35z" opacity=".8"/><path d="M389 140v35h-35v-35z" opacity=".6"/><path d="M389 176v35h-35v-35z" opacity=".4"/><path d="M353 68v35h-35V68z"/><path d="M353 104v35h-35v-35z" opacity=".8"/><path d="M353 140v35h-35v-35z" opacity=".6"/><path d="M353 176v35h-35v-35z" opacity=".4"/></g><path fill="#000" d="M231.398 282.137q.096.014.198.014h.308q1.553 0 2.439-.651.893-.653.893-1.773 0-1.004-.549-1.523-.549-.52-1.597-.52a7 7 0 0 0-.402.014q-.236.015-.528.044l-.491 2.747q-.175 1.032-.271 1.648m-3.09 4.38h.285q.455 0 .645-.257.198-.264.403-1.45l1.062-6.328q.021-.11.036-.205.015-.096.015-.154 0-.3-.205-.439-.198-.147-.608-.147h-.198l.095-.542q.462.043.843.066.38.022.688.022.477 0 1.267-.044.799-.044 1.114-.044 1.347 0 2.102.623.76.615.761 1.699 0 1.033-.659 1.816-.659.777-1.933 1.26l1.113 2.117q.043.095.139.285.93 1.817 1.985 1.817.036 0 .11-.008.08-.007.117-.007l-.088.491a8 8 0 0 1-.564.08q-.227.03-.395.03-.667 0-1.136-.242a1.96 1.96 0 0 1-.769-.754q-.212-.345-.791-1.575-.571-1.23-.923-1.948-.234.022-.476.036-.234.008-.483.008a8 8 0 0 1-.286-.008 7 7 0 0 0-.285-.007l-.418 2.761-.037.271a4 4 0 0 0-.007.183q0 .36.154.476.161.118.666.118h.169l-.095.483a45 45 0 0 1-.681-.029q-.858-.03-1.099-.03-.374 0-1.318.044-.257.007-.411.015zm11.55-2.82.073-.037q2.608-1.334 2.608-2.058a.93.93 0 0 0-.279-.674.88.88 0 0 0-.652-.285q-.578 0-1.04.798-.46.798-.71 2.256m2.204-.506-2.241 1.158v.073q0 .872.271 1.326.279.454.799.454.307 0 .769-.271.468-.279 1.194-.894l.256.462q-1.047.966-1.67 1.34-.615.373-1.121.373-.768 0-1.245-.666-.476-.666-.476-1.751 0-.768.249-1.648.257-.885.659-1.545.506-.805 1.158-1.245t1.347-.44q.71 0 1.187.455.483.446.483 1.091 0 .52-.293.864-.285.337-1.326.864m6.343 1.187.55-3.318a4 4 0 0 0-.718-.337 1.8 1.8 0 0 0-.586-.11q-.901 0-1.516 1.158-.615 1.149-.615 2.871 0 .695.161 1.054.168.36.49.359.22 0 .813-.447.601-.446 1.421-1.23m.015.747-1.245 1.128q-.549.498-.879.688-.323.19-.608.191-.659 0-1.011-.557-.351-.564-.351-1.618 0-2.08 1.047-3.575 1.054-1.494 2.505-1.494.293 0 .593.081.308.073.637.219l.418-2.651q.022-.153.029-.308.015-.16.015-.322 0-.292-.117-.403-.118-.11-.432-.109-.096 0-.198.007a3 3 0 0 0-.213.007l-.029-.432q.608-.059 1.223-.161.623-.102 1.253-.249-.681 3.515-1.121 6.35-.44 2.828-.439 3.435 0 .374.065.527a.245.245 0 0 0 .235.147.4.4 0 0 0 .205-.073 2 2 0 0 0 .308-.242l.446-.403.242.418-.842.827q-.44.425-.637.542a.75.75 0 0 1-.381.117q-.389 0-.572-.366-.175-.366-.175-1.135a5 5 0 0 1 .029-.586m10.071.645-1.011.944a2 2 0 0 1-.491.374.95.95 0 0 1-.439.11q-.33 0-.535-.315-.198-.323-.198-.857 0-.155.022-.366.03-.22.11-.681-1.355 1.384-1.919 1.801t-.959.418q-.418 0-.696-.388t-.278-.997q0-.512.439-2.307.11-.425.161-.644.154-.608.227-.974.074-.374.074-.557a.35.35 0 0 0-.074-.234.22.22 0 0 0-.183-.096q-.073 0-.285.103a10 10 0 0 0-.586.315l-.205-.403q.681-.505 1.193-.784.513-.285.725-.285a.53.53 0 0 1 .469.256q.176.256.176.711 0 .57-.454 2.211-.447 1.642-.447 2.461 0 .256.088.381.088.117.271.117.206 0 .696-.402.498-.411 1.662-1.56.279-1.319.447-2.227.176-.915.271-1.633l1.319-.315-.162.725a91 91 0 0 0-.454 1.985l-.175.937q-.132.667-.213 1.275a8 8 0 0 0-.073.857q0 .168.066.263a.2.2 0 0 0 .176.095q.102 0 .38-.197.279-.198.638-.535zm5.302-4.593-.388.381q-.483-.49-.776-.652a1.2 1.2 0 0 0-.586-.161q-.674 0-1.172 1.004-.498.996-.498 2.46 0 .982.256 1.48.257.498.755.498.278 0 .762-.315a6.3 6.3 0 0 0 1.018-.879l.3.52q-.85.901-1.45 1.304-.601.395-1.099.395-.791 0-1.267-.688-.47-.688-.469-1.86 0-2.007 1.026-3.384 1.032-1.377 2.541-1.377.55 0 .938.234.395.234.395.535a.5.5 0 0 1-.066.234 1 1 0 0 1-.22.271m3.999-2.937q-.138.49-.388 1.538-.073.308-.11.454.433 0 .879-.007.454-.015.952-.037l-.175.733a12 12 0 0 0-.44-.007h-1.362q-.344 1.508-.513 2.636-.16 1.128-.161 1.89 0 .322.103.505.11.183.3.183.147 0 .461-.234t.857-.754l.257.468q-1.055 1.084-1.451 1.385-.394.293-.666.293-.506 0-.806-.476-.3-.477-.3-1.297 0-.534.168-1.531.169-1.003.638-3.105-.117 0-.308.007l-.249.008h-.505l.088-.491q.336-.015.615-.117.285-.103.571-.323.066-.263.147-.549.087-.292.197-.615zm4.842 7.097.256.433q-.9.93-1.252 1.186t-.623.256a.73.73 0 0 1-.622-.322q-.235-.33-.235-.879 0-.688.432-2.3.44-1.611.44-2.321 0-.183-.088-.293a.28.28 0 0 0-.227-.11.75.75 0 0 0-.308.095 4 4 0 0 0-.476.293l-.22-.388.975-.711q.277-.204.483-.293a.9.9 0 0 1 .388-.095q.345 0 .542.286.205.278.205.769 0 .534-.381 2.095l-.131.527a33 33 0 0 0-.315 1.37q-.103.541-.103.747 0 .183.081.3a.24.24 0 0 0 .205.117q.117 0 .307-.146.19-.147.667-.616m-.059-9.441.418.469q.175.183.241.33a.6.6 0 0 1 .074.285.47.47 0 0 1-.11.293 1.1 1.1 0 0 1-.308.264l-.644.359-.469-.557a1.4 1.4 0 0 1-.191-.285.6.6 0 0 1-.044-.227q0-.169.088-.293a.9.9 0 0 1 .301-.257zm4.592 4.732q-.849 0-1.464 1.164-.616 1.165-.616 2.872 0 .9.308 1.377.315.476.908.476.894 0 1.516-1.143.63-1.15.63-2.812 0-.99-.315-1.458-.315-.476-.967-.476m.315-.711q1.092 0 1.656.682.571.674.571 1.977 0 .747-.293 1.597a5.8 5.8 0 0 1-.791 1.523q-.534.734-1.216 1.128a2.8 2.8 0 0 1-1.421.388q-.98 0-1.567-.71-.579-.71-.579-1.904 0-.886.286-1.729.286-.842.82-1.523a4 4 0 0 1 1.194-1.055q.674-.374 1.34-.374m5.406 2.103 1.186-1.158q.623-.593.938-.783.322-.19.608-.191.483 0 .783.425.308.425.308 1.121 0 .71-.359 2.197-.359 1.479-.359 2.109 0 .19.073.293.073.096.213.095a.36.36 0 0 0 .161-.051 1 1 0 0 0 .198-.154l.556-.542.257.389-.799.813q-.285.293-.571.461-.278.168-.491.168a.72.72 0 0 1-.6-.315q-.227-.321-.227-.842 0-.623.373-2.19.374-1.575.374-2.292a.7.7 0 0 0-.117-.432.34.34 0 0 0-.301-.169q-.286 0-1.75 1.355-.389.358-.608.564l-.462 2.578-.043.22q-.154.783-.184 1.201l-1.303.322q.483-2.101.761-3.654.286-1.553.286-2.037 0-.292-.066-.417a.22.22 0 0 0-.212-.132q-.089 0-.293.103a6 6 0 0 0-.506.3l-.197-.388.234-.191q1.128-.908 1.509-.908.366 0 .542.279.176.27.176.849 0 .205-.022.462-.022.255-.066.542"/><path fill="#000" d="M288.354 266.354a.5.5 0 0 0 0-.708l-3.182-3.182a.502.502 0 0 0-.708.708l2.829 2.828-2.829 2.828a.502.502 0 0 0 .708.708zM152 266v.5h136v-1H152z"/><path fill="#000" d="M480.65 211.354a.5.5 0 0 0 .707 0l3.182-3.182a.5.5 0 1 0-.707-.708l-2.828 2.829-2.829-2.829a.5.5 0 0 0-.707.708zM481.004 95h-.5v116h1V95z"/><path fill="#000" d="M383.318 23.548q.344.03.666.044.33.015.645.015.234 0 .549-.015t.681-.044a3 3 0 0 0 .264.498q.168.257.425.564l6.042 7.149a461 461 0 0 1-.044-2.952q-.059-3.86-.131-4.153-.089-.336-.315-.468-.22-.132-.725-.132h-.228v-.506q.089 0 .264.008 1.04.05 1.465.05.432 0 1.509-.05.153-.008.234-.008l-.007.506a1 1 0 0 0-.095-.008 1 1 0 0 0-.14-.007q-.981 0-.996 2.732-.007.689-.007 1.077l-.029 1.948q-.015.432-.022.893v1.253q0 .886.022 1.384.022.49.073.791h-.813q-.124-.293-.886-1.172l-.073-.088-6.285-7.39v.169q.044 6.855.147 7.25.087.338.307.47.228.13.718.131h.22V34a11 11 0 0 0-.322-.015q-1.026-.044-1.399-.044-.36 0-.799.015-.432.014-.915.044v-.505q.044 0 .095.007h.147q.981 0 .996-2.717.007-.69.007-1.077l.037-1.948q.007-.63.007-1.223.007-.6.007-1.37 0-.63-.241-.872-.243-.24-.857-.241h-.198z"/><path stroke="#000" d="M337 58V43.5h103V58"/><path fill="#000" d="M35.089 244.236q.168.015.359.022h.586q.417 0 .769-.015.359-.015.688-.051a2.7 2.7 0 0 0 .806-.857q.27-.483.27-1.062 0-.93-.592-1.465-.594-.542-1.626-.542-.227 0-.528.029-.293.03-.666.088-.023.982-.044 2.278-.015 1.296-.022 1.575m.014 4.812q.426.124.835.19.41.059.799.059 1.2 0 1.86-.586t.66-1.633q0-1.114-.74-1.648-.74-.543-2.27-.542-.25 0-.506.007-.25 0-.652.022 0 .308-.008.908-.006.594-.007.872 0 .454.008.967zm-2.592.476.095.015h.146q.975 0 .99-2.74.006-.689.014-1.076l.03-2q.006-.645.006-1.252.008-.609.008-1.319 0-.63-.235-.871-.234-.242-.834-.242h-.06v-.513q.47.037.916.052.454.014.916.014.513 0 1.26-.029.747-.036.974-.037 1.51 0 2.38.674.88.667.88 1.802 0 .799-.433 1.384-.424.58-1.414 1.121 1.29.249 1.927.879t.637 1.662q0 1.34-1.062 2.161-1.062.82-2.835.82-.322 0-1.208-.036-.886-.037-1.465-.037-.242 0-.674.015a40 40 0 0 0-.96.044zm15.813-.586.205.461q-.549.396-1.004.608-.454.22-.732.22-.468 0-.703-.271-.234-.278-.257-.835-.798.535-1.325.769-.528.228-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.162 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.96-.366-.63 0-.995.234-.36.227-.36.623 0 .036.008.102l.007.088q0 .228-.22.381a.93.93 0 0 1-.527.147q-.263 0-.388-.088-.124-.088-.124-.271 0-.586.988-1.304.989-.725 2.044-.725 1.018 0 1.545.564.528.557.528 1.64 0 .587-.074 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.38.169a1 1 0 0 0 .301-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.38 1.538 0 .484.307.791.307.301.813.301.308 0 .71-.161.403-.162.938-.513zm4.988-5.039.483.147q-.043.402-.073.725-.021.315-.03.622h.52q.419 0 .85-.007.433-.015.872-.036l-.176.798a14 14 0 0 0-.886-.044q-.41-.015-.82-.015h-.345l-.065 1.934q-.015.666-.015 1.106 0 1.655.227 2.16.227.5.813.499.242 0 .535-.103.3-.103.725-.337l.241.483a8 8 0 0 1-1.274.645q-.57.212-.996.212-.784 0-1.143-.534-.359-.543-.359-1.736 0-.234.03-1.67.036-1.443.036-2.644-.066 0-.19.007-.608.022-.835.022v-.527q.717-.102 1.187-.527.468-.433.688-1.18m9.17 7.134.366.557q-.71.542-1.399.82a3.5 3.5 0 0 1-1.303.278q-1.437 0-2.344-1.025-.909-1.032-.909-2.637 0-1.662 1.15-2.812t2.806-1.15q.85 0 1.31.242.462.234.462.659a.8.8 0 0 1-.19.534q-.184.22-.425.22-.08 0-.681-.366-.594-.374-1.136-.374-.951 0-1.516.689-.555.681-.556 1.86 0 1.486.673 2.322.682.828 1.883.828.447 0 .886-.154.446-.154.923-.491m3.362-9.88q-.03 1.23-.052 2.512t-.029 2.629q.82-.622 1.465-.915.644-.3 1.172-.3 1.077 0 1.618.607.543.609.543 1.824l-.008.645q-.007.637-.007 1.274 0 .272-.008.681a36 36 0 0 0-.007.55q0 .82.147 1.069.146.249.556.249l.08-.007a1 1 0 0 1 .103-.008V250a54 54 0 0 0-1.003-.059 15 15 0 0 0-.557-.014q-.351 0-.761.022-.404.014-.843.051l-.007-.513h.11q.938 0 .96-1.714v-.146l.014-1.575v-.3q0-1.333-.315-1.765-.315-.44-1.084-.44-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.036 2.608q0 .219-.008.564a27 27 0 0 0-.007.476q0 .907.146 1.179.147.271.564.271.03 0 .088-.007a1 1 0 0 1 .103-.008V250a20 20 0 0 0-.872-.051 13 13 0 0 0-1.362-.008q-.375.015-.974.052v-.506q.043 0 .124.008.081.007.117.007.506 0 .681-.264.177-.27.176-1.56v-.542l.03-5.508v-1.259q0-.315-.14-.469-.131-.162-.402-.161-.103 0-.337.044l-.08.014-.11-.476q.6-.117 1.178-.271.579-.161 1.158-.373m15.82-.183.374.388q-1.356 1.501-2.051 3.222a9.5 9.5 0 0 0-.696 3.575q0 1.852.696 3.508t2.11 3.201l-.389.446q-1.838-1.42-2.747-3.222-.9-1.802-.9-4.05 0-2.103.915-3.904.922-1.802 2.688-3.164m7.53 8.943 2.116-4.805.088-.198q1.047-2.366 1.047-2.798a.2.2 0 0 0-.007-.044.2.2 0 0 1-.007-.044q.431.022.776.037a29 29 0 0 0 1.216 0q.336-.015.74-.037v.506h-.088q-.637 0-.88.219-.234.22-.234.784 0 .22.03.982.03.761.073 1.648l.124 2.058.008.197q.16 2.74.249 3.099.045.212.27.329.228.117.594.117h.183V250q-.58-.03-1.076-.044a28 28 0 0 0-.828-.015q-.389 0-.872.015t-1.032.044v-.527q.065 0 .168.007a2 2 0 0 0 .147.007q.556 0 .768-.197.22-.199.22-.718a15 15 0 0 0-.029-.96l-.286-6.299-3.003 6.907-.029.066a6.6 6.6 0 0 0-.52 1.546h-.483q-.103-.454-.513-1.392l-.03-.066-2.951-6.687q-.044.783-.124 2.153-.206 3.398-.206 4.256v.073q0 .93.206 1.128.212.19.856.19h.154V250a32 32 0 0 0-1.758-.059q-.292 0-.732.015a37 37 0 0 0-.93.044v-.513h.205q.417 0 .623-.102a.7.7 0 0 0 .322-.359q.14-.3.285-2.432.037-.585.066-.93l.132-1.772v-.022q.198-2.63.198-2.989 0-.46-.227-.644-.22-.183-.842-.183h-.118v-.506q.06 0 .19.008.85.051 1.187.051.257 0 .974-.044.228-.015.345-.015v.044q0 .653 2.483 6.153zm7.543-8.943q1.758 1.362 2.674 3.171.915 1.802.915 3.897 0 2.248-.9 4.057-.901 1.802-2.733 3.215l-.388-.446q1.413-1.539 2.11-3.179a8.8 8.8 0 0 0 .695-3.442q0-1.92-.688-3.641-.69-1.721-2.058-3.244zm11.602 8.012h8.774v.857h-8.774zm0-2.805h8.774v.857h-8.774zm19.863-4.292a83 83 0 0 0-.102 2.82q-.03 1.45-.03 3.875 0 .278-.014.732-.008.454-.008.63 0 1.304.257 1.67.263.366.988.366.045 0 .147-.007.102-.008.154-.008V250q-.66-.03-1.245-.044-.579-.015-1.048-.015-.381 0-.945.015-.556.014-1.23.044v-.498h.227q.777 0 1.047-.154.272-.153.374-.608.066-.278.11-1.919.044-1.64.044-4.094 0-.38-.022-1.15l-.022-1.098q-.425.006-.901.051-.477.036-1.018.11l-.095-.557a48 48 0 0 0 3.332-.674"/><defs><clipPath id="clip0_249_8276-matmul-02-svg"><path fill="#fff" d="M461 68v143H318V68z"/></clipPath></defs></svg>
<figcaption><b>Padded Tensor-Core Instructions</b> If the batch size is too small, we may be in our situation where we can't fit even one of our 2D tiles in the output. In this case, it is most efficient to switch to a smaller tensor-core instruction or eschew tensor-cores altogether! However, both of these options prevent our kernel from being batch-invariant.</figcaption>
</figure>
<p>So, the easiest way to ensure batch invariance for matmuls is to compile one kernel configuration and use that for all shapes. Although we will lose some performance, this isn&rsquo;t typically disastrous in LLM inference. In particular, split-k is most needed when <strong>both</strong> M and N are small, and luckily in our case, N (i.e. the model dim) is usually pretty large!</p>
<figure class="chart-line"
        data-src="/data/batch-vs-cublas.txt"
        data-seriesmeta='{"names":["CuBLAS","Batch-Invariant"],"colors":["var(--blue)","#f59e0b"]}'
        data-show-points="false"
        data-smooth="5"
        data-x='{"label":"Batch-size","ticks":[0,1000,2000,3000,4000,5000,6000,7000,8200]}'
        data-y='{"label":"TFLOPs","ticks":[0,100,200,300,400,500,600,700]}'
        data-labels='{"CuBLAS":{"x":7700,"y":668,"dx":-4,"dy":-8},"Batch-Invariant":{"x":7700,"y":590,"dx":-4,"dy":-8}}'
        data-series='[{"lineWidth":1.4},{"lineWidth":1.4}]'>
  <figcaption>Despite obtaining batch invariance, we only lose about 20% performance compared to cuBLAS. Note that this is not an optimized Triton kernel either (e.g. no TMA). However, some of the patterns in performance are illustrative of where our batch-invariant requirement loses performance. First, note that we lose a significant amount of performance at very small batch sizes due to an overly large instruction and insufficient parallelism. Second, there is a "jigsaw" pattern as we increase the batch-size that is caused by quantization effects (both tile and wave) that are typically ameliorated through changing tile sizes. You can find more on these quantization effects <a href="https://www.thonking.ai/p/what-shapes-do-matrix-multiplications">here</a>.</figcaption>
  <svg viewBox="0 0 800 520" width="100%" height="auto"></svg>
</figure>
<h3 id="batch-invariant-attention">Batch-invariant attention</h3>
<figure class="half-width">
<svg xmlns="http://www.w3.org/2000/svg" width="416" height="438" fill="none" viewBox="0 0 416 438"><path fill="#f5f5f5" d="M0 0h416v438H0z"/><path fill="#fff" d="M0 0h416v438H0z"/><path fill="#000" d="m48.311 264.817 1.677 1.011q1.23.725 1.956.988.724.271 1.377.271.212 0 .498-.036.285-.037.688-.117l.088.454q-1.04.292-1.545.381a5 5 0 0 1-.886.095q-1.56 0-5.215-2.476l-.3-.205q-.053 0-.162.007a2 2 0 0 1-.154.008q-2.24 0-3.706-1.538-1.457-1.539-1.457-3.882 0-1.172.432-2.197a5.55 5.55 0 0 1 1.267-1.824 5.1 5.1 0 0 1 1.67-1.077 5.2 5.2 0 0 1 1.956-.373q1.098 0 1.97.322a4.7 4.7 0 0 1 1.59.981 5.6 5.6 0 0 1 1.31 1.875 5.7 5.7 0 0 1 .454 2.249q0 1.817-.915 3.149-.916 1.334-2.593 1.934m1.89-4.827q0-2.131-1.099-3.493-1.098-1.37-2.768-1.37-1.605 0-2.579 1.172-.966 1.172-.966 3.135 0 2.204 1.105 3.588 1.106 1.377 2.813 1.377 1.567 0 2.527-1.201.966-1.208.967-3.208"/><path fill="#000" d="M195.883 103.548q.468.03.93.044.462.015.901.015.315 0 .725-.015t.901-.044v.491h-.066q-.835 0-1.604.725l-.073.073-3.633 3.479 3.347 3.362.374.374q1.413 1.45 2.072 1.45h.125l.066-.015.007.513q-.117-.008-.315-.015a22 22 0 0 0-1.04-.044q-.278 0-.637.015-.351.014-.755.044.008-.022.008-.029a.1.1 0 0 0 .007-.044q0-.381-2.336-2.703a258 258 0 0 1-2.3-2.322l2.82-3.047q.19-.212.52-.556.74-.798.74-.945a.24.24 0 0 0-.147-.234q-.14-.081-.454-.081h-.183zm-5.83 0a34 34 0 0 0 1.86.059 29 29 0 0 0 1.875-.059v.491h-.095q-.66 0-.886.33-.22.329-.22 1.699v5.354q0 1.435.212 1.758.213.322.85.322.036 0 .117-.007.08-.008.125-.008V114a43 43 0 0 0-1.978-.059q-.337 0-.828.015t-1.076.044v-.505q.044 0 .095.007h.139q.579 0 .784-.403.212-.41.212-1.816 0-.19-.007-.718a62 62 0 0 1-.007-.857v-1.948q0-.366.007-.93.007-.572.007-.777 0-1.267-.212-1.64-.205-.374-.784-.374-.022 0-.088.007a1 1 0 0 1-.102.008z"/><path fill="#000" d="M169.366 348.863q0 .543.059 1.07.066.527.198 1.04l-.572.11q-.124-.909-.703-1.348-.571-.44-1.619-.44-.966 0-1.574.469-.601.469-.601 1.209 0 1.216 2.578 2.08.345.11.528.176 1.179.41 1.736 1.054.556.637.556 1.582 0 1.457-1.106 2.366-1.106.901-2.929.901-.696 0-1.363-.117a8 8 0 0 1-1.34-.352q.007-.073.007-.168.008-.103.008-.293a9 9 0 0 0-.235-2.036l.659-.154q.125 1.2.755 1.758.63.556 1.867.556 1.084 0 1.766-.542.681-.55.681-1.406 0-1.216-2.124-1.89a14 14 0 0 1-.469-.154q-1.473-.476-2.109-1.164-.638-.689-.638-1.758 0-1.26.996-2.102t2.498-.842q.549 0 1.113.088.564.087 1.377.307m7.302 8.694.367.557a6 6 0 0 1-1.399.82 3.5 3.5 0 0 1-1.304.278q-1.435 0-2.344-1.025-.908-1.032-.908-2.637 0-1.662 1.15-2.812t2.805-1.15q.85 0 1.311.242.462.234.462.659a.8.8 0 0 1-.191.534q-.183.22-.425.22-.08 0-.681-.366-.593-.374-1.135-.374-.952 0-1.516.689-.557.681-.557 1.86 0 1.486.674 2.322.681.828 1.882.828.447 0 .887-.154.446-.154.922-.491m4.659-5.185q-.982 0-1.582.717-.594.711-.594 1.919 0 1.546.66 2.505.666.96 1.728.96 1.026 0 1.633-.762.616-.762.616-2.073 0-1.436-.696-2.351-.689-.915-1.765-.915m.19-.769q1.545 0 2.556 1.04 1.018 1.033 1.018 2.563 0 1.684-1.069 2.842-1.07 1.15-2.637 1.15t-2.578-1.055q-1.003-1.055-1.003-2.666t1.091-2.739q1.098-1.135 2.622-1.135m6.797-.088q-.051.498-.081 1.01-.029.505-.044 1.077.594-1.047 1.092-1.509.505-.46 1.04-.461.417 0 .659.227.242.22.242.6a.72.72 0 0 1-.161.469.46.46 0 0 1-.367.191q-.131 0-.41-.14-.27-.146-.469-.146-.38 0-.761.337-.38.33-.799 1.033v.805q0 1.172.015 1.905.022.725.059.922.065.373.278.513.22.14.74.139h.212V359q-.571-.043-1.018-.066a15 15 0 0 0-1.633 0q-.447.022-.938.066v-.513h.169q.534 0 .725-.256.19-.257.19-1.194v-3.149q0-.792-.11-1.018-.11-.227-.402-.227-.06 0-.125.007-.066 0-.22.022l-.088-.454a13 13 0 0 0 1.07-.293q.549-.176 1.135-.41m9.924 3.391h-3.574q-.417 0-.769.014t-.652.044v.271q0 1.435.659 2.22.667.783 1.875.783.535 0 1.055-.176.52-.183 1.106-.563l.286.468a6.1 6.1 0 0 1-1.509.93q-.747.315-1.48.315-1.42 0-2.343-1.01-.924-1.018-.923-2.608 0-1.692.967-2.842.966-1.149 2.358-1.149 1.297 0 2.065.864.77.864.879 2.439m-1.355-.769q-.219-.901-.666-1.377-.447-.484-1.07-.484-.702 0-1.208.564-.498.564-.652 1.524 1.45 0 2.278-.052.835-.05 1.318-.175m7.281-2.234q0 .447.044.901.05.454.139.915l-.557.088q-.088-.762-.483-1.135-.396-.374-1.106-.374-.615 0-1.011.337-.396.33-.396.843 0 .812 1.729 1.289l.461.124q.865.242 1.26.689.403.446.403 1.171 0 1.07-.842 1.766-.835.695-2.146.695-.477 0-.974-.102a6 6 0 0 1-1.018-.308q.006-.073.007-.154.007-.08.007-.249 0-.336-.044-.725a9 9 0 0 0-.117-.835l.549-.131q.117.907.572 1.362.453.447 1.259.447.734 0 1.194-.352.47-.359.469-.923 0-.79-1.553-1.26l-.227-.073q-1.113-.336-1.567-.827-.447-.491-.447-1.304 0-.938.747-1.553.747-.622 1.912-.622.359 0 .776.073a9 9 0 0 1 .96.227m11.755-4.321.784.366q-2.871 5.339-4.322 8.071a275 275 0 0 0-2.277 4.373l-.784-.345a710 710 0 0 0 3.757-6.987 287 287 0 0 0 2.842-5.478m7.91 6.35q.308.043.557.066.249.022.49.022 1.377 0 2.088-.608.717-.616.718-1.795 0-1.062-.703-1.692t-1.905-.63q-.33 0-.63.03a6 6 0 0 0-.578.073q-.022.989-.03 1.999-.006 1.003-.007 2.535m-2.607 4.592.11.015h.175q.587 0 .791-.396.213-.403.213-1.78 0-.204-.008-.754a90 90 0 0 1-.007-.886v-4.585q0-.63-.227-.865-.226-.234-.828-.234h-.058v-.513q.497.037.989.052.498.014.981.014.542 0 1.289-.029.755-.037.974-.037 1.605 0 2.564.799.959.798.959 2.102 0 1.545-1.055 2.409-1.047.858-2.966.857-.19 0-.52-.022a22 22 0 0 1-.769-.066v2.205q0 1.128.227 1.421.234.285.93.286l.074-.008.087-.007q.037 0 .052.007.022 0 .036.008l.008.483a38 38 0 0 0-2.146-.059q-.257 0-.755.015-.49.014-1.12.044z"/><path fill="#000" d="M345.201 255.99q0-2.131-1.099-3.493-1.098-1.37-2.769-1.37-1.603 0-2.578 1.172-.966 1.172-.966 3.135 0 2.183 1.098 3.581 1.107 1.4 2.761 1.399 1.597 0 2.571-1.201.982-1.209.982-3.223m-3.706-5.683q1.113 0 1.984.322.879.315 1.59.981.849.806 1.296 1.868.454 1.062.454 2.256a5.65 5.65 0 0 1-.476 2.3 5.4 5.4 0 0 1-1.355 1.867q-.702.63-1.64.989a5.2 5.2 0 0 1-1.868.352 5.3 5.3 0 0 1-2.161-.432 5 5 0 0 1-1.736-1.282 5.6 5.6 0 0 1-1.054-1.743 5.8 5.8 0 0 1-.359-2.036q0-1.157.432-2.183a5.3 5.3 0 0 1 1.267-1.809 5.3 5.3 0 0 1 1.685-1.077 5.2 5.2 0 0 1 1.941-.373"/><path fill="#000" d="M335.584 88.548q.55.03 1.04.044a29 29 0 0 0 1.816 0q.491-.014 1.004-.044l-.007.462q-.616.051-.821.16-.198.11-.198.382 0 .204.074.52.08.307.278.857l2.205 6.167q1.764-4.43 2.219-5.743.46-1.318.461-1.728 0-.337-.183-.461-.175-.125-.82-.154v-.462a27 27 0 0 0 1.706.059q.352 0 .784-.015t.901-.044v.462h-.11q-.806 0-1.37 1.42a9 9 0 0 1-.205.499 533 533 0 0 0-2.658 6.452q-.594 1.494-.623 1.736h-.901q0-.175-.681-2.19a134 134 0 0 0-1.648-4.563l-.19-.52q-1.062-2.85-1.875-2.849a1 1 0 0 0-.117.007l-.081.008z"/><g clip-path="url(#clip0_249_8276-attention-01-svg)"><path fill="#ef402c" d="M124.481 185h35v35h-35z"/><path fill="#ef402c" d="M160.481 185h35v35h-35z" opacity=".75"/><path fill="#ef402c" d="M196.481 185h35v35h-35z" opacity=".5"/><path fill="#ef402c" d="M232.481 185h35v35h-35z" opacity=".25"/><path fill="#f78427" d="M124.481 221h35v35h-35z"/><path fill="#f78427" d="M160.481 221h35v35h-35z" opacity=".75"/><path fill="#f78427" d="M196.481 221h35v35h-35z" opacity=".5"/><path fill="#f78427" d="M232.481 221h35v35h-35z" opacity=".25"/><path fill="#ffa8aa" d="M124.481 257h35v35h-35z"/><path fill="#ffa8aa" d="M160.481 257h35v35h-35z" opacity=".75"/><path fill="#ffa8aa" d="M196.481 257h35v35h-35z" opacity=".5"/><path fill="#ffa8aa" d="M232.481 257h35v35h-35z" opacity=".25"/><path fill="#824665" d="M124.481 293h35v35h-35z"/><path fill="#824665" d="M160.481 293h35v35h-35z" opacity=".75"/><path fill="#824665" d="M196.481 293h35v35h-35z" opacity=".5"/><path fill="#824665" d="M232.481 293h35v35h-35z" opacity=".25"/></g><path fill="#e7e1df" d="M124.481 132a2 2 0 0 1 2-2h33v35h-35z"/><path fill="#e7e1df" d="M160.481 130h35v35h-35z" opacity=".75"/><path fill="#e7e1df" d="M196.481 130h35v35h-35z" opacity=".5"/><path fill="#e7e1df" d="M232.481 130h35v35h-35z" opacity=".25"/><path fill="#ef402c" d="M69.481 184h35v35h-35z"/><path fill="#f78427" d="M69.481 220h35v35h-35z"/><path fill="#ffa8aa" d="M69.481 256h35v35h-35z"/><path fill="#824665" d="M69.481 292h35v35h-35z"/><path fill="#ef402c" d="M287.481 184h35v35h-35z"/><path fill="#f78427" d="M287.481 220h35v35h-35z"/><path fill="#ffa8aa" d="M287.481 256h35v35h-35z"/><path fill="#824665" d="M287.481 292h35v35h-35z"/><path fill="#e7e1df" d="M287.481 22h35v35h-35z"/><path fill="#e7e1df" d="M287.481 58h35v35h-35z" opacity=".75"/><path fill="#e7e1df" d="M287.481 94h35v35h-35z" opacity=".5"/><path fill="#e7e1df" d="M287.481 130h35v35h-35z" opacity=".25"/><path fill="#000" d="M375.166 161.74a.5.5 0 0 0 .707 0l3.182-3.182a.5.5 0 0 0-.707-.707l-2.828 2.829-2.829-2.829a.5.5 0 0 0-.707.707zm.354-116.353h-.5v116h1v-116z"/><path fill="#000" d="M210.88 406.137q.094.014.198.014h.307q1.553 0 2.439-.651.894-.653.894-1.773 0-1.004-.55-1.523-.549-.52-1.596-.52-.162 0-.403.014-.234.015-.527.044-.308 1.714-.491 2.747-.176 1.033-.271 1.648m-3.091 4.38h.286q.453 0 .644-.257.198-.264.403-1.45l1.062-6.328q.022-.11.037-.205.014-.096.014-.154 0-.3-.205-.439-.198-.147-.608-.147h-.197l.095-.542q.46.043.842.066.381.022.689.022.475 0 1.267-.044a24 24 0 0 1 1.113-.044q1.347 0 2.102.623.762.615.762 1.699 0 1.032-.659 1.816-.66.777-1.934 1.26l1.113 2.117.139.285q.931 1.817 1.985 1.817.037 0 .11-.008.081-.007.117-.007l-.088.491a7 7 0 0 1-.564.08q-.227.03-.395.03-.666 0-1.135-.242a1.96 1.96 0 0 1-.769-.754q-.213-.345-.791-1.575-.572-1.23-.923-1.948-.234.022-.476.036a8 8 0 0 1-.769 0 7 7 0 0 0-.286-.007l-.417 2.761-.037.271a3 3 0 0 0-.007.183q0 .36.153.476.162.118.667.118h.168l-.095.483a45 45 0 0 1-.681-.029q-.857-.03-1.099-.03-.373 0-1.318.044-.257.008-.41.015zm11.55-2.82.074-.037q2.607-1.334 2.607-2.058a.94.94 0 0 0-.278-.674.88.88 0 0 0-.652-.285q-.58 0-1.04.798-.462.798-.711 2.256m2.205-.506-2.241 1.158v.073q0 .871.271 1.326a.88.88 0 0 0 .798.454q.307 0 .769-.271.47-.279 1.194-.894l.256.462q-1.047.966-1.67 1.34-.615.373-1.12.373-.77 0-1.245-.666-.477-.666-.476-1.751 0-.768.249-1.648.256-.885.659-1.545.505-.806 1.157-1.245t1.348-.44q.71 0 1.186.455.484.446.484 1.091 0 .52-.293.864-.286.337-1.326.864m6.343 1.187.549-3.318a4 4 0 0 0-.718-.337 1.8 1.8 0 0 0-.586-.11q-.9 0-1.516 1.158-.615 1.149-.615 2.871 0 .695.161 1.054.168.36.491.359.219 0 .813-.447.6-.446 1.421-1.23m.014.747-1.245 1.128q-.549.498-.879.688-.322.19-.608.191-.659 0-1.01-.557-.352-.564-.352-1.618 0-2.08 1.047-3.575 1.056-1.494 2.505-1.494.293 0 .594.081.307.074.637.219l.417-2.651q.022-.153.03-.308.014-.16.014-.322 0-.292-.117-.403-.117-.11-.432-.109-.095 0-.198.007-.095 0-.212.007l-.03-.432q.608-.059 1.224-.161.622-.102 1.252-.249-.681 3.515-1.121 6.35-.439 2.828-.439 3.435 0 .374.066.527a.245.245 0 0 0 .234.147.4.4 0 0 0 .205-.073 2 2 0 0 0 .308-.242l.447-.403.241.418-.842.827q-.44.425-.637.542a.75.75 0 0 1-.381.117q-.388 0-.571-.366-.176-.366-.176-1.135a7 7 0 0 1 .029-.586m10.071.645-1.011.944q-.27.264-.49.374a.95.95 0 0 1-.44.11q-.33 0-.534-.315-.198-.323-.198-.857 0-.155.022-.366.029-.22.11-.681-1.356 1.384-1.919 1.801-.564.418-.96.418-.417 0-.696-.388t-.278-.997q0-.512.44-2.307.11-.425.161-.644.153-.608.227-.974.073-.374.073-.557a.35.35 0 0 0-.073-.234.22.22 0 0 0-.183-.096q-.073 0-.286.103a10 10 0 0 0-.586.315l-.205-.403q.681-.505 1.194-.784.513-.285.725-.285.3 0 .469.256.175.257.175.711 0 .57-.454 2.211-.446 1.642-.446 2.461 0 .256.087.381.088.117.271.117.206 0 .696-.402.499-.411 1.663-1.56.278-1.319.447-2.227.175-.915.271-1.633l1.318-.315-.161.725a85 85 0 0 0-.454 1.985l-.176.937q-.132.667-.212 1.275a8 8 0 0 0-.074.857q0 .168.066.263a.2.2 0 0 0 .176.095q.102 0 .381-.197.278-.198.637-.535zm5.303-4.593-.388.381q-.484-.49-.777-.652a1.2 1.2 0 0 0-.586-.161q-.673 0-1.171 1.004-.498.996-.499 2.46 0 .982.257 1.48.256.498.754.498.279 0 .762-.315a6.3 6.3 0 0 0 1.018-.879l.3.52q-.849.901-1.45 1.304-.6.395-1.099.395-.79 0-1.267-.688-.468-.688-.468-1.86 0-2.007 1.025-3.384 1.033-1.377 2.542-1.377.549 0 .937.234.396.234.396.535a.5.5 0 0 1-.066.234 1 1 0 0 1-.22.271m3.999-2.937q-.14.49-.388 1.538l-.11.454q.432 0 .879-.007.454-.015.952-.037l-.176.733a12 12 0 0 0-.439-.007h-1.363a36 36 0 0 0-.512 2.636 14 14 0 0 0-.161 1.89q0 .322.102.505.11.183.3.183.147 0 .462-.234t.857-.754l.256.468q-1.054 1.084-1.45 1.385-.396.293-.667.293-.505 0-.805-.476-.3-.477-.301-1.297 0-.534.169-1.531.168-1.003.637-3.105-.117 0-.308.007l-.249.008h-.505l.088-.491q.337-.015.615-.117.286-.103.572-.323.065-.263.146-.549.089-.293.198-.615zm4.841 7.097.257.433q-.901.93-1.253 1.186t-.622.256a.73.73 0 0 1-.623-.322q-.234-.33-.234-.879 0-.688.432-2.3.44-1.611.439-2.321a.45.45 0 0 0-.088-.293.27.27 0 0 0-.227-.11.75.75 0 0 0-.307.095 4 4 0 0 0-.476.293l-.22-.388.974-.711q.279-.204.483-.293a.9.9 0 0 1 .389-.095q.344 0 .542.286.204.278.205.769 0 .534-.381 2.095l-.132.527a33 33 0 0 0-.315 1.37q-.103.541-.103.747 0 .183.081.3.08.117.205.117.117 0 .308-.146.19-.147.666-.616m-.058-9.441.417.469q.176.183.242.33a.6.6 0 0 1 .073.285.47.47 0 0 1-.11.293 1.1 1.1 0 0 1-.307.264l-.645.359-.469-.557a1.4 1.4 0 0 1-.19-.285.6.6 0 0 1-.044-.227.5.5 0 0 1 .088-.293.9.9 0 0 1 .3-.257zm4.592 4.732q-.85 0-1.465 1.164-.615 1.165-.615 2.872 0 .9.307 1.377.315.476.909.476.893 0 1.516-1.143.63-1.15.63-2.812 0-.99-.315-1.458-.315-.476-.967-.476m.315-.711q1.09 0 1.655.682.571.674.571 1.977 0 .747-.293 1.597a5.8 5.8 0 0 1-.791 1.523q-.534.733-1.215 1.128-.675.388-1.421.388-.982 0-1.568-.71-.578-.71-.578-1.904 0-.886.285-1.729a5.1 5.1 0 0 1 .821-1.523 4 4 0 0 1 1.194-1.055q.674-.374 1.34-.374m5.405 2.103 1.187-1.158q.622-.593.937-.783.323-.19.608-.191.484 0 .784.425.307.425.307 1.121 0 .71-.359 2.197-.358 1.479-.358 2.109 0 .19.073.293.073.096.212.095a.36.36 0 0 0 .161-.051 1 1 0 0 0 .198-.154l.557-.542.256.389-.798.813a2.8 2.8 0 0 1-.572.461q-.278.168-.49.168a.72.72 0 0 1-.601-.315q-.227-.321-.227-.842 0-.623.374-2.19.373-1.575.373-2.292a.7.7 0 0 0-.117-.432.34.34 0 0 0-.3-.169q-.286 0-1.751 1.355l-.608.564-.461 2.578-.044.22q-.155.783-.183 1.201l-1.304.322a79 79 0 0 0 .762-3.654q.286-1.553.286-2.037 0-.292-.066-.417a.22.22 0 0 0-.213-.132q-.087 0-.293.103a6 6 0 0 0-.505.3l-.198-.388.234-.191q1.128-.908 1.509-.908.366 0 .542.279.176.27.176.849 0 .205-.022.462-.022.255-.066.542"/><path fill="#000" d="M267.835 390.354a.5.5 0 0 0 0-.708l-3.182-3.182a.5.5 0 0 0-.707.708l2.828 2.828-2.828 2.828a.5.5 0 0 0 .707.708zM131.481 390v.5h136v-1h-136z"/><defs><clipPath id="clip0_249_8276-attention-01-svg"><path fill="#fff" d="M124.481 185h143v143h-143z"/></clipPath></defs></svg>
<figcaption><b>FlashAttention2 Strategy</b> We parallelize along Q, and reduce along K/V simultaneously. This means that our entire reduction can be kept within a single core, making it another data-parallel strategy.</figcaption>
</figure>
<p>After obtaining batch invariance for matmuls, attention introduces two additional wrinkles &mdash; fittingly,  because it contains two matmuls.</p>
<ol>
<li>As opposed to only reducing over the feature dimension like both RMSNorm and matmuls, we now reduce over the feature dimension <em>and</em> sequence dimension.</li>
<li>Due to the above, attention must deal with a variety of inference optimizations that affect how sequences get processed (chunked prefill, prefix caching, etc.).</li>
</ol>
<p>Thus, to achieve determinism in LLM inference our numerics must be invariant to both how many requests are processed at once <strong>and</strong> how each request gets sliced up in the inference engine.</p>
<p>Let&rsquo;s first walk through the standard parallelism strategy for attention, first introduced in FlashAttention2. Similar to RMSNorm and Matmul, the default strategy is a &ldquo;data-parallel&rdquo; strategy. Since we reduce along the key/value tensors, a data-parallel strategy can only parallelize along the query tensor.</p>
<p>For example, depending on the inference engine’s choices, it’s possible that a sequence might get processed in several parts (such as in chunked prefill) or perhaps all at once (if the prefill isn’t split up). In order to achieve “batch invariance”, it’s necessary that the <em>reduction order for a given token does not depend on how many other tokens from its sequence are being simultaneously processed</em>. If you reduce over the K/V values in the KV cache separately from the K/V values in the current tokens being processed (like in vLLM’s <a href="https://github.com/vllm-project/vllm/blob/0ae43dbf8cb28a299ae724fc742b0c5bcddea868/vllm/attention/ops/prefix_prefill.py#L36">Triton attention kernel</a>), this can&rsquo;t be achieved. For example, when processing the 1000th query token in a sequence, the reduction order must be identical regardless of whether 0 tokens are in the KV cache (prefill) or 999 tokens are in the KV cache (decoding).</p>
<figure class="half-width">
<svg xmlns="http://www.w3.org/2000/svg" width="416" height="453" fill="none" viewBox="0 0 416 453"><path fill="#f5f5f5" d="M0 0h416v453H0z"/><path fill="#fff" d="M0 0h416v453H0z"/><path fill="#000" d="m31.83 281.817 1.677 1.011q1.23.725 1.955.988.726.271 1.377.271.213 0 .498-.036.285-.037.689-.117l.088.454q-1.04.292-1.546.381a5 5 0 0 1-.886.095q-1.56 0-5.215-2.476l-.3-.205q-.051 0-.161.007-.103.008-.154.008-2.242 0-3.706-1.538-1.458-1.539-1.457-3.882 0-1.172.432-2.197a5.55 5.55 0 0 1 1.267-1.824 5.1 5.1 0 0 1 1.67-1.077 5.2 5.2 0 0 1 1.955-.373q1.1 0 1.97.322a4.7 4.7 0 0 1 1.59.981 5.6 5.6 0 0 1 1.31 1.875q.455 1.062.455 2.249 0 1.817-.916 3.149-.915 1.334-2.592 1.934m1.89-4.827q0-2.131-1.1-3.493-1.098-1.37-2.768-1.37-1.605 0-2.578 1.172-.967 1.172-.967 3.135 0 2.204 1.106 3.588 1.106 1.377 2.813 1.377 1.567 0 2.526-1.201.967-1.208.967-3.208"/><path fill="#000" d="M142.401 120.548q.47.03.931.044.46.015.9.015.315 0 .726-.015.41-.014.9-.044v.491h-.066q-.834 0-1.604.725l-.073.073-3.633 3.479 3.348 3.362.373.374q1.414 1.45 2.073 1.45h.124a.4.4 0 0 0 .066-.015l.008.513q-.117-.007-.315-.015a22 22 0 0 0-1.04-.044q-.279 0-.638.015-.35.014-.754.044a.1.1 0 0 0 .007-.029.1.1 0 0 0 .008-.044q0-.381-2.337-2.703a272 272 0 0 1-2.3-2.322l2.82-3.047q.191-.212.52-.556.74-.798.74-.945a.245.245 0 0 0-.146-.234q-.14-.081-.455-.081h-.183zm-5.83 0a34 34 0 0 0 1.861.059q.453 0 .922-.015t.953-.044v.491h-.096q-.658 0-.886.33-.22.329-.22 1.699v5.354q0 1.435.213 1.758.212.322.849.322.037 0 .118-.007.08-.008.124-.008V131a42 42 0 0 0-1.977-.059q-.338 0-.828.015t-1.077.044v-.505q.044 0 .096.007h.139q.578 0 .783-.403.213-.41.213-1.816 0-.19-.008-.718a83 83 0 0 1-.007-.857v-1.948q0-.366.007-.93.008-.572.008-.777 0-1.267-.213-1.64-.205-.374-.783-.374-.022 0-.088.007a1 1 0 0 1-.103.008zm20.076 9.009.366.557a6 6 0 0 1-1.399.82 3.5 3.5 0 0 1-1.303.278q-1.436 0-2.344-1.025-.908-1.032-.908-2.637 0-1.663 1.149-2.812 1.15-1.15 2.806-1.15.849 0 1.311.242.46.234.461.659a.8.8 0 0 1-.19.534q-.183.22-.425.22-.081 0-.681-.366-.594-.374-1.136-.374-.951 0-1.516.689-.556.681-.556 1.86 0 1.486.674 2.322.68.828 1.882.828.447 0 .886-.154.447-.154.923-.491m7.676.381.205.461a6.3 6.3 0 0 1-1.004.608q-.453.22-.732.22-.47 0-.703-.271-.234-.278-.256-.835-.8.535-1.326.769-.528.228-.945.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.952-2.065.696-.161 1.084-.257 0-.124.007-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.959-.366-.63 0-.996.234-.36.227-.359.623 0 .036.007.102l.007.088q0 .228-.219.381a.93.93 0 0 1-.528.147q-.263 0-.388-.088-.124-.088-.124-.271 0-.586.988-1.304.99-.725 2.044-.725 1.018 0 1.545.564.528.557.528 1.64 0 .587-.074 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.381.169a1 1 0 0 0 .3-.066q.19-.074.557-.249m-2.498-2.476-.417.11q-2.38.653-2.381 1.538 0 .484.308.791.308.301.813.301.308 0 .71-.161.403-.162.938-.513zm8.753 2.095.366.557a6 6 0 0 1-1.399.82 3.5 3.5 0 0 1-1.304.278q-1.435 0-2.344-1.025-.908-1.032-.908-2.637 0-1.663 1.15-2.812 1.15-1.15 2.805-1.15.85 0 1.311.242.462.234.462.659a.8.8 0 0 1-.191.534q-.183.22-.424.22-.08 0-.682-.366-.593-.374-1.135-.374-.952 0-1.516.689-.557.681-.557 1.86 0 1.486.674 2.322.681.828 1.883.828.446 0 .886-.154.447-.154.923-.491m3.361-9.88q-.029 1.23-.051 2.512-.021 1.281-.029 2.629.82-.623 1.465-.915.644-.3 1.172-.3 1.076 0 1.618.607.542.609.542 1.824l-.007.645q-.007.637-.007 1.274 0 .272-.008.681-.007.403-.007.55 0 .82.146 1.069.147.249.557.249l.081-.007a1 1 0 0 1 .102-.008V131a54 54 0 0 0-1.003-.059q-.337-.014-.557-.014-.351 0-.762.022-.402.014-.842.051l-.007-.513h.11q.937 0 .959-1.714v-.146l.015-1.575v-.3q0-1.333-.315-1.765-.315-.44-1.084-.44-.418 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.037 2.608q0 .219-.007.564-.007.344-.007.476 0 .907.146 1.179.147.271.564.271.03 0 .088-.007a1 1 0 0 1 .102-.008V131a20 20 0 0 0-.871-.051 13 13 0 0 0-1.362-.008q-.373.015-.975.052v-.506q.044 0 .125.008.081.007.117.007.505 0 .681-.264.176-.27.176-1.56v-.542l.029-5.508v-1.259q0-.316-.139-.469-.132-.162-.403-.161-.102 0-.337.044a.4.4 0 0 1-.08.014l-.11-.476q.6-.117 1.179-.271.58-.161 1.157-.373m12.876 7.229h-3.574q-.417 0-.769.014-.35.015-.652.044v.271q0 1.435.659 2.22.667.783 1.875.783.535 0 1.055-.176a5.3 5.3 0 0 0 1.106-.563l.286.468a6.1 6.1 0 0 1-1.509.93q-.747.315-1.48.315-1.42 0-2.343-1.01-.923-1.018-.923-2.608 0-1.692.967-2.842.966-1.149 2.358-1.149 1.296 0 2.066.864.768.864.878 2.439m-1.355-.769q-.219-.901-.666-1.377-.447-.483-1.069-.484-.703 0-1.209.564-.498.564-.652 1.524 1.45 0 2.278-.052.835-.05 1.318-.175"/><path fill="#000" d="M244.401 120.548q.47.03.931.044.46.015.9.015.315 0 .726-.015.41-.014.9-.044v.491h-.066q-.834 0-1.604.725l-.073.073-3.633 3.479 3.348 3.362.373.374q1.414 1.45 2.073 1.45h.124a.4.4 0 0 0 .066-.015l.008.513q-.117-.007-.315-.015a22 22 0 0 0-1.04-.044q-.279 0-.638.015-.35.014-.754.044a.1.1 0 0 0 .007-.029.1.1 0 0 0 .008-.044q0-.381-2.337-2.703a272 272 0 0 1-2.3-2.322l2.82-3.047q.191-.212.52-.556.74-.798.74-.945a.245.245 0 0 0-.146-.234q-.14-.081-.455-.081h-.183zm-5.83 0a34 34 0 0 0 1.861.059q.453 0 .922-.015t.953-.044v.491h-.096q-.658 0-.886.33-.22.329-.22 1.699v5.354q0 1.435.213 1.758.212.322.849.322.037 0 .118-.007.08-.008.124-.008V131a42 42 0 0 0-1.977-.059q-.338 0-.828.015t-1.077.044v-.505q.044 0 .096.007h.139q.578 0 .783-.403.213-.41.213-1.816 0-.19-.008-.718a83 83 0 0 1-.007-.857v-1.948q0-.366.007-.93.008-.572.008-.777 0-1.267-.213-1.64-.205-.374-.783-.374-.022 0-.088.007a1 1 0 0 1-.103.008z"/><path fill="#000" d="M140.164 370.932q.308.043.557.066.249.022.49.022 1.377 0 2.088-.608.718-.616.718-1.795 0-1.062-.704-1.692-.702-.63-1.904-.63-.33 0-.63.03a6 6 0 0 0-.578.073q-.023.989-.03 1.999-.007 1.003-.007 2.535m-2.607 4.592.11.015h.175q.587 0 .791-.396.213-.403.213-1.78 0-.204-.008-.754a67 67 0 0 1-.007-.886v-4.585q0-.63-.227-.865t-.828-.234h-.058v-.513q.498.037.989.052.498.014.981.014.542 0 1.289-.029.755-.037.974-.037 1.605 0 2.564.799.959.798.959 2.102 0 1.545-1.055 2.409-1.047.858-2.966.857-.19 0-.52-.022a22 22 0 0 1-.769-.066v2.205q0 1.128.227 1.421.234.285.93.286l.074-.008.087-.007q.037 0 .052.007.022 0 .036.008l.008.483a38 38 0 0 0-2.146-.059q-.257 0-.755.015-.49.014-1.12.044zm18.523-.967.366.557a6 6 0 0 1-1.399.82 3.5 3.5 0 0 1-1.304.278q-1.435 0-2.344-1.025-.908-1.032-.908-2.637 0-1.662 1.15-2.812t2.805-1.15q.85 0 1.311.242.462.234.462.659a.8.8 0 0 1-.191.534q-.183.22-.424.22-.08 0-.682-.366-.593-.374-1.135-.374-.952 0-1.516.689-.557.681-.557 1.86 0 1.486.674 2.322.681.828 1.883.828.446 0 .886-.154.446-.154.923-.491m7.675.381.205.461a6.3 6.3 0 0 1-1.003.608q-.454.22-.732.22-.469 0-.704-.271-.234-.278-.256-.835-.798.535-1.326.769-.527.227-.944.227-.74 0-1.238-.556-.498-.558-.498-1.363 0-1.37 2.951-2.065a86 86 0 0 0 1.084-.257q0-.124.008-.358.022-.484.022-.63 0-.762-.315-1.121-.315-.366-.96-.366-.63 0-.996.234-.359.227-.359.623 0 .036.008.102l.007.088q0 .228-.22.381a.9.9 0 0 1-.527.147q-.264 0-.388-.088-.125-.088-.125-.271 0-.586.989-1.304.988-.725 2.043-.725 1.018 0 1.546.564.527.557.527 1.64 0 .587-.073 1.802a37 37 0 0 0-.066 1.846q0 .476.103.644.11.17.38.169a1 1 0 0 0 .301-.066q.19-.073.556-.249m-2.497-2.476-.418.11q-2.38.653-2.38 1.538 0 .484.308.791.308.301.813.301.307 0 .71-.161.403-.162.938-.513zm8.752 2.095.366.557a6 6 0 0 1-1.398.82 3.5 3.5 0 0 1-1.304.278q-1.435 0-2.344-1.025-.908-1.032-.908-2.637 0-1.662 1.15-2.812t2.805-1.15q.849 0 1.311.242.462.234.461.659a.8.8 0 0 1-.19.534q-.183.22-.425.22-.081 0-.681-.366-.593-.374-1.135-.374-.952 0-1.516.689-.557.681-.557 1.86 0 1.486.674 2.322.68.828 1.882.828.447 0 .886-.154.447-.154.923-.491m3.362-9.88q-.03 1.23-.051 2.512a201 201 0 0 0-.029 2.629q.82-.623 1.464-.915.645-.3 1.172-.3 1.077 0 1.619.607.542.609.542 1.824l-.007.645q-.008.637-.008 1.274 0 .272-.007.681-.007.403-.007.55 0 .82.146 1.069t.557.249l.08-.007a1 1 0 0 1 .103-.008V376a54 54 0 0 0-1.004-.059q-.337-.014-.556-.014-.352 0-.762.022-.403.014-.842.051l-.008-.513h.11q.937 0 .96-1.714v-.146l.014-1.575v-.3q0-1.333-.315-1.765-.315-.44-1.084-.44-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.036 2.608q0 .219-.007.564-.008.344-.008.476 0 .908.147 1.179.145.271.564.271l.088-.007a1 1 0 0 1 .102-.008V376a20 20 0 0 0-.872-.051 13 13 0 0 0-1.362-.008q-.374.015-.974.052v-.506q.044 0 .125.008.08.007.117.007.505 0 .681-.264.176-.27.176-1.56v-.542l.029-5.508v-1.259q0-.316-.139-.469-.132-.162-.403-.161-.103 0-.337.044l-.08.014-.11-.476q.6-.117 1.179-.271.578-.161 1.157-.373m12.876 7.229h-3.574q-.417 0-.769.014t-.652.044v.271q0 1.435.659 2.22.666.783 1.875.783.535 0 1.055-.176.52-.183 1.106-.563l.285.468a6.1 6.1 0 0 1-1.508.93 3.8 3.8 0 0 1-1.48.315q-1.42 0-2.344-1.01-.922-1.018-.922-2.608 0-1.692.966-2.842.967-1.149 2.359-1.149 1.296 0 2.065.864.77.864.879 2.439m-1.355-.769q-.22-.901-.666-1.377-.447-.484-1.07-.484-.703 0-1.208.564-.498.564-.652 1.524 1.45 0 2.278-.052.834-.05 1.318-.175"/><path fill="#000" d="M242.164 370.932q.308.043.557.066.249.022.49.022 1.377 0 2.088-.608.718-.616.718-1.795 0-1.062-.704-1.692-.702-.63-1.904-.63-.33 0-.63.03a6 6 0 0 0-.578.073q-.023.989-.03 1.999-.007 1.003-.007 2.535m-2.607 4.592.11.015h.175q.587 0 .791-.396.213-.403.213-1.78 0-.204-.008-.754a67 67 0 0 1-.007-.886v-4.585q0-.63-.227-.865t-.828-.234h-.058v-.513q.498.037.989.052.498.014.981.014.542 0 1.289-.029.755-.037.974-.037 1.605 0 2.564.799.959.798.959 2.102 0 1.545-1.055 2.409-1.047.858-2.966.857-.19 0-.52-.022a22 22 0 0 1-.769-.066v2.205q0 1.128.227 1.421.234.285.93.286l.074-.008.087-.007q.037 0 .052.007.022 0 .036.008l.008.483a38 38 0 0 0-2.146-.059q-.257 0-.755.015-.49.014-1.12.044z"/><path fill="#000" d="M312.719 370.99q0-2.131-1.098-3.493-1.1-1.37-2.769-1.37-1.604 0-2.578 1.172-.967 1.172-.967 3.135 0 2.183 1.099 3.581 1.105 1.4 2.761 1.399 1.596 0 2.571-1.201.981-1.209.981-3.223m-3.706-5.683q1.113 0 1.985.322.88.315 1.589.981.85.806 1.297 1.868.454 1.062.454 2.256 0 1.215-.476 2.3a5.4 5.4 0 0 1-1.355 1.867q-.704.63-1.641.989a5.2 5.2 0 0 1-1.867.352 5.3 5.3 0 0 1-2.161-.432 5 5 0 0 1-1.736-1.282 5.6 5.6 0 0 1-1.055-1.743 5.8 5.8 0 0 1-.359-2.036q0-1.158.433-2.183a5.3 5.3 0 0 1 1.267-1.809 5.3 5.3 0 0 1 1.684-1.077 5.2 5.2 0 0 1 1.941-.373"/><path fill="#000" d="M340.103 150.548a39 39 0 0 0 1.904.059q.469 0 .952-.015a32 32 0 0 0 1.003-.044l-.007.462q-.616.051-.82.161-.198.11-.198.381 0 .204.073.52.081.307.279.857l2.204 6.167q1.766-4.431 2.219-5.742.462-1.319.462-1.729 0-.337-.183-.461-.176-.125-.821-.154v-.462a24 24 0 0 0 1.707.059q.351 0 .784-.015.432-.014.901-.044v.462h-.11q-.806 0-1.37 1.421a9 9 0 0 1-.205.498 554 554 0 0 0-2.659 6.452q-.593 1.494-.622 1.736h-.901q0-.175-.681-2.19a135 135 0 0 0-1.648-4.563l-.191-.52q-1.062-2.849-1.875-2.849a1 1 0 0 0-.117.007l-.08.008z"/><path fill="#000" d="M340.103 30.548q.548.03 1.04.044a29 29 0 0 0 1.816 0q.491-.014 1.003-.044l-.007.462q-.616.051-.82.16-.198.11-.198.382 0 .205.073.52.081.307.279.857l2.204 6.167q1.766-4.431 2.219-5.742.462-1.32.462-1.729 0-.337-.183-.461-.176-.125-.821-.154v-.462a27 27 0 0 0 1.707.059q.351 0 .784-.015.432-.014.901-.044v.462h-.11q-.806 0-1.37 1.42a9 9 0 0 1-.205.499 557 557 0 0 0-2.659 6.452q-.593 1.494-.622 1.736h-.901q0-.175-.681-2.19a136 136 0 0 0-1.648-4.563l-.191-.52q-1.062-2.85-1.875-2.849a1 1 0 0 0-.117.007l-.08.008zm20.896 9.01.366.556q-.71.542-1.399.82a3.5 3.5 0 0 1-1.304.278q-1.435 0-2.344-1.025-.908-1.032-.908-2.637 0-1.663 1.15-2.812 1.15-1.15 2.805-1.15.85 0 1.311.242.462.234.462.659a.8.8 0 0 1-.191.534q-.183.22-.425.22-.08 0-.681-.366-.593-.375-1.135-.374-.952 0-1.516.689-.557.681-.557 1.86 0 1.487.674 2.322.681.828 1.882.828.447 0 .887-.154.447-.154.923-.49m7.675.38.205.461q-.549.396-1.003.608-.454.22-.732.22-.469 0-.704-.27-.234-.28-.256-.836-.798.534-1.326.77-.527.226-.944.226-.74 0-1.238-.556-.498-.557-.498-1.363 0-1.37 2.951-2.065.697-.161 1.084-.257 0-.123.008-.358.022-.484.022-.63 0-.763-.315-1.12-.315-.367-.96-.367-.63 0-.996.234-.359.228-.359.623a1 1 0 0 0 .008.102q.007.06.007.088 0 .228-.22.381a.93.93 0 0 1-.527.147q-.264 0-.388-.088-.125-.089-.125-.271 0-.585.989-1.304.988-.725 2.043-.725 1.018 0 1.546.564.527.556.527 1.64 0 .587-.073 1.802-.066 1.216-.066 1.846 0 .476.103.645.11.168.38.168a1 1 0 0 0 .301-.066 8 8 0 0 0 .556-.249m-2.497-2.476-.418.11q-2.38.652-2.38 1.538 0 .484.308.791.308.3.813.3.307 0 .71-.16.403-.162.937-.513zm8.752 2.095.366.557q-.71.542-1.399.82a3.5 3.5 0 0 1-1.303.278q-1.436 0-2.344-1.025-.908-1.032-.908-2.637 0-1.663 1.15-2.812 1.149-1.15 2.805-1.15.849 0 1.311.242.462.234.461.659a.8.8 0 0 1-.19.534q-.183.22-.425.22-.081 0-.681-.366-.594-.375-1.135-.374-.952 0-1.516.689-.557.681-.557 1.86 0 1.487.674 2.322.68.828 1.882.828.447 0 .886-.154.447-.154.923-.49m3.362-9.88a314 314 0 0 0-.081 5.141q.821-.623 1.465-.915.645-.3 1.172-.3 1.077 0 1.619.607.542.609.542 1.824l-.008.645q-.007.637-.007 1.274 0 .27-.007.681-.007.403-.007.55 0 .82.146 1.069.147.249.557.249l.08-.007a1 1 0 0 1 .103-.008V41a49 49 0 0 0-1.004-.059 13 13 0 0 0-.556-.014q-.353 0-.762.022-.403.015-.842.051l-.008-.513h.11q.938 0 .96-1.714v-.146l.014-1.575v-.3q0-1.333-.315-1.765-.315-.44-1.084-.44-.417 0-.93.205a7.4 7.4 0 0 0-1.194.652l-.036 2.608q0 .219-.008.564-.007.344-.007.476 0 .907.147 1.179.145.27.564.271l.087-.007q.066-.008.103-.008V41a20 20 0 0 0-.872-.051 13 13 0 0 0-1.362-.008q-.374.015-.974.052v-.506q.044 0 .125.008.08.007.117.007.506 0 .681-.264.176-.27.176-1.56v-.542l.029-5.508v-1.26q0-.315-.139-.468-.132-.16-.403-.161-.102 0-.337.044a.4.4 0 0 1-.081.014l-.109-.476q.6-.117 1.179-.27.579-.162 1.157-.374m12.876 7.229h-3.574q-.418 0-.769.014t-.652.044v.271q0 1.436.659 2.22.666.783 1.875.783.534 0 1.055-.175.52-.184 1.106-.565l.285.47q-.755.615-1.508.93a3.8 3.8 0 0 1-1.48.314q-1.42 0-2.344-1.01-.923-1.019-.923-2.608 0-1.692.967-2.842t2.359-1.15q1.296 0 2.065.865.77.864.879 2.439m-1.355-.77q-.22-.9-.666-1.376-.447-.484-1.07-.484-.703 0-1.208.564-.498.564-.652 1.524 1.45 0 2.278-.051.834-.052 1.318-.176"/><g clip-path="url(#clip0_249_8276-attention-02-svg)"><path fill="#ef402c" d="M108 202h35v35h-35z"/><path fill="#ef402c" d="M144 202h35v35h-35z" opacity=".75"/><path fill="#ef402c" d="M180 202h17.5v35H180z" opacity=".5"/><path fill="#f78427" d="M108 238h35v35h-35z"/><path fill="#f78427" d="M144 238h35v35h-35z" opacity=".75"/><path fill="#f78427" d="M180 238h17.5v35H180z" opacity=".5"/><path fill="#ffa8aa" d="M108 274h35v35h-35z"/><path fill="#ffa8aa" d="M144 274h35v35h-35z" opacity=".8"/><path fill="#ffa8aa" d="M180 274h17.5v35H180z" opacity=".5"/><path fill="#824665" d="M108 310h35v35h-35z"/><path fill="#824665" d="M144 310h35v35h-35z" opacity=".8"/><path fill="#824665" d="M180 310h17.5v35H180z" opacity=".5"/></g><path fill="#ef402c" d="M218 202h35v35h-35z" opacity=".5"/><path fill="#f78427" d="M218 238h35v35h-35z" opacity=".5"/><path fill="#ffa8aa" d="M218 274h35v35h-35z" opacity=".5"/><path fill="#824665" d="M218 310h35v35h-35z" opacity=".5"/><path fill="#ef402c" d="M254 202h17.5v35H254z" opacity=".25"/><path fill="#f78427" d="M254 238h17.5v35H254z" opacity=".25"/><path fill="#824665" d="M254 310h17.5v35H254z" opacity=".25"/><path fill="#ffa8aa" d="M254 274h17.5v35H254z" opacity=".25"/><path fill="#e7e1df" d="M108 149a2 2 0 0 1 2-2h33v35h-35z"/><path fill="#e7e1df" d="M144 147h35v35h-35z" opacity=".75"/><path fill="#e7e1df" d="M180 147h17.5v35H180z" opacity=".5"/><path fill="#e7e1df" d="M217 147h35v35h-35z" opacity=".5"/><path fill="#e7e1df" d="M253 147h17.5v35H253z" opacity=".4"/><path fill="#ef402c" d="M53 202h35v35H53z"/><path fill="#f78427" d="M53 238h35v35H53z"/><path fill="#ffa8aa" d="M53 274h35v35H53z"/><path fill="#824665" d="M53 310h35v35H53z"/><path fill="#ef402c" d="M292 202h35v35h-35z"/><path fill="#f78427" d="M292 238h35v35h-35z"/><path fill="#ffa8aa" d="M292 274h35v35h-35z"/><path fill="#824665" d="M292 310h35v35h-35z"/><path fill="#e7e1df" d="M328 129.5v35h-35v-35z" opacity=".5"/><path fill="#e7e1df" d="M328 165.5V183h-35v-17.5z" opacity=".4"/><path fill="#e7e1df" d="M326 22a2 2 0 0 1 2 2v33h-35V22z"/><path fill="#e7e1df" d="M328 58v35h-35V58z" opacity=".75"/><path fill="#e7e1df" d="M328 94v17.5h-35V94z" opacity=".5"/><path fill="#000" d="M366.646 345.354a.5.5 0 0 0 .708 0l3.182-3.182a.502.502 0 0 0-.708-.708L367 344.293l-2.828-2.829a.502.502 0 0 0-.708.708zM367 229h-.5v116h1V229z"/><path fill="#000" d="M214.398 417.137q.096.014.198.014h.308q1.553 0 2.439-.651.893-.653.893-1.773 0-1.004-.549-1.523-.549-.52-1.597-.52a7 7 0 0 0-.402.014q-.236.015-.528.044l-.491 2.747q-.175 1.033-.271 1.648m-3.09 4.38h.285q.455 0 .645-.257.198-.264.403-1.45l1.062-6.328q.021-.11.036-.205.015-.096.015-.154 0-.3-.205-.439-.198-.147-.608-.147h-.198l.095-.542q.462.043.843.066.38.022.688.022.477 0 1.267-.044.799-.044 1.114-.044 1.347 0 2.102.623.76.615.761 1.699 0 1.032-.659 1.816-.659.777-1.933 1.26l1.113 2.117q.043.094.139.285.93 1.817 1.985 1.817.036 0 .11-.008.08-.007.117-.007l-.088.491a8 8 0 0 1-.564.08q-.227.03-.395.03-.667 0-1.136-.242a1.96 1.96 0 0 1-.769-.754q-.212-.345-.791-1.575-.571-1.23-.923-1.948-.234.022-.476.036-.234.008-.483.008a8 8 0 0 1-.286-.008 7 7 0 0 0-.285-.007l-.418 2.761-.037.271a4 4 0 0 0-.007.183q0 .36.154.476.161.118.666.118h.169l-.095.483a45 45 0 0 1-.681-.029q-.858-.03-1.099-.03-.374 0-1.318.044-.257.008-.411.015zm11.55-2.82.073-.037q2.608-1.334 2.608-2.058a.93.93 0 0 0-.279-.674.88.88 0 0 0-.652-.285q-.578 0-1.04.798-.46.798-.71 2.256m2.204-.506-2.241 1.158v.073q0 .871.271 1.326.279.454.799.454.307 0 .769-.271.468-.279 1.194-.894l.256.462q-1.047.966-1.67 1.34-.615.373-1.121.373-.768 0-1.245-.666-.476-.666-.476-1.751 0-.768.249-1.648.257-.885.659-1.545.506-.806 1.158-1.245t1.347-.44q.71 0 1.187.455.483.446.483 1.091 0 .52-.293.864-.285.337-1.326.864m6.343 1.187.55-3.318a4 4 0 0 0-.718-.337 1.8 1.8 0 0 0-.586-.11q-.901 0-1.516 1.158-.615 1.149-.615 2.871 0 .695.161 1.054.168.36.49.359.22 0 .813-.447.601-.446 1.421-1.23m.015.747-1.245 1.128q-.549.498-.879.688-.323.19-.608.191-.659 0-1.011-.557-.351-.564-.351-1.618 0-2.08 1.047-3.575 1.054-1.494 2.505-1.494.293 0 .593.081.308.074.637.219l.418-2.651q.022-.153.029-.308.015-.16.015-.322 0-.292-.117-.403-.118-.11-.432-.109-.096 0-.198.007a3 3 0 0 0-.213.007l-.029-.432q.608-.059 1.223-.161.623-.102 1.253-.249-.681 3.515-1.121 6.35-.44 2.828-.439 3.435 0 .374.065.527a.245.245 0 0 0 .235.147.4.4 0 0 0 .205-.073 2 2 0 0 0 .308-.242l.446-.403.242.418-.842.827q-.44.425-.637.542a.75.75 0 0 1-.381.117q-.389 0-.572-.366-.175-.366-.175-1.135a5 5 0 0 1 .029-.586m10.071.645-1.011.944a2 2 0 0 1-.491.374.95.95 0 0 1-.439.11q-.33 0-.535-.315-.198-.323-.198-.857 0-.155.022-.366.03-.22.11-.681-1.355 1.384-1.919 1.801t-.959.418q-.418 0-.696-.388t-.278-.997q0-.512.439-2.307.11-.425.161-.644.154-.608.227-.974.074-.374.074-.557a.35.35 0 0 0-.074-.234.22.22 0 0 0-.183-.096q-.073 0-.285.103a10 10 0 0 0-.586.315l-.205-.403q.681-.505 1.193-.784.513-.285.725-.285a.53.53 0 0 1 .469.256q.176.257.176.711 0 .57-.454 2.211-.447 1.642-.447 2.461 0 .256.088.381.088.117.271.117.206 0 .696-.402.498-.411 1.662-1.56.279-1.319.447-2.227.176-.915.271-1.633l1.319-.315-.162.725a91 91 0 0 0-.454 1.985l-.175.937q-.132.667-.213 1.275a8 8 0 0 0-.073.857q0 .168.066.263a.2.2 0 0 0 .176.095q.102 0 .38-.197.279-.198.638-.535zm5.302-4.593-.388.381q-.483-.49-.776-.652a1.2 1.2 0 0 0-.586-.161q-.674 0-1.172 1.004-.498.996-.498 2.46 0 .982.256 1.48.257.498.755.498.278 0 .762-.315a6.3 6.3 0 0 0 1.018-.879l.3.52q-.85.901-1.45 1.304-.601.395-1.099.395-.791 0-1.267-.688-.47-.688-.469-1.86 0-2.007 1.026-3.384 1.032-1.377 2.541-1.377.55 0 .938.234.395.234.395.535a.5.5 0 0 1-.066.234 1 1 0 0 1-.22.271m3.999-2.937q-.139.49-.388 1.538-.073.308-.11.454.433 0 .879-.007.454-.015.952-.037l-.175.733a12 12 0 0 0-.44-.007h-1.362q-.344 1.508-.513 2.636-.16 1.128-.161 1.89 0 .322.103.505.11.183.3.183.147 0 .461-.234t.857-.754l.257.468q-1.055 1.084-1.451 1.385-.395.293-.666.293-.506 0-.806-.476-.3-.477-.3-1.297 0-.534.168-1.531.169-1.003.638-3.105-.117 0-.308.007l-.249.008h-.505l.088-.491q.336-.015.615-.117.286-.103.571-.323.066-.263.147-.549.087-.293.197-.615zm4.842 7.097.256.433q-.9.93-1.252 1.186t-.623.256a.73.73 0 0 1-.622-.322q-.235-.33-.235-.879 0-.688.432-2.3.44-1.611.44-2.321 0-.183-.088-.293a.28.28 0 0 0-.227-.11.75.75 0 0 0-.308.095 4 4 0 0 0-.476.293l-.22-.388.975-.711q.278-.204.483-.293a.9.9 0 0 1 .388-.095q.344 0 .542.286.205.278.205.769 0 .534-.381 2.095l-.131.527a33 33 0 0 0-.315 1.37q-.103.541-.103.747 0 .183.081.3a.24.24 0 0 0 .205.117q.117 0 .307-.146.19-.147.667-.616m-.059-9.441.418.469q.175.183.241.33a.6.6 0 0 1 .074.285.47.47 0 0 1-.11.293 1.1 1.1 0 0 1-.308.264l-.644.359-.469-.557a1.4 1.4 0 0 1-.191-.285.6.6 0 0 1-.044-.227q0-.169.088-.293a.9.9 0 0 1 .301-.257zm4.592 4.732q-.849 0-1.464 1.164-.616 1.165-.616 2.872 0 .9.308 1.377.315.476.908.476.894 0 1.516-1.143.63-1.15.63-2.812 0-.99-.315-1.458-.315-.476-.967-.476m.315-.711q1.092 0 1.656.682.571.674.571 1.977 0 .747-.293 1.597a5.8 5.8 0 0 1-.791 1.523q-.534.733-1.216 1.128a2.8 2.8 0 0 1-1.421.388q-.98 0-1.567-.71-.579-.71-.579-1.904 0-.886.286-1.729.286-.842.82-1.523a4 4 0 0 1 1.194-1.055q.674-.374 1.34-.374m5.406 2.103 1.186-1.158q.623-.593.938-.783.322-.19.608-.191.483 0 .783.425.308.425.308 1.121 0 .71-.359 2.197-.359 1.479-.359 2.109 0 .19.073.293.073.096.213.095a.36.36 0 0 0 .161-.051 1 1 0 0 0 .198-.154l.556-.542.257.389-.799.813q-.285.293-.571.461-.278.168-.491.168a.72.72 0 0 1-.6-.315q-.227-.321-.227-.842 0-.623.373-2.19.374-1.575.374-2.292a.7.7 0 0 0-.117-.432.34.34 0 0 0-.301-.169q-.286 0-1.75 1.355-.389.358-.608.564l-.462 2.578-.043.22q-.154.783-.184 1.201l-1.303.322q.483-2.101.761-3.654.286-1.553.286-2.037 0-.292-.066-.417a.22.22 0 0 0-.212-.132q-.089 0-.293.103a6 6 0 0 0-.506.3l-.197-.388.234-.191q1.128-.908 1.509-.908.366 0 .542.279.176.27.176.849 0 .205-.022.462-.022.255-.066.542"/><path fill="#000" d="M271.354 401.354a.5.5 0 0 0 0-.708l-3.182-3.182a.502.502 0 0 0-.708.708l2.829 2.828-2.829 2.828a.502.502 0 0 0 .708.708zM135 401v.5h136v-1H135z"/><defs><clipPath id="clip0_249_8276-attention-02-svg"><path fill="#fff" d="M108 202h89.5v143H108z"/></clipPath></defs></svg>
<figcaption><b>FlashAttention with a KV Cache</b> The reason why explicitly handling the KV cache separately from the current KV values breaks batch invariance is a bit subtle and is related to "boundary conditions". In particular, imagine your block size is 32 but we currently have 80 elements in our KV cache. We then compute an additional 48 elements that aren't cached. In this case, we need three blocks (two full and one masked) to compute "P cache" and another two blocks (one full and one masked) to compute "P". This is therefore five total blocks to compute our reduction when we only have four total blocks (i.e. 128) of elements to compute, which will definitely change our reduction order. 
<p>For example, if we instead had no elements in our KV Cache and were processing 128 elements altogether, we need to have identical numerics in both of these situations to ensure &ldquo;batch invariance&rdquo; for attention.</p>
 </figcaption>
</figure>
<p>To resolve this, we can just update the KV cache and page table before the attention kernel itself, ensuring that our keys and values are always consistently laid out regardless of how many tokens are being processed.</p>
<p>With this additional detail (as well as all the things mentioned in the previous section, like consistent tile sizes), we are able to achieve a batch-invariant attention implementation!</p>
<p>However, there is a significant problem here. Unlike with matrix multiplication, the attention shapes we see in LLM inference often do require a split-reduction kernel, often known as Split-KV or FlashDecoding. This is because if we don’t parallelize along the reduction, we can only parallelize along the batch dimension, head dimension, and “query length” dimension. In the decode stage of attention, query length is very small, and so unless we have a very large batch size we are often unable to saturate the GPU.</p>
<p>Unfortunately, it’s not as easy to ignore this case as it was for RMSNorm and Matmuls. For example, if you have a very long KV cache, the attention kernel may take a very long time despite only processing one request.</p>
<figure class="half-width">
<svg xmlns="http://www.w3.org/2000/svg" width="386" height="298" fill="none" viewBox="0 0 386 298"><path fill="#f5f5f5" d="M0 0h386v298H0z"/><path fill="#fff" d="M0 0h386v298H0z"/><path fill="#000" d="m29.446 211.483 1.681 1.005q1.233.72 1.96.981.725.269 1.377.266a4 4 0 0 0 .498-.039q.285-.038.688-.119l.09.453q-1.04.297-1.544.387a5 5 0 0 1-.886.099q-1.56.005-5.224-2.457l-.301-.204-.161.008q-.103.008-.154.008-2.24.009-3.712-1.524-1.463-1.533-1.472-3.876a5.6 5.6 0 0 1 .424-2.199q.435-1.027 1.26-1.829a5.2 5.2 0 0 1 1.667-1.083 5.2 5.2 0 0 1 1.954-.38q1.099-.004 1.971.315a4.7 4.7 0 0 1 1.593.975 5.6 5.6 0 0 1 1.318 1.87q.458 1.06.462 2.247.008 1.817-.903 3.153t-2.586 1.943m1.872-4.834q-.009-2.132-1.112-3.489-1.104-1.366-2.773-1.36-1.605.006-2.574 1.182-.963 1.176-.955 3.138.008 2.205 1.119 3.585 1.11 1.373 2.817 1.367 1.568-.006 2.523-1.211.963-1.212.955-3.212"/><path fill="#000" d="M177.559 87.665a31 31 0 0 0 1.831.052q.315-.001.725-.017t.901-.048l.002.491h-.066q-.835.003-1.602.731l-.073.074-3.619 3.492 3.359 3.35.375.372q1.42 1.445 2.078 1.442h.125l.066-.015.009.513q-.117-.008-.315-.014-.762-.04-1.04-.04-.279 0-.637.017-.352.015-.755.047l.008-.03a.1.1 0 0 0 .007-.043q-.001-.381-2.347-2.694-1.419-1.409-2.308-2.314l2.808-3.057q.19-.213.518-.559.737-.801.737-.947a.25.25 0 0 0-.148-.234q-.14-.08-.454-.079h-.183zm-5.83.022q.52.028.996.04a29 29 0 0 0 2.739-.054l.002.49-.095.001q-.66.003-.885.333-.219.33-.214 1.7l.02 5.354q.006 1.436.219 1.757.214.32.851.319.036 0 .117-.008l.125-.007.001.512a44 44 0 0 0-1.054-.04q-.498-.012-.923-.011-.337 0-.828.018-.49.016-1.076.048l-.002-.506q.044 0 .095.007h.139q.58-.003.782-.406.212-.411.206-1.817 0-.191-.01-.718a54 54 0 0 1-.01-.857l-.008-1.948q-.001-.366.004-.93.006-.572.005-.777-.005-1.266-.219-1.64-.207-.372-.785-.37l-.088.007a1 1 0 0 1-.102.008z"/><path fill="#000" d="M316.274 91.15q.55.027 1.04.04a30 30 0 0 0 2.82-.055l-.006.462q-.615.053-.82.164-.197.11-.196.381 0 .205.075.52.082.307.282.856l2.227 6.159q1.749-4.439 2.198-5.75.456-1.32.455-1.73-.001-.338-.185-.462-.176-.123-.821-.15l-.001-.462a27 27 0 0 0 1.706.052q.352 0 .784-.017.432-.016.901-.047l.001.461h-.11q-.805.003-1.364 1.427-.123.322-.203.498a545 545 0 0 0-2.635 6.463q-.588 1.496-.616 1.738l-.901.003q0-.176-.689-2.187a134 134 0 0 0-1.665-4.557l-.192-.52q-1.073-2.844-1.886-2.841a1 1 0 0 0-.117.007l-.081.008z"/><path fill="#ef402c" d="m105.531 188.383 35-.13.13 35-35 .13z"/><path fill="#f78427" d="m141.531 188.25 35-.13.13 35-35 .13z"/><path fill="#ffa8aa" d="m177.53 188.117 35-.13.13 35-35 .13z"/><path fill="#824665" d="m213.53 187.98 35-.13.13 35-35 .13z"/><path fill="#ef402c" d="m105.327 133.383 35-.13.13 35-35 .13z"/><path fill="#f78427" d="m141.327 133.25 35-.13.13 35-35 .13z"/><path fill="#ffa8aa" d="m177.326 133.117 35-.13.13 35-35 .13z"/><path fill="#824665" d="m213.326 132.98 35-.13.13 35-35 .13z"/><path fill="#e7e1df" d="m50.531 188.59 35-.13.13 35-35 .13z"/><path fill="#ef402c" d="m267.926 24.781 35-.13.13 35-35 .13z"/><path fill="#f78427" d="m268.059 60.781 35-.13.13 35-35 .13z" opacity=".8"/><path fill="#ffa8aa" d="m268.193 96.781 35-.13.13 35-35 .13z" opacity=".6"/><path fill="#824665" d="m268.326 132.781 35-.13.13 35-35 .13z"/><path fill="#000" d="M344.084 162.819a.5.5 0 0 0 .707-.003l3.171-3.193a.5.5 0 0 0-.71-.705l-2.818 2.839-2.839-2.818a.5.5 0 1 0-.704.71zm-.078-116.354-.5.002.431 115.999.5-.002.5-.002-.431-115.999z"/><path fill="#000" d="M192.208 263.202q.095.014.197.014l.308-.001q1.553-.006 2.436-.661.892-.655.887-1.776-.003-1.004-.555-1.521-.55-.518-1.598-.514-.162 0-.403.016-.234.015-.527.046l-.481 2.748q-.172 1.034-.264 1.649m-3.075 4.391.286-.001q.453-.001.643-.258.197-.265.398-1.452l1.038-6.332a4 4 0 0 0 .036-.205q.014-.096.014-.154-.002-.3-.207-.439-.198-.145-.608-.144l-.198.001.093-.543q.462.043.843.063t.688.02q.477-.003 1.267-.049.8-.047 1.114-.048 1.347-.005 2.104.615.763.612.768 1.696a2.74 2.74 0 0 1-.653 1.819q-.656.778-1.928 1.267l1.121 2.112q.044.096.14.285.937 1.813 1.991 1.809.038 0 .11-.007l.117-.008-.086.491q-.336.06-.563.083-.227.03-.396.03-.666.003-1.136-.237a1.97 1.97 0 0 1-.772-.752q-.214-.343-.796-1.571-.576-1.228-.931-1.945-.234.023-.475.038-.235.009-.484.009a6 6 0 0 1-.286-.006 9 9 0 0 0-.285-.006l-.407 2.763a9 9 0 0 0-.036.271 3 3 0 0 0-.007.183q.001.359.156.475.162.117.667.115l.168-.001-.093.484a49 49 0 0 0-1.78-.052 33 33 0 0 0-1.318.049q-.257.009-.41.016zm11.54-2.862.073-.037q2.602-1.342 2.6-2.068a.94.94 0 0 0-.281-.673.88.88 0 0 0-.653-.283q-.58.003-1.037.802-.459.8-.702 2.259m2.202-.514-2.236 1.166v.073q.003.872.276 1.325a.88.88 0 0 0 .8.451q.307-.001.768-.274.467-.28 1.19-.898l.258.46q-1.042.971-1.665 1.347-.613.376-1.119.378-.768.003-1.247-.662-.478-.665-.483-1.749a6 6 0 0 1 .243-1.649 6.4 6.4 0 0 1 .653-1.548q.503-.807 1.153-1.249t1.346-.444q.711-.003 1.188.449.486.445.488 1.09.001.52-.29.865-.285.338-1.323.869m6.348 1.163.537-3.32a4 4 0 0 0-.719-.334 1.8 1.8 0 0 0-.587-.108q-.9.004-1.512 1.163-.61 1.152-.604 2.874.003.695.165 1.054.17.358.492.357.22-.002.811-.45.6-.448 1.417-1.236m.017.747-1.241 1.133q-.548.5-.876.691a1.2 1.2 0 0 1-.607.193 1.12 1.12 0 0 1-1.013-.553q-.354-.562-.358-1.617-.007-2.08 1.034-3.578 1.05-1.498 2.5-1.504.293 0 .593.079.308.072.638.217l.408-2.653q.02-.153.028-.307.014-.161.013-.323 0-.293-.118-.402t-.433-.108q-.094 0-.198.008-.095 0-.212.008l-.031-.432q.608-.061 1.223-.166.622-.104 1.251-.254a174 174 0 0 0-1.097 6.355q-.429 2.828-.426 3.436 0 .374.067.527.075.147.235.146a.4.4 0 0 0 .205-.074q.124-.074.307-.243l.445-.404.243.416-.839.831q-.438.427-.635.544a.75.75 0 0 1-.38.119q-.388.002-.573-.364-.177-.366-.18-1.135a6 6 0 0 1 .027-.586m10.073.607-1.007.949q-.27.264-.489.375a.95.95 0 0 1-.439.112q-.33.001-.536-.313-.2-.322-.201-.856a4 4 0 0 1 .02-.367q.029-.219.108-.681-1.35 1.389-1.913 1.809t-.957.421q-.418.001-.698-.386t-.282-.995q-.001-.512.431-2.309.108-.425.159-.645.151-.607.223-.975.072-.374.072-.557a.36.36 0 0 0-.075-.234.22.22 0 0 0-.183-.094q-.074 0-.285.103-.213.104-.585.317l-.207-.402q.68-.507 1.191-.788.512-.288.724-.288a.53.53 0 0 1 .47.254q.177.257.178.71.003.572-.445 2.214-.441 1.643-.438 2.462.001.257.089.381.089.117.272.116.205 0 .694-.405.496-.412 1.657-1.567.273-1.319.438-2.228a29 29 0 0 0 .265-1.634l1.317-.32-.158.726a89 89 0 0 0-.447 1.986l-.172.939q-.13.666-.208 1.275-.07.608-.07.857.001.168.067.263a.2.2 0 0 0 .176.095q.103 0 .38-.199.277-.2.636-.537zm5.286-4.612-.387.383q-.485-.49-.779-.649a1.2 1.2 0 0 0-.586-.159q-.675.001-1.168 1.008-.495.998-.489 2.462.003.982.261 1.479.26.496.757.495.278-.002.76-.318.483-.324 1.015-.882l.302.519q-.846.903-1.445 1.309-.599.398-1.097.399-.792.003-1.27-.684-.471-.686-.476-1.858-.007-2.007 1.013-3.388 1.028-1.38 2.537-1.386.55-.002.938.231.396.233.398.533a.5.5 0 0 1-.066.235 1 1 0 0 1-.218.271m3.988-2.951q-.137.49-.383 1.539l-.108.455q.432-.002.879-.011.454-.016.952-.04l-.173.733a15 15 0 0 0-.439-.006l-.777.003-.586.002a37 37 0 0 0-.503 2.639q-.157 1.128-.154 1.89.001.322.105.505.11.183.301.182.146 0 .46-.236t.854-.758l.258.468q-1.05 1.088-1.445 1.39-.394.295-.665.295-.505.003-.807-.473-.303-.474-.306-1.295-.002-.535.163-1.531.165-1.005.626-3.108-.117 0-.308.008a6 6 0 0 1-.249.008l-.505.002.086-.491q.337-.015.615-.119a2.1 2.1 0 0 0 .57-.325q.065-.263.144-.549.087-.294.196-.616zm4.867 7.079.258.431q-.897.933-1.248 1.191-.35.258-.621.259a.73.73 0 0 1-.624-.32q-.235-.329-.238-.878-.002-.688.424-2.302.434-1.612.431-2.323a.46.46 0 0 0-.089-.293.28.28 0 0 0-.228-.109.75.75 0 0 0-.307.097 4 4 0 0 0-.475.294l-.221-.387.971-.714a2.6 2.6 0 0 1 .483-.295.9.9 0 0 1 .388-.096.63.63 0 0 1 .543.283q.205.277.208.768.002.536-.373 2.097l-.13.527a34 34 0 0 0-.31 1.371q-.1.543-.1.748 0 .183.082.3.08.116.205.116.118 0 .307-.148.19-.147.664-.617m-.093-9.441.419.467q.177.183.243.329a.6.6 0 0 1 .074.285.47.47 0 0 1-.108.294 1.1 1.1 0 0 1-.307.264l-.643.362-.471-.555a1.5 1.5 0 0 1-.192-.285.6.6 0 0 1-.044-.227.5.5 0 0 1 .086-.293.9.9 0 0 1 .3-.258zm4.61 4.714q-.85.005-1.461 1.17-.611 1.167-.604 2.874.003.9.312 1.376.317.474.91.472.894-.003 1.512-1.148.626-1.152.62-2.815-.005-.988-.321-1.456-.317-.475-.968-.473m.312-.711q1.09-.005 1.658.675.573.672.578 1.975a4.9 4.9 0 0 1-.287 1.598 5.8 5.8 0 0 1-.785 1.526q-.532.735-1.212 1.133-.672.39-1.419.393-.982.004-1.57-.704-.582-.71-.586-1.903a5.4 5.4 0 0 1 .279-1.729q.283-.843.815-1.527.525-.683 1.19-1.059.673-.376 1.339-.378m5.413 2.082 1.182-1.162q.62-.595.935-.787.321-.192.607-.193.483-.001.785.422.309.424.312 1.12.003.71-.351 2.198-.353 1.48-.351 2.111a.5.5 0 0 0 .075.293q.074.094.212.094a.35.35 0 0 0 .161-.052 1 1 0 0 0 .197-.154l.555-.544.258.387-.795.816q-.285.294-.57.463-.277.17-.49.171a.72.72 0 0 1-.602-.313q-.228-.321-.23-.842-.003-.622.365-2.191.368-1.576.365-2.294 0-.27-.118-.431a.34.34 0 0 0-.301-.168q-.286.002-1.746 1.362l-.606.566-.451 2.58-.044.22q-.15.783-.178 1.201l-1.303.328q.476-2.104.748-3.658.28-1.554.279-2.037-.002-.294-.068-.417a.22.22 0 0 0-.213-.131q-.088 0-.292.103-.198.104-.505.302l-.199-.387.234-.191q1.125-.913 1.505-.914.366-.001.543.276.177.27.179.849a5 5 0 0 1-.02.462 8 8 0 0 1-.064.542"/><path fill="#000" d="M249.104 247.207a.5.5 0 0 0-.003-.708l-3.193-3.17a.5.5 0 0 0-.705.71l2.839 2.818-2.818 2.839a.5.5 0 0 0 .71.704zm-136.354.152.002.5 135.999-.505-.002-.5-.002-.5-135.999.505z"/><path fill="#000" d="M113.805 117.775c-.006-1.612 1.183-2.772 2.853-2.778 1.682-.006 2.841 1.03 2.846 2.56.004.952-.425 1.715-1.879 3.314l-2.149 2.357v.108l4.196-.016.004 1.016-5.796.021-.003-.774 3.085-3.458c1.157-1.306 1.435-1.796 1.432-2.519-.004-.984-.698-1.629-1.765-1.625-1.053.004-1.749.711-1.745 1.79v.038l-1.079.004zm10.905 6.726c-1.708.006-2.917-1.043-3.019-2.617l1.08-.004c.105.959.926 1.616 1.999 1.612 1.18-.005 1.964-.839 1.96-2.083-.005-1.257-.801-2.105-1.976-2.1-.819.003-1.496.38-1.856 1.028l-1.06.004.444-5.175 5.009-.018.003 1.009-4.126.015-.242 2.991h.101c.449-.548 1.101-.836 1.908-.839 1.694-.006 2.88 1.252 2.886 3.055.007 1.854-1.251 3.115-3.111 3.122m8.119-.005c-1.993.008-3.098-1.689-3.109-4.774s1.08-4.79 3.073-4.798c1.987-.007 3.098 1.69 3.109 4.775s-1.087 4.79-3.073 4.797m-1.999-4.778c.002.361.022.698.049 1.009l3.683-3.099c-.303-1.135-.902-1.717-1.765-1.714-1.295.005-1.976 1.315-1.967 3.804m1.995 3.788c1.295-.005 1.969-1.321 1.96-3.803a10 10 0 0 0-.048-1.022l-3.67 3.124c.302 1.123.895 1.704 1.758 1.701"/><path fill="#000" d="M148.805 117.642c-.006-1.612 1.183-2.772 2.853-2.778 1.682-.006 2.841 1.03 2.846 2.56.004.952-.425 1.716-1.879 3.314l-2.149 2.357v.108l4.196-.016.004 1.016-5.796.021-.003-.774 3.085-3.458c1.157-1.306 1.435-1.796 1.432-2.519-.004-.984-.698-1.629-1.765-1.625-1.053.004-1.749.711-1.745 1.79v.038l-1.079.004zm10.905 6.726c-1.708.007-2.917-1.043-3.019-2.616l1.08-.004c.105.958.926 1.615 1.999 1.611 1.18-.005 1.964-.839 1.96-2.083-.005-1.257-.801-2.105-1.976-2.1-.819.003-1.496.38-1.856 1.029l-1.06.004.444-5.175 5.009-.019.003 1.009-4.126.016-.242 2.99h.101c.449-.548 1.101-.836 1.908-.839 1.694-.006 2.88 1.253 2.886 3.055.007 1.854-1.251 3.115-3.111 3.122m8.119-.004c-1.993.007-3.098-1.69-3.109-4.775s1.08-4.79 3.073-4.798c1.987-.007 3.098 1.69 3.109 4.775s-1.087 4.79-3.073 4.798m-1.999-4.779c.002.362.022.698.049 1.009l3.683-3.099c-.303-1.135-.902-1.717-1.765-1.713-1.295.004-1.976 1.315-1.967 3.803m1.995 3.788c1.295-.004 1.969-1.321 1.96-3.803a10 10 0 0 0-.048-1.022l-3.67 3.124c.302 1.123.895 1.705 1.758 1.701"/><path fill="#000" d="M184.805 117.505c-.006-1.612 1.183-2.772 2.853-2.778 1.682-.006 2.841 1.031 2.846 2.561.004.952-.425 1.715-1.879 3.314l-2.149 2.356v.108l4.196-.015.004 1.015-5.796.022-.003-.775 3.085-3.458c1.157-1.306 1.435-1.795 1.432-2.519-.004-.984-.698-1.629-1.765-1.625-1.053.004-1.749.711-1.745 1.79v.039l-1.079.004zm10.905 6.727c-1.708.006-2.917-1.043-3.019-2.617l1.08-.004c.105.958.926 1.615 1.999 1.611 1.18-.004 1.964-.839 1.96-2.083-.005-1.257-.801-2.104-1.976-2.1-.819.003-1.496.38-1.856 1.029l-1.06.004.444-5.175 5.009-.019.003 1.009-4.126.016-.242 2.99h.101c.449-.547 1.101-.836 1.908-.839 1.694-.006 2.88 1.253 2.886 3.056.007 1.853-1.251 3.115-3.111 3.122m8.119-.005c-1.993.007-3.098-1.69-3.109-4.775s1.08-4.79 3.073-4.797c1.987-.008 3.098 1.689 3.109 4.774s-1.087 4.79-3.073 4.798m-1.999-4.779c.002.362.022.698.049 1.009l3.683-3.098c-.303-1.136-.902-1.717-1.765-1.714-1.295.005-1.976 1.315-1.967 3.803m1.995 3.789c1.295-.005 1.969-1.322 1.96-3.804a10 10 0 0 0-.048-1.021l-3.67 3.124c.302 1.122.895 1.704 1.758 1.701"/><path fill="#000" d="M220.806 117.377c-.006-1.613 1.183-2.772 2.853-2.779 1.682-.006 2.841 1.031 2.846 2.561.004.952-.425 1.715-1.879 3.314l-2.149 2.356v.108l4.196-.015.004 1.015-5.796.022-.003-.775 3.085-3.458c1.157-1.305 1.434-1.795 1.432-2.519-.004-.984-.698-1.629-1.765-1.625-1.053.004-1.749.711-1.745 1.791v.038l-1.079.004zm10.905 6.726c-1.708.006-2.917-1.043-3.019-2.617l1.08-.004c.105.958.926 1.615 1.999 1.611 1.18-.004 1.964-.839 1.96-2.083-.005-1.257-.802-2.104-1.976-2.1-.819.003-1.496.38-1.856 1.029l-1.06.004.444-5.175 5.009-.019.003 1.01-4.126.015-.243 2.991.102-.001c.449-.547 1.101-.835 1.908-.838 1.694-.007 2.88 1.252 2.886 3.055.007 1.853-1.251 3.115-3.111 3.122m8.119-.005c-1.993.007-3.098-1.69-3.109-4.775s1.08-4.79 3.073-4.797c1.987-.008 3.098 1.689 3.109 4.774s-1.087 4.791-3.073 4.798m-1.999-4.779c.002.362.022.698.049 1.009l3.682-3.098c-.302-1.135-.901-1.717-1.764-1.714-1.295.005-1.976 1.315-1.967 3.803m1.995 3.789c1.295-.005 1.969-1.322 1.96-3.803a10 10 0 0 0-.048-1.022l-3.67 3.124c.302 1.122.895 1.704 1.758 1.701"/><path fill="#824665" d="m268.531 187.781 35-.13.13 35-35 .13z"/><path fill="#f99d52" d="m269.537 222.75 16.358-16.406 16.23 16.255z"/><path fill="#fff" d="m303.387 187.332.707.707-38.705 38.793-.707-.707z"/><path fill="#fff" d="m266.137 186.582.707-.707 38.793 38.705-.707.707z"/><path fill="#ef402c" stroke="#ef402c" d="m301.8 188.219-15.944 15.954-15.714-15.954z"/><path fill="#ffcbcc" d="m303.666 222.62-.1-34.011-16.972 16.982z"/></svg>
<figcaption><b>Fixed # Split-KV Strategy (i.e. FlashDecode)</b> If our query length becomes very small (like it does during decoding), we may end up in a situation where there is very little parallelism in our kernel at all. In these cases, we'll need to once again split along the reduction dimension --- the KV dimension this time. The typical strategy for how to split along the KV dimension is to figure out how much parallelism we need and then divide the KV dimension evenly. For example, if our KV length was 1000 and we needed 4 splits, each core would handle 250 elements.
<p>This unfortunately also breaks batch invariance, as our precise reduction strategy depends on how many query tokens from the sequence we&rsquo;re processing in any given request.</p>
</figcaption>
</figure>
<p>Furthermore, the split-reduction strategies commonly used for attention also pose challenges for batch invariance. For example, FlashInfer’s “balanced scheduling algorithm” chooses the largest split-size that can still saturate all the GPU’s cores, thus making the reduction strategy not “batch-invariant”. However, unlike with RMSNorm/Matmuls, it’s not sufficient to choose a fixed number of splits regardless of the batch size.</p>
<p>Instead, to achieve batch invariance, we must adopt a “fixed split-size” strategy. In other words, instead of fixing the # of splits, we fix the size of each split and then end up with a varying number of splits. In this manner, we can guarantee that regardless of how many tokens we’re processing, we always perform the identical reduction order. <label for="sn11" class="sidenote-number"></label><input type="checkbox" id="sn11" class="margin-toggle"/><span class="sidenote">This requires some internal FlexAttention changes that are not included in our code release. We will upstream them in the near future!</span></p>
<figure class="half-width">
<svg xmlns="http://www.w3.org/2000/svg" width="386" height="288" fill="none" viewBox="0 0 386 288"><path fill="#f5f5f5" d="M0 0h386v288H0z"/><path fill="#fff" d="M0 0h386v288H0z"/><path fill="#000" d="m29.83 205.817 1.677 1.011q1.23.725 1.955.988.726.271 1.377.271.213 0 .498-.036.285-.037.689-.117l.088.454q-1.04.292-1.546.381a5 5 0 0 1-.886.095q-1.56 0-5.215-2.476l-.3-.205q-.051 0-.161.007-.103.008-.154.008-2.242 0-3.706-1.538-1.458-1.539-1.457-3.882 0-1.172.432-2.197a5.55 5.55 0 0 1 1.267-1.824 5.1 5.1 0 0 1 1.67-1.077 5.2 5.2 0 0 1 1.955-.373q1.1 0 1.97.322a4.7 4.7 0 0 1 1.59.981 5.6 5.6 0 0 1 1.31 1.875q.455 1.062.455 2.249 0 1.817-.916 3.149-.915 1.334-2.592 1.934m1.89-4.827q0-2.131-1.1-3.493-1.098-1.37-2.768-1.37-1.605 0-2.578 1.172-.967 1.172-.967 3.135 0 2.204 1.106 3.588 1.106 1.377 2.813 1.377 1.567 0 2.526-1.201.967-1.208.967-3.208"/><path fill="#000" d="M178.401 82.548a30 30 0 0 0 1.831.059q.315 0 .726-.015.41-.014.9-.044v.491h-.066q-.834 0-1.604.725l-.073.073-3.633 3.48 3.348 3.361.373.374q1.414 1.45 2.073 1.45h.124a.4.4 0 0 0 .066-.015l.008.513q-.117-.008-.315-.015-.762-.044-1.04-.044-.279 0-.638.015-.35.015-.754.044a.1.1 0 0 0 .007-.03.1.1 0 0 0 .008-.043q0-.381-2.337-2.703a287 287 0 0 1-2.3-2.322l2.82-3.046q.191-.213.52-.557.74-.798.74-.945a.25.25 0 0 0-.146-.234q-.14-.08-.455-.08h-.183zm-5.83 0q.52.03.996.044a28 28 0 0 0 2.74-.044v.491h-.096q-.658 0-.886.33-.22.33-.22 1.699v5.354q0 1.436.213 1.758.212.322.849.322.037 0 .118-.007.08-.008.124-.008V93a43 43 0 0 0-1.055-.044q-.498-.015-.922-.015-.338 0-.828.015t-1.077.044v-.505q.044 0 .096.007h.139q.578 0 .783-.403.213-.41.213-1.816 0-.191-.008-.718a83 83 0 0 1-.007-.857V86.76q0-.366.007-.93.008-.571.008-.777 0-1.266-.213-1.64-.205-.374-.783-.374l-.088.007a1 1 0 0 1-.103.008z"/><path fill="#000" d="M297.103 86.548q.548.03 1.04.044a29 29 0 0 0 1.816 0q.491-.014 1.003-.044l-.007.462q-.616.051-.82.16-.198.11-.198.382 0 .204.073.52.081.307.279.857l2.204 6.167q1.766-4.43 2.219-5.743.462-1.318.462-1.728 0-.337-.183-.461-.176-.125-.821-.154v-.462a27 27 0 0 0 1.707.059q.351 0 .784-.015.432-.014.901-.044v.462h-.11q-.806 0-1.37 1.42a9 9 0 0 1-.205.499 557 557 0 0 0-2.659 6.452q-.593 1.494-.622 1.736h-.901q0-.175-.681-2.19a136 136 0 0 0-1.648-4.563l-.191-.52q-1.062-2.85-1.875-2.849a1 1 0 0 0-.117.007l-.08.008z"/><path fill="#ef402c" d="M106 183h35v35h-35z"/><path fill="#f78427" d="M142 183h35v35h-35z"/><path fill="#ffa8aa" d="M178 183h35v35h-35z"/><path fill="#824665" d="M214 183h17.5v35H214z"/><path fill="#ef402c" d="M106 128h35v35h-35z"/><path fill="#f78427" d="M142 128h35v35h-35z"/><path fill="#ffa8aa" d="M178 128h35v35h-35z"/><path fill="#824665" d="M214 128h17.5v35H214z"/><path fill="#e7e1df" d="M51 183h35v35H51z"/><path fill="#ef402c" d="m249 20.129 35-.13.13 35-35 .13z"/><path fill="#f78427" d="m249.133 56.129 35-.13.13 35-35 .13z" opacity=".8"/><path fill="#ffa8aa" d="m249.268 92.129 35-.13.13 35-35 .13z" opacity=".6"/><path fill="#824665" d="m249.4 128.129 35-.13.13 35-35 .13z"/><path fill="#000" d="M334.646 158.354a.5.5 0 0 0 .708 0l3.182-3.182a.502.502 0 0 0-.708-.708L335 157.293l-2.828-2.829a.502.502 0 0 0-.708.708zM335 42h-.5v116h1V42z"/><path fill="#000" d="M192.398 258.137q.096.014.198.014h.308q1.553 0 2.439-.651.893-.653.893-1.773 0-1.004-.549-1.523-.549-.52-1.597-.52a7 7 0 0 0-.402.014q-.236.015-.528.044l-.491 2.747q-.175 1.032-.271 1.648m-3.09 4.38h.285q.455 0 .645-.257.198-.264.403-1.45l1.062-6.328q.021-.11.036-.205.015-.096.015-.154 0-.3-.205-.439-.198-.147-.608-.147h-.198l.095-.542q.462.043.843.066.38.022.688.022.477 0 1.267-.044.799-.044 1.114-.044 1.347 0 2.102.623.76.615.761 1.699 0 1.033-.659 1.816-.659.777-1.933 1.26l1.113 2.117q.043.095.139.285.93 1.817 1.985 1.817.036 0 .11-.008.08-.007.117-.007l-.088.491a8 8 0 0 1-.564.08q-.227.03-.395.03-.667 0-1.136-.242a1.96 1.96 0 0 1-.769-.754q-.212-.345-.791-1.575-.571-1.23-.923-1.948-.234.022-.476.036-.234.008-.483.008a8 8 0 0 1-.286-.008 7 7 0 0 0-.285-.007l-.418 2.761-.037.271a4 4 0 0 0-.007.183q0 .36.154.476.161.118.666.118h.169l-.095.483a45 45 0 0 1-.681-.029q-.858-.03-1.099-.03-.374 0-1.318.044-.257.007-.411.015zm11.55-2.82.073-.037q2.608-1.334 2.608-2.058a.93.93 0 0 0-.279-.674.88.88 0 0 0-.652-.285q-.578 0-1.04.798-.46.798-.71 2.256m2.204-.506-2.241 1.158v.073q0 .872.271 1.326.279.454.799.454.307 0 .769-.271.468-.279 1.194-.894l.256.462q-1.047.966-1.67 1.34-.615.373-1.121.373-.768 0-1.245-.666-.476-.666-.476-1.751 0-.768.249-1.648.257-.885.659-1.545.506-.805 1.158-1.245t1.347-.44q.71 0 1.187.455.483.446.483 1.091 0 .52-.293.864-.285.337-1.326.864m6.343 1.187.55-3.318a4 4 0 0 0-.718-.337 1.8 1.8 0 0 0-.586-.11q-.901 0-1.516 1.158-.615 1.149-.615 2.871 0 .695.161 1.054.168.36.49.359.22 0 .813-.447.601-.446 1.421-1.23m.015.747-1.245 1.128q-.549.498-.879.688-.323.19-.608.191-.659 0-1.011-.557-.351-.564-.351-1.618 0-2.08 1.047-3.575 1.054-1.494 2.505-1.494.293 0 .593.081.308.073.637.219l.418-2.651q.022-.153.029-.308.015-.16.015-.322 0-.292-.117-.403-.118-.11-.432-.109-.096 0-.198.007a3 3 0 0 0-.213.007l-.029-.432q.608-.059 1.223-.161.623-.102 1.253-.249-.681 3.515-1.121 6.35-.44 2.828-.439 3.435 0 .374.065.527a.245.245 0 0 0 .235.147.4.4 0 0 0 .205-.073 2 2 0 0 0 .308-.242l.446-.403.242.418-.842.827q-.44.425-.637.542a.75.75 0 0 1-.381.117q-.389 0-.572-.366-.175-.366-.175-1.135a5 5 0 0 1 .029-.586m10.071.645-1.011.944a2 2 0 0 1-.491.374.95.95 0 0 1-.439.11q-.33 0-.535-.315-.198-.323-.198-.857 0-.155.022-.366.03-.22.11-.681-1.355 1.384-1.919 1.801t-.959.418q-.418 0-.696-.388t-.278-.997q0-.512.439-2.307.11-.425.161-.644.154-.608.227-.974.074-.374.074-.557a.35.35 0 0 0-.074-.234.22.22 0 0 0-.183-.096q-.073 0-.285.103a10 10 0 0 0-.586.315l-.205-.403q.681-.505 1.193-.784.513-.285.725-.285a.53.53 0 0 1 .469.256q.176.256.176.711 0 .57-.454 2.211-.447 1.642-.447 2.461 0 .256.088.381.088.117.271.117.206 0 .696-.402.498-.411 1.662-1.56.279-1.319.447-2.227.176-.915.271-1.633l1.319-.315-.162.725a91 91 0 0 0-.454 1.985l-.175.937q-.132.667-.213 1.275a8 8 0 0 0-.073.857q0 .168.066.263a.2.2 0 0 0 .176.095q.102 0 .38-.197.279-.198.638-.535zm5.302-4.593-.388.381q-.483-.49-.776-.652a1.2 1.2 0 0 0-.586-.161q-.674 0-1.172 1.004-.498.996-.498 2.46 0 .982.256 1.48.257.498.755.498.278 0 .762-.315a6.3 6.3 0 0 0 1.018-.879l.3.52q-.85.901-1.45 1.304-.601.395-1.099.395-.791 0-1.267-.688-.47-.688-.469-1.86 0-2.007 1.026-3.384 1.032-1.377 2.541-1.377.55 0 .938.234.395.234.395.535a.5.5 0 0 1-.066.234 1 1 0 0 1-.22.271m3.999-2.937q-.139.49-.388 1.538-.073.308-.11.454.433 0 .879-.007.454-.015.952-.037l-.175.733a12 12 0 0 0-.44-.007h-1.362q-.344 1.508-.513 2.636-.16 1.128-.161 1.89 0 .322.103.505.11.183.3.183.147 0 .461-.234t.857-.754l.257.468q-1.055 1.084-1.451 1.385-.395.293-.666.293-.506 0-.806-.476-.3-.477-.3-1.297 0-.534.168-1.531.169-1.003.638-3.105-.117 0-.308.007l-.249.008h-.505l.088-.491q.336-.015.615-.117.286-.103.571-.323.066-.263.147-.549.087-.292.197-.615zm4.842 7.097.256.433q-.9.93-1.252 1.186t-.623.256a.73.73 0 0 1-.622-.322q-.235-.33-.235-.879 0-.688.432-2.3.44-1.611.44-2.321 0-.183-.088-.293a.28.28 0 0 0-.227-.11.75.75 0 0 0-.308.095 4 4 0 0 0-.476.293l-.22-.388.975-.711q.278-.204.483-.293a.9.9 0 0 1 .388-.095q.344 0 .542.286.205.278.205.769 0 .534-.381 2.095l-.131.527a33 33 0 0 0-.315 1.37q-.103.541-.103.747 0 .183.081.3a.24.24 0 0 0 .205.117q.117 0 .307-.146.19-.147.667-.616m-.059-9.441.418.469q.175.183.241.33a.6.6 0 0 1 .074.285.47.47 0 0 1-.11.293 1.1 1.1 0 0 1-.308.264l-.644.359-.469-.557a1.4 1.4 0 0 1-.191-.285.6.6 0 0 1-.044-.227q0-.169.088-.293a.9.9 0 0 1 .301-.257zm4.592 4.732q-.849 0-1.464 1.164-.616 1.165-.616 2.872 0 .9.308 1.377.315.476.908.476.894 0 1.516-1.143.63-1.15.63-2.812 0-.99-.315-1.458-.315-.476-.967-.476m.315-.711q1.092 0 1.656.682.571.674.571 1.977 0 .747-.293 1.597a5.8 5.8 0 0 1-.791 1.523q-.535.734-1.216 1.128a2.8 2.8 0 0 1-1.421.388q-.98 0-1.567-.71-.579-.71-.579-1.904 0-.886.286-1.729.286-.842.82-1.523a4 4 0 0 1 1.194-1.055q.674-.374 1.34-.374m5.406 2.103 1.186-1.158q.623-.593.938-.783.322-.19.608-.191.483 0 .783.425.308.425.308 1.121 0 .71-.359 2.197-.359 1.479-.359 2.109 0 .19.073.293.073.096.213.095a.36.36 0 0 0 .161-.051 1 1 0 0 0 .198-.154l.556-.542.257.389-.799.813q-.286.293-.571.461-.278.168-.491.168a.72.72 0 0 1-.6-.315q-.227-.321-.227-.842 0-.623.373-2.19.374-1.575.374-2.292a.7.7 0 0 0-.117-.432.34.34 0 0 0-.301-.169q-.285 0-1.75 1.355-.389.358-.608.564l-.462 2.578-.043.22q-.154.783-.184 1.201l-1.303.322q.483-2.101.761-3.654.286-1.553.286-2.037 0-.292-.066-.417a.22.22 0 0 0-.212-.132q-.089 0-.293.103a6 6 0 0 0-.506.3l-.197-.388.234-.191q1.128-.908 1.509-.908.366 0 .542.279.176.27.176.849 0 .205-.022.462-.023.255-.066.542"/><path fill="#000" d="M249.354 242.354a.5.5 0 0 0 0-.708l-3.182-3.182a.502.502 0 0 0-.708.708l2.829 2.828-2.829 2.828a.502.502 0 0 0 .708.708zM113 242v.5h136v-1H113z"/><path fill="#000" d="M113.568 113.505c-.006-1.612 1.183-2.772 2.852-2.778 1.682-.006 2.842 1.031 2.847 2.561.004.952-.425 1.715-1.879 3.314l-2.15 2.356.001.108 4.196-.015.003 1.015-5.795.022-.003-.775 3.085-3.458c1.157-1.306 1.434-1.795 1.432-2.519-.004-.984-.698-1.629-1.765-1.625-1.054.004-1.749.711-1.745 1.79v.039l-1.079.004zm10.905 6.727c-1.708.006-2.918-1.043-3.019-2.617l1.079-.004c.105.958.927 1.615 1.999 1.611 1.181-.004 1.965-.839 1.96-2.083-.004-1.257-.801-2.104-1.975-2.1-.819.003-1.497.38-1.856 1.029l-1.06.004.444-5.175 5.008-.019.004 1.009-4.126.016-.243 2.99h.102c.448-.547 1.101-.836 1.907-.839 1.695-.006 2.88 1.253 2.887 3.056.007 1.853-1.251 3.115-3.111 3.122m11.242-3.165c.007 1.815-1.296 3.134-3.111 3.141-1.803.006-3.109-1.296-3.116-3.118-.004-1.073.355-2.045 1.226-3.324.082-.14 1.976-2.814 2.039-2.909l1.289-.005-2.488 3.444c-.278.394-.253.369-.297.47l.096.051c.271-.369.93-.645 1.514-.647 1.632-.006 2.842 1.227 2.848 2.897m-3.108 2.144c1.155-.004 2.028-.909 2.023-2.083-.004-1.181-.884-2.079-2.039-2.075-1.149.005-2.021.909-2.017 2.09.004 1.174.884 2.072 2.033 2.068"/><path fill="#000" d="M148.568 113.505c-.006-1.612 1.183-2.772 2.852-2.778 1.682-.006 2.842 1.031 2.847 2.561.004.952-.425 1.715-1.879 3.314l-2.15 2.356.001.108 4.196-.015.003 1.015-5.795.022-.003-.775 3.085-3.458c1.157-1.306 1.434-1.795 1.432-2.519-.004-.984-.698-1.629-1.765-1.625-1.054.004-1.749.711-1.745 1.79v.039l-1.079.004zm10.905 6.727c-1.708.006-2.918-1.043-3.019-2.617l1.079-.004c.105.958.927 1.615 1.999 1.611 1.181-.004 1.965-.839 1.96-2.083-.004-1.257-.801-2.104-1.975-2.1-.819.003-1.497.38-1.856 1.029l-1.06.004.444-5.175 5.008-.019.004 1.009-4.126.016-.243 2.99h.102c.448-.547 1.101-.836 1.907-.839 1.695-.006 2.88 1.253 2.887 3.056.007 1.853-1.251 3.115-3.111 3.122m11.242-3.165c.007 1.815-1.296 3.134-3.111 3.141-1.803.006-3.109-1.296-3.116-3.118-.004-1.073.355-2.045 1.226-3.324.082-.14 1.976-2.814 2.039-2.909l1.289-.005-2.488 3.444c-.278.394-.253.369-.297.47l.096.051c.271-.369.93-.645 1.514-.647 1.632-.006 2.842 1.227 2.848 2.897m-3.108 2.144c1.155-.004 2.028-.909 2.023-2.083-.004-1.181-.884-2.079-2.039-2.075-1.149.005-2.021.909-2.017 2.09.004 1.174.884 2.072 2.033 2.068"/><path fill="#000" d="M184.568 113.505c-.006-1.612 1.183-2.772 2.852-2.778 1.682-.006 2.842 1.031 2.847 2.561.004.952-.425 1.715-1.879 3.314l-2.15 2.356.001.108 4.196-.015.003 1.015-5.795.022-.003-.775 3.085-3.458c1.157-1.306 1.434-1.795 1.432-2.519-.004-.984-.698-1.629-1.765-1.625-1.054.004-1.749.711-1.745 1.79v.039l-1.079.004zm10.905 6.727c-1.708.006-2.918-1.043-3.019-2.617l1.079-.004c.105.958.927 1.615 1.999 1.611 1.181-.004 1.965-.839 1.96-2.083-.004-1.257-.801-2.104-1.975-2.1-.819.003-1.497.38-1.856 1.029l-1.06.004.444-5.175 5.008-.019.004 1.009-4.126.016-.243 2.99h.102c.448-.547 1.101-.836 1.907-.839 1.695-.006 2.88 1.253 2.887 3.056.007 1.853-1.251 3.115-3.111 3.122m11.242-3.165c.007 1.815-1.296 3.134-3.111 3.141-1.803.006-3.109-1.296-3.116-3.118-.004-1.073.355-2.045 1.226-3.324.082-.14 1.976-2.814 2.039-2.909l1.289-.005-2.488 3.444c-.278.394-.253.369-.297.47l.096.051c.271-.369.93-.645 1.514-.647 1.632-.006 2.842 1.227 2.848 2.897m-3.108 2.144c1.155-.004 2.028-.909 2.023-2.083-.004-1.181-.884-2.079-2.039-2.075-1.149.005-2.021.909-2.017 2.09.004 1.174.884 2.072 2.033 2.068"/><path fill="#000" d="M211.568 86.506c-.006-1.613 1.183-2.772 2.852-2.779 1.682-.006 2.842 1.03 2.847 2.56.004.953-.425 1.716-1.879 3.315l-2.15 2.356.001.108 4.196-.015.003 1.015-5.795.022-.003-.775 3.085-3.458c1.157-1.306 1.434-1.795 1.432-2.519-.004-.984-.698-1.629-1.765-1.625-1.054.004-1.749.711-1.745 1.79v.038l-1.079.004zm9.847 2.299-.003-.94.996-.003c1.029-.004 1.743-.68 1.74-1.638-.004-.933-.691-1.546-1.726-1.543-1.028.004-1.712.61-1.797 1.594l-1.073.004c.102-1.587 1.216-2.575 2.911-2.582 1.637-.006 2.809.974 2.814 2.364.004 1.104-.57 1.894-1.553 2.139v.101c1.219.154 1.946 1.008 1.951 2.259.005 1.555-1.298 2.67-3.126 2.678-1.809.006-3.07-1.03-3.158-2.61l1.06-.004c.105.977.92 1.609 2.062 1.605 1.257-.005 2.036-.656 2.032-1.69-.004-1.067-.813-1.743-2.082-1.738zm6.225-2.36c-.006-1.611 1.183-2.771 2.852-2.777 1.683-.007 2.842 1.03 2.847 2.56.004.952-.425 1.715-1.879 3.314l-2.149 2.357v.108l4.196-.016.004 1.016-5.796.021-.003-.774 3.085-3.459c1.157-1.305 1.434-1.795 1.432-2.519-.004-.983-.698-1.628-1.765-1.624-1.053.004-1.749.71-1.745 1.79v.038l-1.079.004z"/><path stroke="#000" d="M222.406 99.625v38.543"/><path fill="#824665" d="m249.531 182.809 35-.13.13 35-35 .13z"/><path fill="#f99d52" d="m250.537 217.777 16.358-16.406 16.23 16.256z"/><path fill="#fff" d="m284.387 182.359.707.707-38.705 38.793-.707-.707z"/><path fill="#fff" d="m247.137 181.609.707-.707 38.793 38.705-.707.708z"/><path fill="#ef402c" stroke="#ef402c" d="M282.8 183.246 266.856 199.2l-15.714-15.954z"/><path fill="#ffcbcc" d="m284.666 217.647-.1-34.01-16.972 16.982z"/></svg>
<figcaption><b>Fixed Size Split-KV Strategy</b> 
The only difference between this strategy and the previous strategy is that our splits are now "fixed size". For example, if our KV length was 1000, instead of splitting it into four even length 250 splits, we would split it into three fixed-size length 256 splits and one length 232 split.
<p>This allows us to <em>preserve</em> batch invariance as our reduction strategy is no longer dependent on how many query tokens we&rsquo;re processing at once!</p>
 </figcaption>
</figure>
<h2 id="implementation">Implementation</h2>
<p>We provide a demonstration of deterministic inference on top of vLLM by leveraging its FlexAttention backend as well as torch.Library.
Through torch.Library, we’re able to substitute out most of the relevant PyTorch operators in an unintrusive way. You can find the library of “batch-invariant” kernels at <a href="https://github.com/thinking-machines-lab/batch_invariant_ops">thinking-machines-lab/batch-invariant-ops</a>, as well as the vLLM example of running in &ldquo;deterministic&rdquo; mode.</p>
<h2 id="experiments">Experiments</h2>
<h3 id="how-nondeterministic-are-completions">How nondeterministic are completions?</h3>
<p>We use <code>Qwen/Qwen3-235B-A22B-Instruct-2507</code> and sample 1000 completions at temperature 0 with the prompt &ldquo;Tell me about Richard Feynman&rdquo; (non-thinking mode), generating 1000 tokens each. Surprisingly, we generate <em>80</em> unique completions, with the most common of these occuring 78 times.</p>
<p>Looking at where the completions differ, we see that the completions are actually identical for the first 102 tokens! The first instance of diverging completions occurs at the 103rd token. All completions generate the sequence &ldquo;Feynman was born on May 11, 1918, in&rdquo; However, 992 of the completions go on to generate &ldquo;Queens, New York&rdquo; whereas 8 of the completions generate &ldquo;New York City&rdquo;.</p>
<!-- At this point, we can also inspect the logprobs of each generation. # TODO: Fill this out a little more. -->
<p>On the other hand, when we enable our batch-invariant kernels, all of our 1000 completions are identical. This is what we would mathematically expect from our sampler, but we aren&rsquo;t able to achieve deterministic results without our batch-invariant kernels.</p>
<!-- ### Deterministic evals
One implication of deterministic completions is deterministic evals.
One benefit we’ve found of fully deterministic LLM inference is that we can also get deterministic evals. This can be advantageous for experiment reproducibility, validating small performance improvements, or simply writing reliable unit tests.

Running X eval, we can see that there is a Y variance in eval scores normally. However, when run in deterministic mode, we get exactly the same eval scores every time. -->
<h3 id="performance">Performance</h3>
<p>We have not put a significant effort into optimizing the performance of the batch-invariant kernels here. However, let&rsquo;s run some experiments to verify that our performance remains usable.</p>
<p>We will set up an API server with one GPU running Qwen-3-8B, and request 1000 sequences with an output length of between 90 and 110.</p>
<table>
  <thead>
      <tr>
          <th>Configuration</th>
          <th style="text-align: center">Time (seconds)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>vLLM default</td>
          <td style="text-align: center">26</td>
      </tr>
      <tr>
          <td>Unoptimized Deterministic vLLM</td>
          <td style="text-align: center">55</td>
      </tr>
      <tr>
          <td>+ Improved Attention Kernel</td>
          <td style="text-align: center">42</td>
      </tr>
  </tbody>
</table>
<p>Much of the slowdown comes from the fact that the FlexAttention integration in vLLM has not been heavily optimized yet. Nevertheless, we see that performance is not <em>disastrous</em>.</p>
<h3 id="true-on-policy-rl">True on-policy RL</h3>
<p>As <a href="https://fengyao.notion.site/off-policy-rl">researchers have noted</a>, the different numerics between training and inference implicitly turns our on-policy RL into off-policy RL.</p>
<p>Of course, it is impossible to get bitwise identical results between training and inference if we can’t even get bitwise identical results from two identical inference requests. Then, deterministic inference enables us to also modify our training stack to obtain bitwise identical results between sampling and training, thus resulting in true on-policy RL.</p>
<p>We run experiments in a RLVR setup on <a href="https://arxiv.org/abs/2502.17387">Bigmath</a> with the RL policy initialized from the Qwen 2.5-VL instruct 8B with a max rollout length of 4096.</p>
<p>If we train without off-policy correction (i.e. importance weighting), our reward collapses partway through training, whereas adding an off-policy correction term  allows training to proceed smoothly. But, if we achieve bitwise identical results between our sampler and trainer, we are fully on policy (i.e. 0 KL divergence) and can also train smoothly.</p>
<p>We can also plot the KL-divergence in logprobs between our sampler and trainer, where all 3 runs have notably different behavior. When running with importance weighting, it stays around 0.001 with occasional spikes. However, running <em>without</em> importance weighting eventually leads to a spike in KL-divergence around the same time that reward crashes. And, of course, when running &ldquo;True On-Policy RL&rdquo;, our KL-divergence stays flat at 0, indicating that there is <em>no</em> divergence between the training policy and sampling policy.</p>
<!-- <figure class="chart-line"
        data-src="/data/wandb_export_2025-09-08T11_16_51.917-07_00.csv"
        data-seriesmeta='{"names":["With importance weighting","No importance weighting"],"colors":["#8ac926","#007f86"]}'
        data-show-points="false"
        data-smooth="35"
        data-x='{"label":"Step","ticks":[0,100,200,400,600,800,900,1000,1100]}'
        data-y='{"label":"Mean_reward","ticks":[-0.1,0.0,0.1,0.2,0.3,0.4,0.5]}'
        data-labels='{"With Importance Weighting":{"x":850,"y":0.5,"dx":-8,"dy":-6},"No Importance Weighting":{"x":850,"y":-0.03,"dx":-8,"dy":-6}}'
        data-series='[{"lineWidth":1.6},{"lineWidth":1.6}]'>
  <figcaption>Without off-policy correction like importance weighting, RL is prone to catastrophic failure due to the "off-policyness" induced by numerical mismatches between the trainer and the sampler. However, if we obtain bitwise equivalence between the trainer and the sampler, we don't need any off-policy correction to train smoothly.</figcaption>
  <svg viewBox="0 0 800 520" width="100%" height="auto"></svg>
  
</figure> -->
<!-- <figure class="chart-line"
        data-srcs='["/data/reward.csv","/data/kl.csv"]'
        data-seriesmeta='{"colors":["#1f78b4","#e31a1c","#33a02c"],"names":["True On-Policy","No Importance Weighting","With Importance Weighting"]}'
        data-show-points="false"
        data-smooth="0.1"
        data-x='{"label":"Step","ticks":[0,50,100,150,200,250,300,318],"domain":[0,319]}'
        data-y='{"label":"Mean reward","ticks":[0.0,0.1,0.2,0.3,0.4,0.5,0.6], "domain":[-0.1,0.6]}'
        data-y2='{"label":"KL-Divergence","ticks":[0.0,0.001,0.002,0.003,0.004,0.005,0.0055],"domain":[-0.001,0.0055]}'
        data-labels='{"True On-Policy":{"x":215,"y":0.32,"dx":-16,"dy":-4},"No Importance Weighting":{"x":215,"y":0.27,"dx":-16,"dy":-4},"With Importance Weighting":{"x":215,"y":0.22,"dx":-16,"dy":-4}}'
        data-series='[{"lineWidth":1.5},{"lineWidth":1.4},{"lineWidth":2.4}]'>
  <figcaption>Note that the run without importance weighting has a significant loss spike around Step 318, and this comes with a corresponding spike in KL-divergence of logprobs. Meanwhile, either using an off-policy correction or running with "True On-Policy" allows RL to continue smoothly. The blue line showing "True On-Policy" is not a bug --- it's just a flat line at 0. </figcaption>
  <svg viewBox="0 0 800 520" width="100%" height="auto"></svg>
  
</figure> -->
<figure class="chart-line-2pane"
        data-srcs='["/data/reward.csv","/data/kl.csv"]'
        data-seriesmeta='{"colors":["#f4a261","#007f86","#8ac926"],"names":["True on-policy","No importance weighting","With importance weighting"]}'
        data-show-points="false"
        data-smooth="0.1"
        data-x='{"label":"Step","ticks":[0,50,100,150,200,250,300,318],"domain":[0,319]}'
        data-top-y='{"label":"Mean reward","ticks":[0.0,0.1,0.2,0.3,0.4,0.5,0.6], "domain":[-0.1,0.6]}'
        data-bottom-y='{"label":"KL-Divergence","ticks":[0.0,0.001,0.002,0.003,0.004,0.005],"domain":[-0.001,0.0055]}'
        data-labels='{"True on-policy":{"x":215,"y":0.32,"dx":-16,"dy":-4},"No importance weighting":{"x":215,"y":0.27,"dx":-16,"dy":-4},"With importance weighting":{"x":215,"y":0.22,"dx":-16,"dy":-4}}'
        data-top-series='[{"lineWidth":1.5},{"lineWidth":1.4},{"lineWidth":2.4}]'
        data-bottom-series='[{"lineWidth":1.5},{"lineWidth":1.4},{"lineWidth":2.4}]'>
  <figcaption>Note that the run without importance weighting has a significant loss spike around Step 318, and this comes with a correspond ing spike in KL-divergence of logprobs. Meanwhile, either using an off-policy correction or running with "True On-Policy" allows RL to continue smoothly. The blue line showing "True On-Policy" is not a bug - it's just a flat line at 0. </figcaption>
  <svg viewBox="0 0 800 520" width="100%" height="auto"></svg>
</figure>
<h2 id="conclusion">Conclusion</h2>
<p>Modern software systems contain many layers of abstractions. In machine learning, when we run into nondeterminism and subtle numerical differences it can often be tempting to paper over them. After all, our systems are already &ldquo;probabilistic&rdquo;, so what&rsquo;s wrong with a little more nondeterminism? What&rsquo;s wrong with bumping up the atol/rtol on the failing unit test? The difference in logprobs between the trainer and the sampler probably isn&rsquo;t a real bug, right?</p>
<p>We reject this defeatism. With a little bit of work, we <em>can</em> understand the root causes of our nondeterminism and even solve them! We hope that this blog post provides the community with a solid understanding of how to resolve nondeterminism in our inference systems and inspires others to obtain a full understanding of their systems.</p>
<h2 id="citation">Citation</h2>
<p>Please cite this work as:</p>
<pre tabindex="0"><code>He, Horace and Thinking Machines Lab, &#34;Defeating Nondeterminism in LLM Inference&#34;, 
Thinking Machines Lab: Connectionism, Sep 2025.
</code></pre><p>Or use the BibTeX citation:</p>
<pre tabindex="0"><code>@article{he2025nondeterminism,
  author = {Horace He and Thinking Machines Lab},
  title = {Defeating Nondeterminism in LLM Inference},
  journal = {Thinking Machines Lab: Connectionism},
  year = {2025},
  note = {https://thinkingmachines.ai/blog/defeating-nondeterminism-in-llm-inference/},
  doi = {10.64434/tml.20250910}
}
</code></pre>
    
  </article>

  <div class="paginator">
    
    <a></a>
    

    <a href="#" id="back-to-top" class="link" title="Go to top">back to top</a>

    
    <a class="link" href="https://thinkingmachines.ai/blog/modular-manifolds/" title="Modular Manifolds">next</a>
    
  </div>

  
  
  
  
  
    
    
    
    <script src="https://thinkingmachines.ai/js/chart-line.min.d4d81cb798e9f08dd33682ddc1fcf3c5655fd065d814e27058c8a142ef09c5ff.js" integrity="sha256-1Ngct5jp8I3TNoLdwfzzxWVf0GXYFOJwWMihQu8Jxf8=" defer></script>
  
  

  
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      
      const prevLink = document.querySelector('.paginator a:first-child');
      const nextLink = document.querySelector('.paginator a:last-child');

      const prevUrl = prevLink && prevLink.href !== window.location.href ? prevLink.href : null;
      const nextUrl = nextLink && nextLink.href !== window.location.href ? nextLink.href : null;

      
      document.addEventListener('keydown', function(e) {
        
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.isContentEditable) {
          return;
        }

        
        if (e.keyCode === 37 && prevUrl) {
          e.preventDefault();
          window.location.href = prevUrl;
        }

        
        if (e.keyCode === 39 && nextUrl) {
          e.preventDefault();
          window.location.href = nextUrl;
        }
      });
    });
  </script>
  

  
  
</main>

    <footer id="footer">
  <div>
    <span><a href="/">Thinking Machines Lab</a> © 2025</span><span class="footer-separator" id="first-footer-separator">·</span><span><a href="/legal/terms">Terms of service</a></span><span class="footer-separator">·</span><span><a href="/legal/privacy">Privacy notice</a></span>
  </div>
</footer>
  </div>

  
  
  <script src="/js/script.min.4093dc550c9ad99ac0e65f35825652be69a5baa12f3740fed8f70266298353f6.js" integrity="sha256-QJPcVQya2ZrA5l81glZSvmmluqEvN0D&#43;2PcCZimDU/Y=" defer></script>

  
  

  
  

  
  

</body>

</html>